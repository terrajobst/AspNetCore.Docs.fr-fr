---
title: Routage dans ASP.NET Core
author: rick-anderson
description: Découvrez comment ASP.NET Core routage est responsable de la mise en correspondance des requêtes HTTP et de la distribution aux points de terminaison exécutables.
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 3/25/2020
uid: fundamentals/routing
ms.openlocfilehash: 69d8aa65084d4d2ee13a8ca0e8e275f4344d08c5
ms.sourcegitcommit: 99e71ae03319ab386baf2ebde956fc2d511df8b8
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/25/2020
ms.locfileid: "80242655"
---
# <a name="routing-in-aspnet-core"></a><span data-ttu-id="80ae9-103">Routage dans ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="80ae9-103">Routing in ASP.NET Core</span></span>

<span data-ttu-id="80ae9-104">Par [Ryan Nowak](https://github.com/rynowak), [Kirk Larkin](https://twitter.com/serpent5)et [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="80ae9-104">By [Ryan Nowak](https://github.com/rynowak), [Kirk Larkin](https://twitter.com/serpent5), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="80ae9-105">Le routage est responsable de la mise en correspondance des demandes HTTP entrantes et de la distribution de ces requêtes aux points de terminaison exécutables de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-105">Routing is responsible for matching incoming HTTP requests and dispatching those requests to the app's executable endpoints.</span></span> <span data-ttu-id="80ae9-106">Les [points de terminaison](#endpoint) sont les unités de code de gestion des requêtes exécutables de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-106">[Endpoints](#endpoint) are the app's units of executable request-handling code.</span></span> <span data-ttu-id="80ae9-107">Les points de terminaison sont définis dans l’application et configurés au démarrage de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-107">Endpoints are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="80ae9-108">Le processus de correspondance de point de terminaison peut extraire des valeurs de l’URL de la demande et fournir ces valeurs pour le traitement des demandes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-108">The endpoint matching process can extract values from the request's URL and provide those values for request processing.</span></span> <span data-ttu-id="80ae9-109">À l’aide des informations de point de terminaison de l’application, le routage est également en mesure de générer des URL qui mappent aux points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-109">Using endpoint information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="80ae9-110">Les applications peuvent configurer le routage à l’aide de :</span><span class="sxs-lookup"><span data-stu-id="80ae9-110">Apps can configure routing using:</span></span>

- <span data-ttu-id="80ae9-111">Controllers</span><span class="sxs-lookup"><span data-stu-id="80ae9-111">Controllers</span></span>
- <span data-ttu-id="80ae9-112">Pages Razor</span><span class="sxs-lookup"><span data-stu-id="80ae9-112">Razor Pages</span></span>
- <span data-ttu-id="80ae9-113">SignalR</span><span class="sxs-lookup"><span data-stu-id="80ae9-113">SignalR</span></span>
- <span data-ttu-id="80ae9-114">Services gRPC</span><span class="sxs-lookup"><span data-stu-id="80ae9-114">gRPC Services</span></span>
- <span data-ttu-id="80ae9-115">[Intergiciel (middleware](xref:fundamentals/middleware/index) ) prenant en charge les points de terminaison, tels que les [contrôles d’intégrité](xref:host-and-deploy/health-checks).</span><span class="sxs-lookup"><span data-stu-id="80ae9-115">Endpoint-enabled [middleware](xref:fundamentals/middleware/index) such as [Health Checks](xref:host-and-deploy/health-checks).</span></span>
- <span data-ttu-id="80ae9-116">Délégués et expressions lambda inscrits avec le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-116">Delegates and lambdas registered with routing.</span></span>

<span data-ttu-id="80ae9-117">Ce document traite des détails de bas niveau du routage de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="80ae9-117">This document covers low-level details of ASP.NET Core routing.</span></span> <span data-ttu-id="80ae9-118">Pour plus d’informations sur la configuration du routage :</span><span class="sxs-lookup"><span data-stu-id="80ae9-118">For information on configuring routing:</span></span>

* <span data-ttu-id="80ae9-119">Pour les contrôleurs, consultez <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-119">For controllers, see <xref:mvc/controllers/routing>.</span></span>
* <span data-ttu-id="80ae9-120">Pour Razor Pages conventions, consultez <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-120">For Razor Pages conventions, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="80ae9-121">Le système de routage des points de terminaison décrit dans ce document s’applique à ASP.NET Core 3,0 et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="80ae9-121">The endpoint routing system described in this document applies to ASP.NET Core 3.0 and later.</span></span> <span data-ttu-id="80ae9-122">Pour plus d’informations sur le système de routage précédent basé sur <xref:Microsoft.AspNetCore.Routing.IRouter>, sélectionnez la version ASP.NET Core 2,1 en utilisant l’une des méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-122">For information on the previous routing system based on <xref:Microsoft.AspNetCore.Routing.IRouter>, select the ASP.NET Core 2.1 version using one of the following approaches:</span></span>

* <span data-ttu-id="80ae9-123">Sélecteur de version d’une version précédente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-123">The version selector for a previous version.</span></span>
* <span data-ttu-id="80ae9-124">Sélectionnez [ASP.net Core routage 2,1](https://docs.microsoft.com/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="80ae9-124">Select [ASP.NET Core 2.1 routing](https://docs.microsoft.com/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

<span data-ttu-id="80ae9-125">[Affichez ou téléchargez l’exemple de code](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) ([procédure de téléchargement](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="80ae9-125">[View or download sample code](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) ([how to download](xref:index#how-to-download-a-sample))</span></span>

<span data-ttu-id="80ae9-126">Les exemples de téléchargement de ce document sont activés par une classe de `Startup` spécifique.</span><span class="sxs-lookup"><span data-stu-id="80ae9-126">The download samples for this document are enabled by a specific `Startup` class.</span></span> <span data-ttu-id="80ae9-127">Pour exécuter un exemple spécifique, modifiez *Program.cs* pour appeler la classe `Startup` souhaitée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-127">To run a specific sample, modify *Program.cs* to call the desired `Startup` class.</span></span>

## <a name="routing-basics"></a><span data-ttu-id="80ae9-128">Concepts de base du routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-128">Routing basics</span></span>

<span data-ttu-id="80ae9-129">Tous les modèles de ASP.NET Core incluent le routage dans le code généré.</span><span class="sxs-lookup"><span data-stu-id="80ae9-129">All ASP.NET Core templates include routing in the generated code.</span></span> <span data-ttu-id="80ae9-130">Le routage est inscrit dans le pipeline de l' [intergiciel (middleware](xref:fundamentals/middleware/index) ) dans `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-130">Routing is registered in the [middleware](xref:fundamentals/middleware/index) pipeline in `Startup.Configure`.</span></span>

<span data-ttu-id="80ae9-131">Le code suivant illustre un exemple de routage de base :</span><span class="sxs-lookup"><span data-stu-id="80ae9-131">The following code shows a basic example of routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet&highlight=8,10)]

<span data-ttu-id="80ae9-132">Le routage utilise une paire d’intergiciels (middleware), inscrite par <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> et <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>:</span><span class="sxs-lookup"><span data-stu-id="80ae9-132">Routing uses a pair of middleware, registered by <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>:</span></span>

* <span data-ttu-id="80ae9-133">`UseRouting` ajoute la correspondance d’itinéraire au pipeline de l’intergiciel (middleware).</span><span class="sxs-lookup"><span data-stu-id="80ae9-133">`UseRouting` adds route matching to the middleware pipeline.</span></span> <span data-ttu-id="80ae9-134">Cet intergiciel (middleware) examine l’ensemble des points de terminaison définis dans l’application et sélectionne la [meilleure correspondance](#urlm) en fonction de la demande.</span><span class="sxs-lookup"><span data-stu-id="80ae9-134">This middleware looks at the set of endpoints defined in the app, and selects the [best match](#urlm) based on the request.</span></span>
* <span data-ttu-id="80ae9-135">`UseEndpoints` ajoute l’exécution du point de terminaison au pipeline d’intergiciel (middleware).</span><span class="sxs-lookup"><span data-stu-id="80ae9-135">`UseEndpoints` adds endpoint execution to the middleware pipeline.</span></span> <span data-ttu-id="80ae9-136">Il exécute le délégué associé au point de terminaison sélectionné.</span><span class="sxs-lookup"><span data-stu-id="80ae9-136">It runs the delegate associated with the selected endpoint.</span></span>

<span data-ttu-id="80ae9-137">L’exemple précédent comprend un seul *itinéraire vers le point de terminaison de code* à l’aide de la méthode [MapGet](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*) :</span><span class="sxs-lookup"><span data-stu-id="80ae9-137">The preceding example includes a single *route to code* endpoint using the [MapGet](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*) method:</span></span>

* <span data-ttu-id="80ae9-138">Quand une demande de `GET` HTTP est envoyée à l’URL racine `/`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-138">When an HTTP `GET` request is sent to the root URL `/`:</span></span>
  * <span data-ttu-id="80ae9-139">Le délégué de requête indiqué s’exécute.</span><span class="sxs-lookup"><span data-stu-id="80ae9-139">The request delegate shown executes.</span></span>
  * <span data-ttu-id="80ae9-140">`Hello World!` est écrit dans la réponse HTTP.</span><span class="sxs-lookup"><span data-stu-id="80ae9-140">`Hello World!` is written to the HTTP response.</span></span> <span data-ttu-id="80ae9-141">Par défaut, l’URL racine `/` est `https://localhost:5001/`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-141">By default, the root URL `/` is `https://localhost:5001/`.</span></span>
* <span data-ttu-id="80ae9-142">Si la méthode de demande n’est pas `GET` ou si l’URL racine n’est pas `/`, aucun itinéraire ne correspond et un HTTP 404 est retourné.</span><span class="sxs-lookup"><span data-stu-id="80ae9-142">If the request method is not `GET` or the root URL is not `/`, no route matches and an HTTP 404 is returned.</span></span>

### <a name="endpoint"></a><span data-ttu-id="80ae9-143">Point de terminaison</span><span class="sxs-lookup"><span data-stu-id="80ae9-143">Endpoint</span></span>

<a name="endpoint"></a>

<span data-ttu-id="80ae9-144">La méthode `MapGet` est utilisée pour définir un **point de terminaison**.</span><span class="sxs-lookup"><span data-stu-id="80ae9-144">The `MapGet` method is used to define an **endpoint**.</span></span> <span data-ttu-id="80ae9-145">Un point de terminaison est un point qui peut être :</span><span class="sxs-lookup"><span data-stu-id="80ae9-145">An endpoint is something that can be:</span></span>

* <span data-ttu-id="80ae9-146">Sélectionné en faisant correspondre l’URL et la méthode HTTP.</span><span class="sxs-lookup"><span data-stu-id="80ae9-146">Selected, by matching the URL and HTTP method.</span></span>
* <span data-ttu-id="80ae9-147">Exécuté, en exécutant le délégué.</span><span class="sxs-lookup"><span data-stu-id="80ae9-147">Executed, by running the delegate.</span></span>

<span data-ttu-id="80ae9-148">Les points de terminaison qui peuvent être mis en correspondance et exécutés par l’application sont configurés dans `UseEndpoints`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-148">Endpoints that can be matched and executed by the app are configured in `UseEndpoints`.</span></span> <span data-ttu-id="80ae9-149">Par exemple, les méthodes <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>et [similaires](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions) connectent les délégués de demande au système de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-149">For example, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>, and [similar methods](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions) connect request delegates to the routing system.</span></span>
<span data-ttu-id="80ae9-150">Des méthodes supplémentaires peuvent être utilisées pour connecter les fonctionnalités de ASP.NET Core Framework au système de routage :</span><span class="sxs-lookup"><span data-stu-id="80ae9-150">Additional methods can be used to connect ASP.NET Core framework features to the routing system:</span></span>
- [<span data-ttu-id="80ae9-151">MapRazorPages pour Razor Pages</span><span class="sxs-lookup"><span data-stu-id="80ae9-151">MapRazorPages for Razor Pages</span></span>](xref:Microsoft.AspNetCore.Builder.RazorPagesEndpointRouteBuilderExtensions.MapRazorPages*)
- [<span data-ttu-id="80ae9-152">MapControllers pour les contrôleurs</span><span class="sxs-lookup"><span data-stu-id="80ae9-152">MapControllers for controllers</span></span>](xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllers*)
- [<span data-ttu-id="80ae9-153">MapHub\<THub > pour Signalr</span><span class="sxs-lookup"><span data-stu-id="80ae9-153">MapHub\<THub> for SignalR</span></span>](xref:Microsoft.AspNetCore.SignalR.HubRouteBuilder.MapHub*) 
- [<span data-ttu-id="80ae9-154">MapGrpcService\<TService > pour gRPC</span><span class="sxs-lookup"><span data-stu-id="80ae9-154">MapGrpcService\<TService> for gRPC</span></span>](xref:grpc/aspnetcore)

<span data-ttu-id="80ae9-155">L’exemple suivant illustre le routage avec un modèle d’itinéraire plus sophistiqué :</span><span class="sxs-lookup"><span data-stu-id="80ae9-155">The following example shows routing with a more sophisticated route template:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/RouteTemplateStartup.cs?name=snippet)]

<span data-ttu-id="80ae9-156">La chaîne `/hello/{name:alpha}` est un **modèle d’itinéraire**.</span><span class="sxs-lookup"><span data-stu-id="80ae9-156">The string `/hello/{name:alpha}` is a **route template**.</span></span> <span data-ttu-id="80ae9-157">Il permet de configurer la mise en correspondance du point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-157">It is used to configure how the endpoint is matched.</span></span> <span data-ttu-id="80ae9-158">Dans ce cas, le modèle correspond à :</span><span class="sxs-lookup"><span data-stu-id="80ae9-158">In this case, the template matches:</span></span>

* <span data-ttu-id="80ae9-159">Une URL comme `/hello/Ryan`</span><span class="sxs-lookup"><span data-stu-id="80ae9-159">A URL like `/hello/Ryan`</span></span>
* <span data-ttu-id="80ae9-160">Tout chemin d’URL qui commence par `/hello/` suivi d’une séquence de caractères alphabétiques.</span><span class="sxs-lookup"><span data-stu-id="80ae9-160">Any URL path that begins with `/hello/` followed by a sequence of alphabetic characters.</span></span>  <span data-ttu-id="80ae9-161">`:alpha` applique une contrainte d’itinéraire qui correspond uniquement aux caractères alphabétiques.</span><span class="sxs-lookup"><span data-stu-id="80ae9-161">`:alpha` applies a route constraint that matches only alphabetic characters.</span></span> <span data-ttu-id="80ae9-162">Les [contraintes de routage](#route-constraint-reference) sont expliquées plus loin dans ce document.</span><span class="sxs-lookup"><span data-stu-id="80ae9-162">[Route constraints](#route-constraint-reference) are explained later in this document.</span></span>

<span data-ttu-id="80ae9-163">Le deuxième segment du chemin d’URL, `{name:alpha}`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-163">The second segment of the URL path, `{name:alpha}`:</span></span>

* <span data-ttu-id="80ae9-164">Est lié au paramètre `name`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-164">Is bound to the `name` parameter.</span></span>
* <span data-ttu-id="80ae9-165">Est capturé et stocké dans [HttpRequest. RouteValues](xref:Microsoft.AspNetCore.Http.HttpRequest.RouteValues*).</span><span class="sxs-lookup"><span data-stu-id="80ae9-165">Is captured and stored in [HttpRequest.RouteValues](xref:Microsoft.AspNetCore.Http.HttpRequest.RouteValues*).</span></span>

<span data-ttu-id="80ae9-166">Le système de routage des points de terminaison décrit dans ce document est nouveau à partir de ASP.NET Core 3,0.</span><span class="sxs-lookup"><span data-stu-id="80ae9-166">The endpoint routing system described in this document is new as of ASP.NET Core 3.0.</span></span> <span data-ttu-id="80ae9-167">Toutefois, toutes les versions de ASP.NET Core prennent en charge le même jeu de fonctionnalités de modèle de routage et de contraintes de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-167">However, all versions of ASP.NET Core support the same set of route template features and route constraints.</span></span>

<span data-ttu-id="80ae9-168">L’exemple suivant illustre le routage avec des [contrôles d’intégrité](xref:host-and-deploy/health-checks) et l’autorisation :</span><span class="sxs-lookup"><span data-stu-id="80ae9-168">The following example shows routing with [health checks](xref:host-and-deploy/health-checks) and authorization:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/AuthorizationStartup.cs?name=snippet)]

[!INCLUDE[](~/includes/MTcomments.md)]

<span data-ttu-id="80ae9-169">L’exemple précédent montre comment :</span><span class="sxs-lookup"><span data-stu-id="80ae9-169">The preceding example demonstrates how:</span></span>

* <span data-ttu-id="80ae9-170">L’intergiciel d’autorisation peut être utilisé avec le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-170">The authorization middleware can be used with routing.</span></span>
* <span data-ttu-id="80ae9-171">Les points de terminaison peuvent être utilisés pour configurer le comportement d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="80ae9-171">Endpoints can be used to configure authorization behavior.</span></span>

<span data-ttu-id="80ae9-172">L’appel de <xref:Microsoft.AspNetCore.Builder.HealthCheckEndpointRouteBuilderExtensions.MapHealthChecks*> ajoute un point de terminaison de contrôle d’intégrité.</span><span class="sxs-lookup"><span data-stu-id="80ae9-172">The <xref:Microsoft.AspNetCore.Builder.HealthCheckEndpointRouteBuilderExtensions.MapHealthChecks*> call adds a health check endpoint.</span></span> <span data-ttu-id="80ae9-173">Le chaînage <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*> sur cet appel joint une stratégie d’autorisation au point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-173">Chaining <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*> on to this call attaches an authorization policy to the endpoint.</span></span>

<span data-ttu-id="80ae9-174">L’appel de <xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication*> et <xref:Microsoft.AspNetCore.Builder.AuthorizationAppBuilderExtensions.UseAuthorization*> ajoute l’intergiciel (middleware) d’authentification et d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="80ae9-174">Calling <xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication*> and <xref:Microsoft.AspNetCore.Builder.AuthorizationAppBuilderExtensions.UseAuthorization*> adds the authentication and authorization middleware.</span></span> <span data-ttu-id="80ae9-175">Ces intergiciels sont placés entre <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> et `UseEndpoints` afin de pouvoir :</span><span class="sxs-lookup"><span data-stu-id="80ae9-175">These middleware are placed between <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> and `UseEndpoints` so that they can:</span></span>

* <span data-ttu-id="80ae9-176">Consultez le point de terminaison sélectionné par `UseRouting`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-176">See which endpoint was selected by `UseRouting`.</span></span>
* <span data-ttu-id="80ae9-177">Appliquez une stratégie d’autorisation avant de <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> distribue au point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-177">Apply an authorization policy before <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> dispatches to the endpoint.</span></span>

<a name="metadata"></a>

### <a name="endpoint-metadata"></a><span data-ttu-id="80ae9-178">Métadonnées de point de terminaison</span><span class="sxs-lookup"><span data-stu-id="80ae9-178">Endpoint metadata</span></span>

<span data-ttu-id="80ae9-179">Dans l’exemple précédent, il existe deux points de terminaison, mais seul le point de terminaison de contrôle d’intégrité a une stratégie d’autorisation attachée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-179">In the preceding example, there are two endpoints, but only the health check endpoint has an authorization policy attached.</span></span> <span data-ttu-id="80ae9-180">Si la demande correspond au point de terminaison de contrôle d’intégrité, `/healthz`, une vérification d’autorisation est effectuée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-180">If the request matches the health check endpoint, `/healthz`, an authorization check is performed.</span></span> <span data-ttu-id="80ae9-181">Cela démontre que des données supplémentaires peuvent être attachées aux points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-181">This demonstrates that endpoints can have extra data attached to them.</span></span> <span data-ttu-id="80ae9-182">Ces données supplémentaires sont appelées **métadonnées**de point de terminaison :</span><span class="sxs-lookup"><span data-stu-id="80ae9-182">This extra data is called endpoint **metadata**:</span></span>

* <span data-ttu-id="80ae9-183">Les métadonnées peuvent être traitées par un intergiciel (middleware) qui prend en charge le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-183">The metadata can be processed by routing-aware middleware.</span></span>
* <span data-ttu-id="80ae9-184">Les métadonnées peuvent être de n’importe quel type .NET.</span><span class="sxs-lookup"><span data-stu-id="80ae9-184">The metadata can be of any .NET type.</span></span>

## <a name="routing-concepts"></a><span data-ttu-id="80ae9-185">Concepts de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-185">Routing concepts</span></span>

<span data-ttu-id="80ae9-186">Le système de routage s’appuie sur le pipeline de l’intergiciel (middleware) en ajoutant le puissant concept de **point de terminaison** .</span><span class="sxs-lookup"><span data-stu-id="80ae9-186">The routing system builds on top of the middleware pipeline by adding the powerful **endpoint** concept.</span></span> <span data-ttu-id="80ae9-187">Les points de terminaison représentent les unités de la fonctionnalité de l’application qui sont distinctes les unes des autres en termes de routage, d’autorisation et de tout nombre de systèmes de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="80ae9-187">Endpoints represent units of the app's functionality that are distinct from each other in terms of routing, authorization, and any number of ASP.NET Core's systems.</span></span>

<a name="endpoint"></a>

### <a name="aspnet-core-endpoint-definition"></a><span data-ttu-id="80ae9-188">Définition de point de terminaison ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="80ae9-188">ASP.NET Core endpoint definition</span></span>

<span data-ttu-id="80ae9-189">Un point de terminaison de ASP.NET Core est :</span><span class="sxs-lookup"><span data-stu-id="80ae9-189">An ASP.NET Core endpoint is:</span></span>

* <span data-ttu-id="80ae9-190">Fichier exécutable : a un <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-190">Executable: Has a <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>.</span></span>
* <span data-ttu-id="80ae9-191">Extensible : a une collection de [métadonnées](xref:Microsoft.AspNetCore.Http.Endpoint.Metadata*) .</span><span class="sxs-lookup"><span data-stu-id="80ae9-191">Extensible: Has a [Metadata](xref:Microsoft.AspNetCore.Http.Endpoint.Metadata*) collection.</span></span>
* <span data-ttu-id="80ae9-192">Sélectionnable : le cas échéant, contient des [informations de routage](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern*).</span><span class="sxs-lookup"><span data-stu-id="80ae9-192">Selectable: Optionally, has [routing information](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern*).</span></span>
* <span data-ttu-id="80ae9-193">Énumérable : la collection de points de terminaison peut être listée en extrayant le <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> à partir de [di](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="80ae9-193">Enumerable: The collection of endpoints can be listed by retrieving the <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> from [DI](xref:fundamentals/dependency-injection).</span></span>

<span data-ttu-id="80ae9-194">Le code suivant montre comment récupérer et inspecter le point de terminaison correspondant à la requête actuelle :</span><span class="sxs-lookup"><span data-stu-id="80ae9-194">The following code shows how to retrieve and inspect the endpoint matching the current request:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/EndpointInspectorStartup.cs?name=snippet)]

<span data-ttu-id="80ae9-195">Le point de terminaison, s’il est sélectionné, peut être récupéré à partir de la `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-195">The endpoint, if selected, can be retrieved from the `HttpContext`.</span></span> <span data-ttu-id="80ae9-196">Ses propriétés peuvent être inspectées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-196">Its properties can be inspected.</span></span> <span data-ttu-id="80ae9-197">Les objets de point de terminaison sont immuables et ne peuvent pas être modifiés après la création.</span><span class="sxs-lookup"><span data-stu-id="80ae9-197">Endpoint objects are immutable and cannot be modified after creation.</span></span> <span data-ttu-id="80ae9-198">Le type de point de terminaison le plus courant est un <xref:Microsoft.AspNetCore.Routing.RouteEndpoint>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-198">The most common type of endpoint is a <xref:Microsoft.AspNetCore.Routing.RouteEndpoint>.</span></span> <span data-ttu-id="80ae9-199">`RouteEndpoint` contient des informations qui lui permettent d’être sélectionné par le système de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-199">`RouteEndpoint` includes information that allows it to be to selected by the routing system.</span></span>

<span data-ttu-id="80ae9-200">Dans le code précédent, [application. Utiliser](xref:Microsoft.AspNetCore.Builder.UseExtensions.Use*) configure un [intergiciel (middleware](xref:fundamentals/middleware/index)) en ligne.</span><span class="sxs-lookup"><span data-stu-id="80ae9-200">In the preceding code, [app.Use](xref:Microsoft.AspNetCore.Builder.UseExtensions.Use*) configures an in-line [middleware](xref:fundamentals/middleware/index).</span></span>

<a name="mt"></a>

<span data-ttu-id="80ae9-201">Le code suivant montre que, en fonction de l’endroit où `app.Use` est appelé dans le pipeline, il se peut qu’il n’y ait pas de point de terminaison :</span><span class="sxs-lookup"><span data-stu-id="80ae9-201">The following code shows that, depending on where `app.Use` is called in the pipeline, there may not be an endpoint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/MiddlewareFlowStartup.cs?name=snippet)]

<span data-ttu-id="80ae9-202">L’exemple précédent ajoute des instructions `Console.WriteLine` qui indiquent si un point de terminaison a été sélectionné ou non.</span><span class="sxs-lookup"><span data-stu-id="80ae9-202">This preceding sample adds `Console.WriteLine` statements that display whether or not an endpoint has been selected.</span></span> <span data-ttu-id="80ae9-203">Par souci de clarté, l’exemple assigne un nom complet au point de terminaison `/` fourni.</span><span class="sxs-lookup"><span data-stu-id="80ae9-203">For clarity, the sample assigns a display name to the provided `/` endpoint.</span></span>

<span data-ttu-id="80ae9-204">L’exécution de ce code avec une URL de `/` affiche :</span><span class="sxs-lookup"><span data-stu-id="80ae9-204">Running this code with a URL of `/` displays:</span></span>

```txt
1. Endpoint: (null)
2. Endpoint: Hello
3. Endpoint: Hello
```

<span data-ttu-id="80ae9-205">L’exécution de ce code avec d’autres URL affiche :</span><span class="sxs-lookup"><span data-stu-id="80ae9-205">Running this code with any other URL displays:</span></span>

```txt
1. Endpoint: (null)
2. Endpoint: (null)
4. Endpoint: (null)
```

<span data-ttu-id="80ae9-206">Cette sortie illustre ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="80ae9-206">This output demonstrates that:</span></span>

* <span data-ttu-id="80ae9-207">Le point de terminaison est toujours null avant l’appel de `UseRouting`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-207">The endpoint is always null before `UseRouting` is called.</span></span>
* <span data-ttu-id="80ae9-208">Si une correspondance est trouvée, le point de terminaison n’a pas la valeur null entre `UseRouting` et <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-208">If a match is found, the endpoint is non-null between `UseRouting` and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>
* <span data-ttu-id="80ae9-209">L’intergiciel `UseEndpoints` est **Terminal** quand une correspondance est trouvée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-209">The `UseEndpoints` middleware is **terminal** when a match is found.</span></span> <span data-ttu-id="80ae9-210">L' [intergiciel (middleware) Terminal](#tm) est défini plus loin dans ce document.</span><span class="sxs-lookup"><span data-stu-id="80ae9-210">[Terminal middleware](#tm) is defined later in this document.</span></span>
* <span data-ttu-id="80ae9-211">L’intergiciel après `UseEndpoints` s’exécutent uniquement si aucune correspondance n’est trouvée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-211">The middleware after `UseEndpoints` execute only when no match is found.</span></span>

<span data-ttu-id="80ae9-212">L’intergiciel `UseRouting` utilise la méthode [SetEndpoint](xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.SetEndpoint*) pour attacher le point de terminaison au contexte actuel.</span><span class="sxs-lookup"><span data-stu-id="80ae9-212">The `UseRouting` middleware uses the [SetEndpoint](xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.SetEndpoint*) method to attach the endpoint to the current context.</span></span> <span data-ttu-id="80ae9-213">Il est possible de remplacer l’intergiciel `UseRouting` par une logique personnalisée tout en bénéficiant des avantages de l’utilisation des points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-213">It's possible to replace the `UseRouting` middleware with custom logic and still get the benefits of using endpoints.</span></span> <span data-ttu-id="80ae9-214">Les points de terminaison sont une primitive de bas niveau, comme l’intergiciel (middleware), et ne sont pas couplés à l’implémentation du routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-214">Endpoints are a low-level primitive like middleware, and aren't coupled to the routing implementation.</span></span> <span data-ttu-id="80ae9-215">La plupart des applications n’ont pas besoin de remplacer `UseRouting` par une logique personnalisée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-215">Most apps don't need to replace `UseRouting` with custom logic.</span></span>

<span data-ttu-id="80ae9-216">L’intergiciel `UseEndpoints` est conçu pour être utilisé conjointement avec l’intergiciel (middleware) `UseRouting`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-216">The `UseEndpoints` middleware is designed to be used in tandem with the `UseRouting` middleware.</span></span> <span data-ttu-id="80ae9-217">La logique de base pour exécuter un point de terminaison n’est pas compliquée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-217">The core logic to execute an endpoint isn't complicated.</span></span> <span data-ttu-id="80ae9-218">Utilisez <xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*> pour récupérer le point de terminaison, puis appelez sa propriété <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-218">Use <xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*> to retrieve the endpoint, and then invoke its <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate> property.</span></span>

<span data-ttu-id="80ae9-219">Le code suivant montre comment l’intergiciel (middleware) peut influencer ou réagir au routage :</span><span class="sxs-lookup"><span data-stu-id="80ae9-219">The following code demonstrates how middleware can influence or react to routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/IntegratedMiddlewareStartup.cs?name=snippet)]

<span data-ttu-id="80ae9-220">L’exemple précédent illustre deux concepts importants :</span><span class="sxs-lookup"><span data-stu-id="80ae9-220">The preceding example demonstrates two important concepts:</span></span>

* <span data-ttu-id="80ae9-221">L’intergiciel peut s’exécuter avant `UseRouting` pour modifier les données sur lesquelles le routage s’exécute.</span><span class="sxs-lookup"><span data-stu-id="80ae9-221">Middleware can run before `UseRouting` to modify the data that routing operates upon.</span></span>
    * <span data-ttu-id="80ae9-222">En général, l’intergiciel s’affiche avant que le routage ne modifie une propriété de la requête, par exemple <xref:Microsoft.AspNetCore.Builder.RewriteBuilderExtensions.UseRewriter*>, <xref:Microsoft.AspNetCore.Builder.HttpMethodOverrideExtensions.UseHttpMethodOverride*>ou <xref:Microsoft.AspNetCore.Builder.UsePathBaseExtensions.UsePathBase*>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-222">Usually middleware that appears before routing modifies some property of the request, such as <xref:Microsoft.AspNetCore.Builder.RewriteBuilderExtensions.UseRewriter*>, <xref:Microsoft.AspNetCore.Builder.HttpMethodOverrideExtensions.UseHttpMethodOverride*>, or <xref:Microsoft.AspNetCore.Builder.UsePathBaseExtensions.UsePathBase*>.</span></span>
* <span data-ttu-id="80ae9-223">L’intergiciel peut s’exécuter entre `UseRouting` et <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> pour traiter les résultats du routage avant l’exécution du point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-223">Middleware can run between `UseRouting` and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> to process the results of routing before the endpoint is executed.</span></span>
    * <span data-ttu-id="80ae9-224">Intergiciel qui s’exécute entre `UseRouting` et `UseEndpoints`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-224">Middleware that runs between `UseRouting` and `UseEndpoints`:</span></span>
      * <span data-ttu-id="80ae9-225">Inspecte généralement les métadonnées pour comprendre les points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-225">Usually inspects metadata to understand the endpoints.</span></span>
      * <span data-ttu-id="80ae9-226">Prend souvent des décisions en matière de sécurité, comme c’est le cas `UseAuthorization` et `UseCors`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-226">Often makes security decisions, as done by `UseAuthorization` and `UseCors`.</span></span>
    * <span data-ttu-id="80ae9-227">La combinaison d’intergiciels (middleware) et de métadonnées permet de configurer des stratégies par point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-227">The combination of middleware and metadata allows configuring policies per-endpoint.</span></span>

<span data-ttu-id="80ae9-228">Le code précédent montre un exemple d’un intergiciel (middleware) personnalisé qui prend en charge les stratégies par point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-228">The preceding code shows an example of a custom middleware that supports per-endpoint policies.</span></span> <span data-ttu-id="80ae9-229">L’intergiciel écrit un *Journal d’audit* de l’accès aux données sensibles sur la console.</span><span class="sxs-lookup"><span data-stu-id="80ae9-229">The middleware writes an *audit log* of access to sensitive data to the console.</span></span> <span data-ttu-id="80ae9-230">L’intergiciel peut être configuré pour *auditer* un point de terminaison avec les métadonnées `AuditPolicyAttribute`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-230">The middleware can be configured to *audit* an endpoint with the `AuditPolicyAttribute` metadata.</span></span> <span data-ttu-id="80ae9-231">Cet exemple illustre un modèle d' *abonnement* dans lequel seuls les points de terminaison marqués comme sensibles sont audités.</span><span class="sxs-lookup"><span data-stu-id="80ae9-231">This sample demonstrates an *opt-in* pattern where only endpoints that are marked as sensitive are audited.</span></span> <span data-ttu-id="80ae9-232">Il est possible de définir cette logique en sens inverse, en auditant tout ce qui n’est pas marqué comme sécurisé, par exemple.</span><span class="sxs-lookup"><span data-stu-id="80ae9-232">It's possible to define this logic in reverse, auditing everything that isn't marked as safe, for example.</span></span> <span data-ttu-id="80ae9-233">Le système de métadonnées du point de terminaison est flexible.</span><span class="sxs-lookup"><span data-stu-id="80ae9-233">The endpoint metadata system is flexible.</span></span> <span data-ttu-id="80ae9-234">Cette logique peut être conçue de la manière qui convient le mieux au cas d’usage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-234">This logic could be designed in whatever way suits the use case.</span></span>

<span data-ttu-id="80ae9-235">L’exemple de code précédent est destiné à illustrer les concepts de base des points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-235">The preceding sample code is intended to demonstrate the basic concepts of endpoints.</span></span> <span data-ttu-id="80ae9-236">**L’exemple n’est pas destiné à une utilisation en production**.</span><span class="sxs-lookup"><span data-stu-id="80ae9-236">**The sample is not intended for production use**.</span></span> <span data-ttu-id="80ae9-237">Une version plus complète d’un intergiciel (middleware) de *journaux d’audit* :</span><span class="sxs-lookup"><span data-stu-id="80ae9-237">A more complete version of an *audit log* middleware would:</span></span>

* <span data-ttu-id="80ae9-238">Connectez-vous à un fichier ou à une base de données.</span><span class="sxs-lookup"><span data-stu-id="80ae9-238">Log to a file or database.</span></span>
* <span data-ttu-id="80ae9-239">Incluez des détails tels que l’utilisateur, l’adresse IP, le nom du point de terminaison sensible, et bien plus encore.</span><span class="sxs-lookup"><span data-stu-id="80ae9-239">Include details such as the user, IP address, name of the sensitive endpoint, and more.</span></span>

<span data-ttu-id="80ae9-240">Le `AuditPolicyAttribute` de métadonnées de stratégie d’audit est défini en tant que `Attribute` pour une utilisation plus facile avec les infrastructures basées sur des classes telles que les contrôleurs et Signalr.</span><span class="sxs-lookup"><span data-stu-id="80ae9-240">The audit policy metadata `AuditPolicyAttribute` is defined as an `Attribute` for easier use with class-based frameworks such as controllers and SignalR.</span></span> <span data-ttu-id="80ae9-241">Lors de l’utilisation *de l’itinéraire vers le code*:</span><span class="sxs-lookup"><span data-stu-id="80ae9-241">When using *route to code*:</span></span>

* <span data-ttu-id="80ae9-242">Les métadonnées sont jointes à une API de générateur.</span><span class="sxs-lookup"><span data-stu-id="80ae9-242">Metadata is attached with a builder API.</span></span>
* <span data-ttu-id="80ae9-243">Les infrastructures basées sur des classes incluent tous les attributs de la méthode et de la classe correspondantes lors de la création de points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-243">Class-based frameworks include all attributes on the corresponding method and class when creating endpoints.</span></span>

<span data-ttu-id="80ae9-244">Les meilleures pratiques pour les types de métadonnées sont de les définir comme des interfaces ou des attributs.</span><span class="sxs-lookup"><span data-stu-id="80ae9-244">The best practices for metadata types are to define them either as interfaces or attributes.</span></span> <span data-ttu-id="80ae9-245">Les interfaces et les attributs permettent de réutiliser le code.</span><span class="sxs-lookup"><span data-stu-id="80ae9-245">Interfaces and attributes allow code reuse.</span></span> <span data-ttu-id="80ae9-246">Le système de métadonnées est flexible et n’impose aucune restriction.</span><span class="sxs-lookup"><span data-stu-id="80ae9-246">The metadata system is flexible and doesn't impose any limitations.</span></span>

<a name="tm"></a>

### <a name="comparing-a-terminal-middleware-and-routing"></a><span data-ttu-id="80ae9-247">Comparaison entre un intergiciel et un routage de terminaux</span><span class="sxs-lookup"><span data-stu-id="80ae9-247">Comparing a terminal middleware and routing</span></span>

<span data-ttu-id="80ae9-248">L’exemple de code suivant compare l’utilisation de l’intergiciel avec le routage :</span><span class="sxs-lookup"><span data-stu-id="80ae9-248">The following code sample contrasts using middleware with using routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/TerminalMiddlewareStartup.cs?name=snippet)]

<span data-ttu-id="80ae9-249">Le style d’intergiciel (middleware) présenté avec `Approach 1:` est l' **intergiciel (middleware) Terminal**.</span><span class="sxs-lookup"><span data-stu-id="80ae9-249">The style of middleware shown with `Approach 1:` is **terminal middleware**.</span></span> <span data-ttu-id="80ae9-250">Il s’agit de l’intergiciel (middleware) Terminal Server, car il effectue une opération de correspondance :</span><span class="sxs-lookup"><span data-stu-id="80ae9-250">It's called terminal middleware because it does a matching operation:</span></span>

* <span data-ttu-id="80ae9-251">L’opération de correspondance dans l’exemple précédent est `Path == "/"` pour l’intergiciel (middleware) et `Path == "/Movie"` pour le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-251">The matching operation in the preceding sample is `Path == "/"` for the middleware and `Path == "/Movie"` for routing.</span></span>
* <span data-ttu-id="80ae9-252">Lorsqu’une correspondance est réussie, elle exécute certaines fonctionnalités et retourne, plutôt que d’appeler l’intergiciel `next`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-252">When a match is successful, it executes some functionality and returns, rather than invoking the `next` middleware.</span></span>

<span data-ttu-id="80ae9-253">Il s’agit de l’intergiciel (middleware) middleware de terminaux, car il met fin à la recherche, exécute certaines fonctionnalités, puis retourne.</span><span class="sxs-lookup"><span data-stu-id="80ae9-253">It's called terminal middleware middleware because it terminates the search, executes some functionality, and then returns.</span></span>

<span data-ttu-id="80ae9-254">Comparaison entre un intergiciel et un routage de terminaux :</span><span class="sxs-lookup"><span data-stu-id="80ae9-254">Comparing a terminal middleware and routing:</span></span>
* <span data-ttu-id="80ae9-255">Les deux approches permettent d’arrêter le pipeline de traitement :</span><span class="sxs-lookup"><span data-stu-id="80ae9-255">Both approaches allow terminating the processing pipeline:</span></span>
    * <span data-ttu-id="80ae9-256">L’intergiciel met fin au pipeline en retournant plutôt qu’en appelant `next`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-256">Middleware terminates the pipeline by returning rather than invoking `next`.</span></span>
    * <span data-ttu-id="80ae9-257">Les points de terminaison sont toujours des terminaux.</span><span class="sxs-lookup"><span data-stu-id="80ae9-257">Endpoints are always terminal.</span></span>
* <span data-ttu-id="80ae9-258">L’intergiciel (middleware) Terminal permet de positionner l’intergiciel (middleware) à un emplacement arbitraire dans le pipeline :</span><span class="sxs-lookup"><span data-stu-id="80ae9-258">Terminal middleware allows positioning the middleware at an arbitrary place in the pipeline:</span></span>
    * <span data-ttu-id="80ae9-259">Les points de terminaison s’exécutent à la position de <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-259">Endpoints execute at the position of <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>
* <span data-ttu-id="80ae9-260">L’intergiciel (middleware) Terminal permet au code arbitraire de déterminer quand l’intergiciel correspond à :</span><span class="sxs-lookup"><span data-stu-id="80ae9-260">Terminal middleware allows arbitrary code to determine when the middleware matches:</span></span>
    * <span data-ttu-id="80ae9-261">Le code de correspondance d’itinéraire personnalisé peut être détaillé et difficile à écrire correctement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-261">Custom route matching code can be verbose and difficult to write correctly.</span></span>
    * <span data-ttu-id="80ae9-262">Le routage fournit des solutions simples pour les applications classiques.</span><span class="sxs-lookup"><span data-stu-id="80ae9-262">Routing provides straightforward solutions for typical apps.</span></span> <span data-ttu-id="80ae9-263">La plupart des applications n’ont pas besoin de code de correspondance d’itinéraire personnalisé.</span><span class="sxs-lookup"><span data-stu-id="80ae9-263">Most apps don't require custom route matching code.</span></span>
* <span data-ttu-id="80ae9-264">Interface des points de terminaison avec intergiciel, par exemple `UseAuthorization` et `UseCors`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-264">Endpoints interface with middleware such as `UseAuthorization` and `UseCors`.</span></span>
    * <span data-ttu-id="80ae9-265">L’utilisation d’un intergiciel (middleware) terminal avec `UseAuthorization` ou `UseCors` nécessite une interface manuelle avec le système d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="80ae9-265">Using a terminal middleware with `UseAuthorization` or `UseCors` requires manual interfacing with the authorization system.</span></span>

<span data-ttu-id="80ae9-266">Un [point de terminaison](#endpoint) définit les deux :</span><span class="sxs-lookup"><span data-stu-id="80ae9-266">An [endpoint](#endpoint) defines both:</span></span>

* <span data-ttu-id="80ae9-267">Délégué pour traiter les demandes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-267">A delegate to process requests.</span></span>
* <span data-ttu-id="80ae9-268">Collection de métadonnées arbitraires.</span><span class="sxs-lookup"><span data-stu-id="80ae9-268">A collection of arbitrary metadata.</span></span> <span data-ttu-id="80ae9-269">Les métadonnées sont utilisées pour implémenter des problèmes transversaux en fonction des stratégies et de la configuration attachées à chaque point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-269">The metadata is used to implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="80ae9-270">L’intergiciel (middleware) terminal peut être un outil efficace, mais peut nécessiter les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="80ae9-270">Terminal middleware can be an effective tool, but can require:</span></span>

* <span data-ttu-id="80ae9-271">Une quantité significative de codage et de test.</span><span class="sxs-lookup"><span data-stu-id="80ae9-271">A significant amount of coding and testing.</span></span>
* <span data-ttu-id="80ae9-272">Intégration manuelle avec d’autres systèmes pour atteindre le niveau de flexibilité souhaité.</span><span class="sxs-lookup"><span data-stu-id="80ae9-272">Manual integration with other systems to achieve the desired level of flexibility.</span></span>

<span data-ttu-id="80ae9-273">Envisagez l’intégration avec le routage avant d’écrire un intergiciel (middleware) Terminal.</span><span class="sxs-lookup"><span data-stu-id="80ae9-273">Consider integrating with routing before writing a terminal middleware.</span></span>

<span data-ttu-id="80ae9-274">L’intergiciel (middleware) terminal existant qui s’intègre à [Map](xref:fundamentals/middleware/index#branch-the-middleware-pipeline) ou <xref:Microsoft.AspNetCore.Builder.MapWhenExtensions.MapWhen*> peut généralement être converti en point de terminaison prenant en charge le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-274">Existing terminal middleware that integrates with [Map](xref:fundamentals/middleware/index#branch-the-middleware-pipeline) or <xref:Microsoft.AspNetCore.Builder.MapWhenExtensions.MapWhen*> can usually be turned into a routing aware endpoint.</span></span> <span data-ttu-id="80ae9-275">[MapHealthChecks](https://github.com/aspnet/AspNetCore/blob/master/src/Middleware/HealthChecks/src/Builder/HealthCheckEndpointRouteBuilderExtensions.cs#L16) illustre le modèle de routeur-Ware :</span><span class="sxs-lookup"><span data-stu-id="80ae9-275">[MapHealthChecks](https://github.com/aspnet/AspNetCore/blob/master/src/Middleware/HealthChecks/src/Builder/HealthCheckEndpointRouteBuilderExtensions.cs#L16) demonstrates the pattern for router-ware:</span></span>
* <span data-ttu-id="80ae9-276">Écrire une méthode d’extension sur <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-276">Write an extension method on <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span></span>
* <span data-ttu-id="80ae9-277">Créez un pipeline d’intergiciel (middleware) imbriqué à l’aide de <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder.CreateApplicationBuilder*>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-277">Create a nested middleware pipeline using <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder.CreateApplicationBuilder*>.</span></span>
* <span data-ttu-id="80ae9-278">Attachez l’intergiciel au nouveau pipeline.</span><span class="sxs-lookup"><span data-stu-id="80ae9-278">Attach the middleware to the new pipeline.</span></span> <span data-ttu-id="80ae9-279">Dans ce cas, <xref:Microsoft.AspNetCore.Builder.HealthCheckApplicationBuilderExtensions.UseHealthChecks*>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-279">In this case, <xref:Microsoft.AspNetCore.Builder.HealthCheckApplicationBuilderExtensions.UseHealthChecks*>.</span></span>
* <span data-ttu-id="80ae9-280"><xref:Microsoft.AspNetCore.Builder.IApplicationBuilder.Build*> le pipeline d’intergiciel (middleware) dans un <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-280"><xref:Microsoft.AspNetCore.Builder.IApplicationBuilder.Build*> the middleware pipeline into a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span>
* <span data-ttu-id="80ae9-281">Appelez `Map` et fournissez le nouveau pipeline middleware.</span><span class="sxs-lookup"><span data-stu-id="80ae9-281">Call `Map` and provide the new middleware pipeline.</span></span>
* <span data-ttu-id="80ae9-282">Retourne l’objet générateur fourni par `Map` à partir de la méthode d’extension.</span><span class="sxs-lookup"><span data-stu-id="80ae9-282">Return the builder object provided by `Map` from the extension method.</span></span>

<span data-ttu-id="80ae9-283">Le code suivant illustre l’utilisation de [MapHealthChecks](xref:host-and-deploy/health-checks):</span><span class="sxs-lookup"><span data-stu-id="80ae9-283">The following code shows use of [MapHealthChecks](xref:host-and-deploy/health-checks):</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/AuthorizationStartup.cs?name=snippet)]

<span data-ttu-id="80ae9-284">L’exemple précédent montre pourquoi le retour de l’objet générateur est important.</span><span class="sxs-lookup"><span data-stu-id="80ae9-284">The preceding sample shows why returning the builder object is important.</span></span> <span data-ttu-id="80ae9-285">Le retour de l’objet générateur permet au développeur de l’application de configurer des stratégies telles que l’autorisation pour le point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-285">Returning the builder object allows the app developer to configure policies such as authorization for the endpoint.</span></span> <span data-ttu-id="80ae9-286">Dans cet exemple, l’intergiciel (middleware) des contrôles d’intégrité n’a pas d’intégration directe avec le système d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="80ae9-286">In this example, the health checks middleware has no direct integration with the authorization system.</span></span>

<span data-ttu-id="80ae9-287">Le système de métadonnées a été créé en réponse aux problèmes rencontrés par les auteurs d’extensibilité à l’aide de l’intergiciel (middleware) Terminal.</span><span class="sxs-lookup"><span data-stu-id="80ae9-287">The metadata system was created in response to the problems encountered by extensibility authors using terminal middleware.</span></span> <span data-ttu-id="80ae9-288">Il est difficile pour chaque intergiciel d’implémenter sa propre intégration au système d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="80ae9-288">It's problematic for each middleware to implement its own integration with the authorization system.</span></span>

<a name="urlm"></a>

### <a name="url-matching"></a><span data-ttu-id="80ae9-289">Correspondance d’URL</span><span class="sxs-lookup"><span data-stu-id="80ae9-289">URL matching</span></span>

* <span data-ttu-id="80ae9-290">Est le processus par lequel le routage correspond à une requête entrante à un [point de terminaison](#endpoint).</span><span class="sxs-lookup"><span data-stu-id="80ae9-290">Is the process by which routing matches an incoming request to an [endpoint](#endpoint).</span></span>
* <span data-ttu-id="80ae9-291">Est basé sur les données du chemin d’URL et des en-têtes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-291">Is based on data in the URL path and headers.</span></span>
* <span data-ttu-id="80ae9-292">Peut être étendu pour prendre en compte toutes les données de la requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-292">Can be extended to consider any data in the request.</span></span>

<span data-ttu-id="80ae9-293">Lors de l’exécution d’un intergiciel (middleware) de routage, il définit une `Endpoint` et des valeurs d’itinéraire sur une [fonctionnalité de demande](xref:fundamentals/request-features) sur le <xref:Microsoft.AspNetCore.Http.HttpContext> à partir de la requête actuelle :</span><span class="sxs-lookup"><span data-stu-id="80ae9-293">When a routing middleware executes, it sets an `Endpoint` and route values to a [request feature](xref:fundamentals/request-features) on the <xref:Microsoft.AspNetCore.Http.HttpContext> from the current request:</span></span>

* <span data-ttu-id="80ae9-294">L’appel de [HttpContext. GetEndpoint](<xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*>) obtient le point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-294">Calling [HttpContext.GetEndpoint](<xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*>) gets the endpoint.</span></span>
* <span data-ttu-id="80ae9-295">`HttpRequest.RouteValues` récupère la collection de valeurs d’itinéraire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-295">`HttpRequest.RouteValues` gets the collection of route values.</span></span>

<span data-ttu-id="80ae9-296">L' [intergiciel](xref:fundamentals/middleware/index) s’exécutant après l’intergiciel (middleware) de routage peut inspecter le point de terminaison et agir.</span><span class="sxs-lookup"><span data-stu-id="80ae9-296">[Middleware](xref:fundamentals/middleware/index) running after the routing middleware can inspect the endpoint and take action.</span></span> <span data-ttu-id="80ae9-297">Par exemple, un intergiciel (middleware) d’autorisation peut interroger la collection de métadonnées du point de terminaison pour une stratégie d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="80ae9-297">For example, an authorization middleware can interrogate the endpoint's metadata collection for an authorization policy.</span></span> <span data-ttu-id="80ae9-298">Une fois que tous les intergiciels dans le pipeline de traitement de requêtes sont exécutés, le délégué du point de terminaison sélectionné est appelé.</span><span class="sxs-lookup"><span data-stu-id="80ae9-298">After all of the middleware in the request processing pipeline is executed, the selected endpoint's delegate is invoked.</span></span>

<span data-ttu-id="80ae9-299">Le système de routage dans le routage de point de terminaison est responsable de toutes les décisions de distribution.</span><span class="sxs-lookup"><span data-stu-id="80ae9-299">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="80ae9-300">Étant donné que l’intergiciel applique des stratégies basées sur le point de terminaison sélectionné, il est important que :</span><span class="sxs-lookup"><span data-stu-id="80ae9-300">Because the middleware applies policies based on the selected endpoint, it's important that:</span></span>

* <span data-ttu-id="80ae9-301">Toute décision qui peut affecter la distribution ou l’application de stratégies de sécurité est effectuée à l’intérieur du système de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-301">Any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

> [!WARNING]
> <span data-ttu-id="80ae9-302">À des fins de compatibilité descendante, lors de l’exécution d’un contrôleur ou d’un délégué de point de terminaison Razor Pages, les propriétés de [RouteContext. RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) sont définies sur les valeurs appropriées en fonction du traitement de la demande effectué jusqu’à présent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-302">For backwards-compatibility, when a Controller or Razor Pages endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>
>
> <span data-ttu-id="80ae9-303">Le type de `RouteContext` sera marqué comme obsolète dans une version ultérieure :</span><span class="sxs-lookup"><span data-stu-id="80ae9-303">The `RouteContext` type will be marked obsolete in a future release:</span></span>
>
> * <span data-ttu-id="80ae9-304">Migrez `RouteData.Values` vers `HttpRequest.RouteValues`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-304">Migrate `RouteData.Values` to `HttpRequest.RouteValues`.</span></span>
> * <span data-ttu-id="80ae9-305">Migrez `RouteData.DataTokens` pour récupérer [IDataTokensMetadata](xref:Microsoft.AspNetCore.Routing.IDataTokensMetadata) à partir des métadonnées de point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-305">Migrate `RouteData.DataTokens` to retrieve [IDataTokensMetadata](xref:Microsoft.AspNetCore.Routing.IDataTokensMetadata) from the endpoint metadata.</span></span>

<span data-ttu-id="80ae9-306">La correspondance d’URL fonctionne dans un ensemble configurable de phases.</span><span class="sxs-lookup"><span data-stu-id="80ae9-306">URL matching operates in a configurable set of phases.</span></span> <span data-ttu-id="80ae9-307">Dans chaque phase, la sortie est un ensemble de correspondances.</span><span class="sxs-lookup"><span data-stu-id="80ae9-307">In each phase, the output is a set of matches.</span></span> <span data-ttu-id="80ae9-308">L’ensemble des correspondances peut être réduit davantage à la phase suivante.</span><span class="sxs-lookup"><span data-stu-id="80ae9-308">The set of matches can be narrowed down further by the next phase.</span></span> <span data-ttu-id="80ae9-309">L’implémentation du routage ne garantit pas un ordre de traitement pour les points de terminaison correspondants.</span><span class="sxs-lookup"><span data-stu-id="80ae9-309">The routing implementation does not guarantee a processing order for matching endpoints.</span></span> <span data-ttu-id="80ae9-310">**Toutes les** correspondances possibles sont traitées en même temps.</span><span class="sxs-lookup"><span data-stu-id="80ae9-310">**All** possible matches are processed at once.</span></span> <span data-ttu-id="80ae9-311">Les phases de correspondance d’URL se produisent dans l’ordre suivant.</span><span class="sxs-lookup"><span data-stu-id="80ae9-311">The URL matching phases occur in the following order.</span></span> <span data-ttu-id="80ae9-312">ASP.NET Core :</span><span class="sxs-lookup"><span data-stu-id="80ae9-312">ASP.NET Core:</span></span>

1. <span data-ttu-id="80ae9-313">Traite le chemin d’accès de l’URL par rapport à l’ensemble des points de terminaison et de leurs modèles d’itinéraire, en collectant **toutes** les correspondances.</span><span class="sxs-lookup"><span data-stu-id="80ae9-313">Processes the URL path against the set of endpoints and their route templates, collecting **all** of the matches.</span></span>
1. <span data-ttu-id="80ae9-314">Prend la liste précédente et supprime les correspondances qui échouent avec les contraintes d’itinéraire appliquées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-314">Takes the preceding list and removes matches that fail with route constraints applied.</span></span>
1. <span data-ttu-id="80ae9-315">Prend la liste précédente et supprime les correspondances qui échouent à l’ensemble des instances [MatcherPolicy](xref:Microsoft.AspNetCore.Routing.MatcherPolicy) .</span><span class="sxs-lookup"><span data-stu-id="80ae9-315">Takes the preceding list and removes matches that fail the set of [MatcherPolicy](xref:Microsoft.AspNetCore.Routing.MatcherPolicy) instances.</span></span>
1. <span data-ttu-id="80ae9-316">Utilise [EndpointSelector](xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector) pour prendre une décision finale de la liste précédente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-316">Uses the [EndpointSelector](xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector) to make a final decision from the preceding list.</span></span>

<span data-ttu-id="80ae9-317">La liste des points de terminaison est hiérarchisée en fonction des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="80ae9-317">The list of endpoints is prioritized according to:</span></span>

* <span data-ttu-id="80ae9-318">[RouteEndpoint. Order](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order*)</span><span class="sxs-lookup"><span data-stu-id="80ae9-318">The [RouteEndpoint.Order](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order*)</span></span>
* <span data-ttu-id="80ae9-319">[Priorité du modèle de routage](#rtp)</span><span class="sxs-lookup"><span data-stu-id="80ae9-319">The [route template precedence](#rtp)</span></span>

<span data-ttu-id="80ae9-320">Tous les points de terminaison correspondants sont traités dans chaque phase jusqu’à ce que le <xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector> soit atteint.</span><span class="sxs-lookup"><span data-stu-id="80ae9-320">All matching endpoints are processed in each phase until the <xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector> is reached.</span></span> <span data-ttu-id="80ae9-321">La `EndpointSelector` est la phase finale.</span><span class="sxs-lookup"><span data-stu-id="80ae9-321">The `EndpointSelector` is the final phase.</span></span> <span data-ttu-id="80ae9-322">Il choisit le point de terminaison dont la priorité est la plus élevée parmi les correspondances comme meilleure correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-322">It chooses the highest priority endpoint from the matches as the best match.</span></span> <span data-ttu-id="80ae9-323">S’il existe d’autres correspondances avec la même priorité que la meilleure correspondance, une exception de correspondance ambiguë est levée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-323">If there are other matches with the same priority as the best match, an ambiguous match exception is thrown.</span></span>

<span data-ttu-id="80ae9-324">La priorité d’itinéraire est calculée sur la base d’un modèle d’itinéraire **plus spécifique** qui reçoit une priorité plus élevée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-324">The route precedence is computed based on a **more specific** route template being given a higher priority.</span></span> <span data-ttu-id="80ae9-325">Par exemple, considérez les modèles `/hello` et `/{message}`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-325">For example, consider the templates `/hello` and `/{message}`:</span></span>

* <span data-ttu-id="80ae9-326">Les deux correspondent au chemin d’URL `/hello`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-326">Both match the URL path `/hello`.</span></span>
* <span data-ttu-id="80ae9-327">`/hello` est plus spécifique et par conséquent une priorité plus élevée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-327">`/hello`  is more specific and therefore higher priority.</span></span>

<span data-ttu-id="80ae9-328">En général, la priorité des itinéraires est un bon choix pour choisir la meilleure correspondance pour les types de schémas d’URL utilisés dans la pratique.</span><span class="sxs-lookup"><span data-stu-id="80ae9-328">In general, route precedence does a good job of choosing the best match for the kinds of URL schemes used in practice.</span></span> <span data-ttu-id="80ae9-329">Utilisez <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order> uniquement lorsque cela est nécessaire pour éviter une ambiguïté.</span><span class="sxs-lookup"><span data-stu-id="80ae9-329">Use <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order> only when necessary to avoid an ambiguity.</span></span>

<span data-ttu-id="80ae9-330">En raison des types d’extensibilité fournis par le routage, il n’est pas possible pour le système de routage de calculer à l’avance les itinéraires ambigus.</span><span class="sxs-lookup"><span data-stu-id="80ae9-330">Due to the kinds of extensibility provided by routing, it isn't possible for the routing system to compute ahead of time the ambiguous routes.</span></span> <span data-ttu-id="80ae9-331">Prenons l’exemple des modèles de routage `/{message:alpha}` et `/{message:int}`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-331">Consider an example such as the route templates `/{message:alpha}` and `/{message:int}`:</span></span>

* <span data-ttu-id="80ae9-332">La contrainte de `alpha` correspond uniquement aux caractères alphabétiques.</span><span class="sxs-lookup"><span data-stu-id="80ae9-332">The `alpha` constraint matches only alphabetic characters.</span></span>
* <span data-ttu-id="80ae9-333">La contrainte de `int` correspond uniquement aux nombres.</span><span class="sxs-lookup"><span data-stu-id="80ae9-333">The `int` constraint matches only numbers.</span></span>
* <span data-ttu-id="80ae9-334">Ces modèles ont la même priorité d’itinéraire, mais il n’y a pas d’URL unique correspondantes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-334">These templates have the same route precedence, but there's no single URL they both match.</span></span>
* <span data-ttu-id="80ae9-335">Si le système de routage a signalé une erreur d’ambiguïté au démarrage, il bloquerait ce cas d’utilisation valide.</span><span class="sxs-lookup"><span data-stu-id="80ae9-335">If the routing system reported an ambiguity error at startup, it would block this valid use case.</span></span>

> [!WARNING]
>
> <span data-ttu-id="80ae9-336">L’ordre des opérations dans <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> n’influe pas sur le comportement du routage, à une exception près.</span><span class="sxs-lookup"><span data-stu-id="80ae9-336">The order of operations inside <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> doesn't influence the behavior of routing, with one exception.</span></span> <span data-ttu-id="80ae9-337"><xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> et <xref:Microsoft.AspNetCore.Builder.MvcAreaRouteBuilderExtensions.MapAreaRoute*> affecter automatiquement une valeur de commande à leurs points de terminaison en fonction de l’ordre dans lequel ils sont appelés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-337"><xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> and <xref:Microsoft.AspNetCore.Builder.MvcAreaRouteBuilderExtensions.MapAreaRoute*> automatically assign an order value to their endpoints based on the order they are invoked.</span></span> <span data-ttu-id="80ae9-338">Cela simule le comportement à long terme des contrôleurs sans le système de routage fournissant les mêmes garanties que les implémentations de routage plus anciennes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-338">This simulates long-time behavior of controllers without the routing system providing the same guarantees as older routing implementations.</span></span>
>
> <span data-ttu-id="80ae9-339">Dans l’implémentation héritée du routage, il est possible d’implémenter l’extensibilité du routage qui dépend de l’ordre dans lequel les itinéraires sont traités.</span><span class="sxs-lookup"><span data-stu-id="80ae9-339">In the legacy implementation of routing, it's possible to implement routing extensibility that has a dependency on the order in which routes are processed.</span></span> <span data-ttu-id="80ae9-340">Routage des points de terminaison dans ASP.NET Core 3,0 et versions ultérieures :</span><span class="sxs-lookup"><span data-stu-id="80ae9-340">Endpoint routing in ASP.NET Core 3.0 and later:</span></span>
> 
> * <span data-ttu-id="80ae9-341">N’a pas de concept d’itinéraires.</span><span class="sxs-lookup"><span data-stu-id="80ae9-341">Doesn't have a concept of routes.</span></span>
> * <span data-ttu-id="80ae9-342">Ne fournit pas de garanties de classement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-342">Doesn't provide ordering guarantees.</span></span> <span data-ttu-id="80ae9-343">Tous les points de terminaison sont traités à la fois.</span><span class="sxs-lookup"><span data-stu-id="80ae9-343">All endpoints are processed at once.</span></span>
>
> <span data-ttu-id="80ae9-344">Si cela signifie que vous êtes bloqué en utilisant le système de routage hérité, [ouvrez un problème GitHub pour obtenir de l’aide](https://github.com/dotnet/aspnetcore/issues).</span><span class="sxs-lookup"><span data-stu-id="80ae9-344">If this means you're stuck using the legacy routing system, [open a GitHub issue for assistance](https://github.com/dotnet/aspnetcore/issues).</span></span>

<a name="rtp"></a>

### <a name="route-template-precedence-and-endpoint-selection-order"></a><span data-ttu-id="80ae9-345">Priorité des modèles de routage et ordre de sélection des points de terminaison</span><span class="sxs-lookup"><span data-stu-id="80ae9-345">Route template precedence and endpoint selection order</span></span>

<span data-ttu-id="80ae9-346">La [priorité des modèles de routage](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L16) est un système qui affecte à chaque modèle de routage une valeur en fonction de sa spécificité.</span><span class="sxs-lookup"><span data-stu-id="80ae9-346">[Route template precedence](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L16) is a system that assigns each route template a value based on how specific it is.</span></span> <span data-ttu-id="80ae9-347">Priorité du modèle de routage :</span><span class="sxs-lookup"><span data-stu-id="80ae9-347">Route template precedence:</span></span>

* <span data-ttu-id="80ae9-348">Évite d’avoir à ajuster l’ordre des points de terminaison dans les cas courants.</span><span class="sxs-lookup"><span data-stu-id="80ae9-348">Avoids the need to adjust the order of endpoints in common cases.</span></span>
* <span data-ttu-id="80ae9-349">Tente de faire correspondre les attentes de sens commun du comportement de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-349">Attempts to match the common-sense expectations of routing behavior.</span></span>

<span data-ttu-id="80ae9-350">Par exemple, considérez les modèles `/Products/List` et `/Products/{id}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-350">For example, consider templates `/Products/List` and `/Products/{id}`.</span></span> <span data-ttu-id="80ae9-351">Il serait raisonnable de supposer que `/Products/List` est une meilleure correspondance que `/Products/{id}` pour le chemin d’URL `/Products/List`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-351">It would be reasonable to assume that `/Products/List` is a better match than `/Products/{id}` for the URL path `/Products/List`.</span></span> <span data-ttu-id="80ae9-352">Le fonctionne parce que le segment littéral `/List` est considéré comme ayant une priorité supérieure à celle du segment de paramètres `/{id}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-352">The works because the literal segment `/List` is considered to have better precedence than the parameter segment `/{id}`.</span></span>

<span data-ttu-id="80ae9-353">Les détails du fonctionnement de la précédence sont associés à la façon dont les modèles de routage sont définis :</span><span class="sxs-lookup"><span data-stu-id="80ae9-353">The details of how precedence works are coupled to how route templates are defined:</span></span>

* <span data-ttu-id="80ae9-354">Les modèles avec plus de segments sont considérés comme plus spécifiques.</span><span class="sxs-lookup"><span data-stu-id="80ae9-354">Templates with more segments are considered more specific.</span></span>
* <span data-ttu-id="80ae9-355">Un segment avec du texte littéral est considéré comme plus spécifique qu’un segment de paramètres.</span><span class="sxs-lookup"><span data-stu-id="80ae9-355">A segment with literal text is considered more specific than a parameter segment.</span></span>
* <span data-ttu-id="80ae9-356">Un segment de paramètre avec une contrainte est considéré comme plus spécifique qu’un segment sans.</span><span class="sxs-lookup"><span data-stu-id="80ae9-356">A parameter segment with a constraint is considered more specific than one without.</span></span>
* <span data-ttu-id="80ae9-357">Un segment complexe est considéré comme un segment de paramètre spécifique avec une contrainte.</span><span class="sxs-lookup"><span data-stu-id="80ae9-357">A complex segment is considered as specific as a parameter segment with a constraint.</span></span>
* <span data-ttu-id="80ae9-358">Intercepter tous les paramètres sont les moins spécifiques.</span><span class="sxs-lookup"><span data-stu-id="80ae9-358">Catch all parameters are the least specific.</span></span>

<span data-ttu-id="80ae9-359">Consultez le [code source sur GitHub](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L189) pour obtenir une référence des valeurs exactes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-359">See the [source code on GitHub](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L189) for a reference of exact values.</span></span>

<a name="lg"></a>

### <a name="url-generation-concepts"></a><span data-ttu-id="80ae9-360">Concepts de génération d’URL</span><span class="sxs-lookup"><span data-stu-id="80ae9-360">URL generation concepts</span></span>

<span data-ttu-id="80ae9-361">Génération d’URL :</span><span class="sxs-lookup"><span data-stu-id="80ae9-361">URL generation:</span></span>

* <span data-ttu-id="80ae9-362">Est le processus par lequel le routage peut créer un chemin d’URL basé sur un ensemble de valeurs d’itinéraire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-362">Is the process by which routing can create a URL path based on a set of route values.</span></span>
* <span data-ttu-id="80ae9-363">Permet une séparation logique entre les points de terminaison et les URL qui y accèdent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-363">Allows for a logical separation between endpoints and the URLs that access them.</span></span>

<span data-ttu-id="80ae9-364">Le routage des points de terminaison comprend l’API <xref:Microsoft.AspNetCore.Routing.LinkGenerator>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-364">Endpoint routing includes the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API.</span></span> <span data-ttu-id="80ae9-365">`LinkGenerator` est un service Singleton disponible à partir de [di](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="80ae9-365">`LinkGenerator` is a singleton service available from [DI](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="80ae9-366">L’API `LinkGenerator` peut être utilisée en dehors du contexte d’une demande en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="80ae9-366">The `LinkGenerator` API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="80ae9-367">[Mvc. IUrlHelper](xref:Microsoft.AspNetCore.Mvc.IUrlHelper) et les scénarios qui reposent sur <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, tels que les [balises d’assistance](xref:mvc/views/tag-helpers/intro), les applications auxiliaires html et les [résultats d’Action](xref:mvc/controllers/actions), utilisent l’API `LinkGenerator` en interne pour fournir des fonctionnalités de génération de liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-367">[Mvc.IUrlHelper](xref:Microsoft.AspNetCore.Mvc.IUrlHelper) and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the `LinkGenerator` API internally to provide link generating capabilities.</span></span>

<span data-ttu-id="80ae9-368">Le générateur de liens est basé sur le concept d’une **adresse** et de **schémas d’adresse**.</span><span class="sxs-lookup"><span data-stu-id="80ae9-368">The link generator is backed by the concept of an **address** and **address schemes**.</span></span> <span data-ttu-id="80ae9-369">Un schéma d’adresse est un moyen de déterminer les points de terminaison à prendre en compte pour la génération de liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-369">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="80ae9-370">Par exemple, les scénarios nom de l’itinéraire et valeurs de routage de nombreux utilisateurs sont familiarisés avec les contrôleurs et les Razor Pages sont implémentés en tant que schéma d’adresse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-370">For example, the route name and route values scenarios many users are familiar with from controllers and Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="80ae9-371">Le générateur de liens peut établir une liaison avec les contrôleurs et les Razor Pages via les méthodes d’extension suivantes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-371">The link generator can link to controllers and Razor Pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="80ae9-372">Les surcharges de ces méthodes acceptent les arguments qui incluent l' `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-372">Overloads of these methods accept arguments that include the `HttpContext`.</span></span> <span data-ttu-id="80ae9-373">Ces méthodes sont fonctionnellement équivalentes à [URL. action](xref:System.Web.Mvc.UrlHelper.Action*) et [URL. page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*), mais offrent une flexibilité et des options supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="80ae9-373">These methods are functionally equivalent to [Url.Action](xref:System.Web.Mvc.UrlHelper.Action*) and [Url.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*), but offer additional flexibility and options.</span></span>

<span data-ttu-id="80ae9-374">Les méthodes `GetPath*` sont plus similaires à `Url.Action` et `Url.Page`, car elles génèrent un URI contenant un chemin d’accès absolu.</span><span class="sxs-lookup"><span data-stu-id="80ae9-374">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page`, in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="80ae9-375">Les méthodes `GetUri*` génèrent toujours un URI absolu contenant un schéma et un hôte.</span><span class="sxs-lookup"><span data-stu-id="80ae9-375">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="80ae9-376">Les méthodes qui acceptent un `HttpContext` génèrent un URI dans le contexte de la requête en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="80ae9-376">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="80ae9-377">Les valeurs de route [ambiante](#ambient) , le chemin d’accès de base de l’URL, le schéma et l’hôte de la demande en cours d’exécution sont utilisés, sauf s’ils sont substitués.</span><span class="sxs-lookup"><span data-stu-id="80ae9-377">The [ambient](#ambient) route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="80ae9-378"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> est appelé avec une adresse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-378"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="80ae9-379">La génération d’un URI se fait en deux étapes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-379">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="80ae9-380">Une adresse est liée à une liste de points de terminaison qui correspondent à l’adresse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-380">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="80ae9-381">Le <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern> de chaque point de terminaison est évalué jusqu’à ce qu’un modèle de route correspondant aux valeurs fournies soit trouvé.</span><span class="sxs-lookup"><span data-stu-id="80ae9-381">Each endpoint's <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern> is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="80ae9-382">Le résultat obtenu est combiné avec d’autres parties de l’URI fournies par le générateur de liens, puis il est retourné.</span><span class="sxs-lookup"><span data-stu-id="80ae9-382">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="80ae9-383">Les méthodes fournies par <xref:Microsoft.AspNetCore.Routing.LinkGenerator> prennent en charge des fonctionnalités de génération de liens standard pour n’importe quel type d’adresse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-383">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="80ae9-384">La méthode la plus pratique pour utiliser le générateur de liens est d’utiliser des méthodes d’extension qui effectuent des opérations pour un type d’adresse spécifique :</span><span class="sxs-lookup"><span data-stu-id="80ae9-384">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type:</span></span>

| <span data-ttu-id="80ae9-385">Méthode d'extension</span><span class="sxs-lookup"><span data-stu-id="80ae9-385">Extension Method</span></span> | <span data-ttu-id="80ae9-386">Description</span><span class="sxs-lookup"><span data-stu-id="80ae9-386">Description</span></span> |
| ---------------- | ----------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="80ae9-387">Génère un URI avec un chemin absolu basé sur les valeurs fournies.</span><span class="sxs-lookup"><span data-stu-id="80ae9-387">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="80ae9-388">Génère un URI absolu basé sur les valeurs fournies.</span><span class="sxs-lookup"><span data-stu-id="80ae9-388">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="80ae9-389">Faites attention aux implications suivantes de l’appel de méthodes <xref:Microsoft.AspNetCore.Routing.LinkGenerator> :</span><span class="sxs-lookup"><span data-stu-id="80ae9-389">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="80ae9-390">Utilisez les méthodes d’extension `GetUri*` avec précaution dans une configuration d’application qui ne valide pas l’en-tête `Host` des requêtes entrantes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-390">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="80ae9-391">Si l’en-tête `Host` des demandes entrantes n’est pas validé, une entrée de demande non approuvée peut être renvoyée au client dans les URI d’une vue ou d’une page.</span><span class="sxs-lookup"><span data-stu-id="80ae9-391">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view or page.</span></span> <span data-ttu-id="80ae9-392">Nous recommandons que toutes les applications de production configurent leur serveur pour qu’il valide l’en-tête `Host` par rapport à des valeurs valides connues.</span><span class="sxs-lookup"><span data-stu-id="80ae9-392">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="80ae9-393">Utilisez <xref:Microsoft.AspNetCore.Routing.LinkGenerator> avec précaution dans le middleware en combinaison avec `Map` ou `MapWhen`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-393">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="80ae9-394">`Map*` modifie le chemin de base de la requête en cours d’exécution, ce qui affecte la sortie de la génération de liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-394">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="80ae9-395">Toutes les API <xref:Microsoft.AspNetCore.Routing.LinkGenerator> permettent la spécification d’un chemin de base.</span><span class="sxs-lookup"><span data-stu-id="80ae9-395">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="80ae9-396">Spécifiez un chemin d’accès de base vide pour annuler la `Map*` effet sur la génération de liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-396">Specify an empty base path to undo the `Map*` affect on link generation.</span></span>

### <a name="middleware-example"></a><span data-ttu-id="80ae9-397">Exemple de middleware</span><span class="sxs-lookup"><span data-stu-id="80ae9-397">Middleware example</span></span>

<span data-ttu-id="80ae9-398">Dans l’exemple suivant, un intergiciel (middleware) utilise l’API <xref:Microsoft.AspNetCore.Routing.LinkGenerator> pour créer un lien vers une méthode d’action qui répertorie les produits du magasin.</span><span class="sxs-lookup"><span data-stu-id="80ae9-398">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create a link to an action method that lists store products.</span></span> <span data-ttu-id="80ae9-399">L’utilisation du générateur de liens en l’injectant dans une classe et en appelant `GenerateLink` est disponible pour n’importe quelle classe dans une application :</span><span class="sxs-lookup"><span data-stu-id="80ae9-399">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Middleware/ProductsLinkMiddleware.cs?name=snippet)]

<a name="rtr"></a>

## <a name="route-template-reference"></a><span data-ttu-id="80ae9-400">Informations de référence sur les modèles de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-400">Route template reference</span></span>

<span data-ttu-id="80ae9-401">Les jetons dans `{}` définissent les paramètres de routage qui sont liés si l’itinéraire est mis en correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-401">Tokens within `{}` define route parameters that are bound if the route is matched.</span></span> <span data-ttu-id="80ae9-402">Plusieurs paramètres de routage peuvent être définis dans un segment de routage, mais les paramètres de routage doivent être séparés par une valeur littérale.</span><span class="sxs-lookup"><span data-stu-id="80ae9-402">More than one route parameter can be defined in a route segment, but route parameters  must be separated by a literal value.</span></span> <span data-ttu-id="80ae9-403">Par exemple `{controller=Home}{action=Index}` n’est pas une route valide, car il n’y a aucune valeur littérale entre `{controller}` et `{action}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-403">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span>  <span data-ttu-id="80ae9-404">Les paramètres d’itinéraire doivent avoir un nom et des attributs supplémentaires peuvent être spécifiés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-404">Route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="80ae9-405">Un texte littéral autre que les paramètres de routage (par exemple, `{id}`) et le séparateur de chemin `/` doit correspondre au texte présent dans l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-405">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="80ae9-406">La correspondance de texte ne respecte pas la casse et est basée sur la représentation décodée du chemin des URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-406">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="80ae9-407">Pour correspondre à un délimiteur de paramètre d’itinéraire littéral `{` ou `}`, échappez le délimiteur en répétant le caractère.</span><span class="sxs-lookup"><span data-stu-id="80ae9-407">To match a literal route parameter delimiter `{` or `}`, escape the delimiter by repeating the character.</span></span> <span data-ttu-id="80ae9-408">Par exemple `{{` ou `}}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-408">For example `{{` or `}}`.</span></span>

<span data-ttu-id="80ae9-409">Astérisque `*` ou double `**`d’astérisque :</span><span class="sxs-lookup"><span data-stu-id="80ae9-409">Asterisk `*` or double asterisk `**`:</span></span>

* <span data-ttu-id="80ae9-410">Peut être utilisé comme préfixe d’un paramètre d’itinéraire pour effectuer une liaison au reste de l’URI.</span><span class="sxs-lookup"><span data-stu-id="80ae9-410">Can be used as a prefix to a route parameter to bind to the rest of the URI.</span></span>
* <span data-ttu-id="80ae9-411">Sont appelés paramètres **catch-all** .</span><span class="sxs-lookup"><span data-stu-id="80ae9-411">Are called a **catch-all** parameters.</span></span> <span data-ttu-id="80ae9-412">Par exemple, `blog/{**slug}`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-412">For example, `blog/{**slug}`:</span></span>
  * <span data-ttu-id="80ae9-413">Correspond à n’importe quel URI commençant par `/blog` et ayant une valeur qui le suit.</span><span class="sxs-lookup"><span data-stu-id="80ae9-413">Matches any URI that starts with `/blog` and has any value following it.</span></span>
  * <span data-ttu-id="80ae9-414">La valeur qui suit `/blog` est assignée à la valeur de route [Slug](https://developer.mozilla.org/docs/Glossary/Slug) .</span><span class="sxs-lookup"><span data-stu-id="80ae9-414">The value following `/blog` is assigned to the [slug](https://developer.mozilla.org/docs/Glossary/Slug) route value.</span></span>

<span data-ttu-id="80ae9-415">Les paramètres fourre-tout peuvent également établir une correspondance avec la chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="80ae9-415">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="80ae9-416">Le paramètre Catch-All échappe les caractères appropriés lorsque l’itinéraire est utilisé pour générer une URL, y compris le séparateur de chemin d’accès `/` caractères.</span><span class="sxs-lookup"><span data-stu-id="80ae9-416">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator `/` characters.</span></span> <span data-ttu-id="80ae9-417">Par exemple, la route `foo/{*path}` avec les valeurs de route `{ path = "my/path" }` génère `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-417">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="80ae9-418">Notez la barre oblique d’échappement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-418">Note the escaped forward slash.</span></span> <span data-ttu-id="80ae9-419">Pour les séparateurs de chemin aller-retour, utilisez le préfixe de paramètre de routage `**`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-419">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="80ae9-420">La route `foo/{**path}` avec `{ path = "my/path" }` génère `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-420">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="80ae9-421">Les modèles d’URL qui tentent de capturer un nom de fichier avec une extension de fichier facultative doivent faire l’objet de considérations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="80ae9-421">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="80ae9-422">Prenez par exemple le modèle `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-422">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="80ae9-423">Quand des valeurs existent à la fois pour `filename` et pour `ext`, les deux valeurs sont renseignées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-423">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="80ae9-424">Si seule une valeur pour `filename` existe dans l’URL, l’itinéraire correspond car le `.` de fin est facultatif.</span><span class="sxs-lookup"><span data-stu-id="80ae9-424">If only a value for `filename` exists in the URL, the route matches because the trailing `.` is  optional.</span></span> <span data-ttu-id="80ae9-425">Les URL suivantes correspondent à cette route :</span><span class="sxs-lookup"><span data-stu-id="80ae9-425">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="80ae9-426">Les paramètres de route peuvent avoir des **valeurs par défaut**, désignées en spécifiant la valeur par défaut après le nom du paramètre, séparée par un signe égal (`=`).</span><span class="sxs-lookup"><span data-stu-id="80ae9-426">Route parameters may have **default values** designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="80ae9-427">Par exemple, `{controller=Home}` définit `Home` comme valeur par défaut de `controller`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-427">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="80ae9-428">La valeur par défaut est utilisée si aucune valeur n’est présente dans l’URL pour le paramètre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-428">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="80ae9-429">Les paramètres de routage sont rendus facultatifs en ajoutant un point d’interrogation (`?`) à la fin du nom du paramètre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-429">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name.</span></span> <span data-ttu-id="80ae9-430">Par exemple : `id?`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-430">For example, `id?`.</span></span> <span data-ttu-id="80ae9-431">La différence entre les valeurs facultatives et les paramètres d’itinéraire par défaut est la suivante :</span><span class="sxs-lookup"><span data-stu-id="80ae9-431">The difference between optional values and default route parameters is:</span></span>

* <span data-ttu-id="80ae9-432">Un paramètre d’itinéraire avec une valeur par défaut produit toujours une valeur.</span><span class="sxs-lookup"><span data-stu-id="80ae9-432">A route parameter with a default value always produces a value.</span></span>
* <span data-ttu-id="80ae9-433">Un paramètre facultatif a une valeur uniquement lorsqu’une valeur est fournie par l’URL de la requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-433">An optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="80ae9-434">Les paramètres de route peuvent avoir des contraintes, qui doivent correspondre à la valeur de route liée à partir de l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-434">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="80ae9-435">L’ajout d' `:` et d’un nom de contrainte après le nom du paramètre d’itinéraire spécifie une contrainte Inline sur un paramètre d’itinéraire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-435">Adding `:` and constraint name after the route parameter name specifies an inline constraint on a route parameter.</span></span> <span data-ttu-id="80ae9-436">Si la contrainte exige des arguments, ils sont fournis entre parenthèses `(...)` après le nom de la contrainte.</span><span class="sxs-lookup"><span data-stu-id="80ae9-436">If the constraint requires arguments, they're enclosed in parentheses `(...)` after the constraint name.</span></span> <span data-ttu-id="80ae9-437">Vous pouvez spécifier plusieurs *contraintes* incluses en ajoutant un `:` et un nom de contrainte.</span><span class="sxs-lookup"><span data-stu-id="80ae9-437">Multiple *inline constraints* can be specified by appending another `:` and constraint name.</span></span>

<span data-ttu-id="80ae9-438">Le nom de la contrainte et les arguments sont passés au service <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> pour créer une instance de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> à utiliser dans le traitement des URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-438">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="80ae9-439">Par exemple, le modèle de routage `blog/{article:minlength(10)}` spécifie une contrainte `minlength` avec l’argument `10`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-439">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="80ae9-440">Pour plus d’informations sur les contraintes de route et pour obtenir la liste des contraintes fournies par le framework, consultez la section [Informations de référence sur les contraintes de route](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-440">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="80ae9-441">Les paramètres de routage peuvent également avoir des transformateurs de paramètre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-441">Route parameters may also have parameter transformers.</span></span> <span data-ttu-id="80ae9-442">Les transformateurs de paramètres transforment la valeur d’un paramètre lors de la génération de liens et d’actions et de pages correspondantes en URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-442">Parameter transformers transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="80ae9-443">Comme pour les contraintes, les transformateurs de paramètres peuvent être ajoutés Inline à un paramètre d’itinéraire en ajoutant un `:` et un nom de transformateur après le nom du paramètre d’itinéraire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-443">Like constraints, parameter transformers can be added inline to a route parameter by adding a `:` and transformer name after the route parameter name.</span></span> <span data-ttu-id="80ae9-444">Par exemple, le modèle de routage `blog/{article:slugify}` spécifie un transformateur `slugify`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-444">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="80ae9-445">Pour plus d’informations sur les transformateurs de paramètre, consultez la section [Informations de référence sur les transformateurs de paramètre](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-445">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="80ae9-446">Le tableau suivant montre des exemples de modèles de routage et leur comportement :</span><span class="sxs-lookup"><span data-stu-id="80ae9-446">The following table demonstrates example route templates and their behavior:</span></span>

| <span data-ttu-id="80ae9-447">Modèle de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-447">Route Template</span></span>                           | <span data-ttu-id="80ae9-448">Exemple d’URI en correspondance</span><span class="sxs-lookup"><span data-stu-id="80ae9-448">Example Matching URI</span></span>    | <span data-ttu-id="80ae9-449">URI de la requête&hellip;</span><span class="sxs-lookup"><span data-stu-id="80ae9-449">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="80ae9-450">Correspond seulement au chemin unique `/hello`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-450">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="80ae9-451">Correspond à `Page` et le définit sur `Home`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-451">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="80ae9-452">Correspond à `Page` et le définit sur `Contact`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-452">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="80ae9-453">Mappe au contrôleur `Products` et à l’action `List`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-453">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="80ae9-454">Mappe au contrôleur `Products` et `Details` action avec`id` défini sur 123.</span><span class="sxs-lookup"><span data-stu-id="80ae9-454">Maps to the `Products` controller and  `Details` action with`id` set to 123.</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="80ae9-455">Correspond au contrôleur `Home` et à la méthode `Index`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-455">Maps to the `Home` controller and `Index` method.</span></span> <span data-ttu-id="80ae9-456">`id` est ignoré.</span><span class="sxs-lookup"><span data-stu-id="80ae9-456">`id` is ignored.</span></span>        |
| `{controller=Home}/{action=Index}/{id?}` | `/Products`         | <span data-ttu-id="80ae9-457">Correspond au contrôleur `Products` et à la méthode `Index`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-457">Maps to the `Products` controller and `Index` method.</span></span> <span data-ttu-id="80ae9-458">`id` est ignoré.</span><span class="sxs-lookup"><span data-stu-id="80ae9-458">`id` is ignored.</span></span>        |

<span data-ttu-id="80ae9-459">L’utilisation d’un modèle est généralement l’approche la plus simple pour le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-459">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="80ae9-460">Il est également possible de spécifier des contraintes et des valeurs par défaut hors du modèle de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-460">Constraints and defaults can also be specified outside the route template.</span></span>

### <a name="complex-segments"></a><span data-ttu-id="80ae9-461">Segments complexes</span><span class="sxs-lookup"><span data-stu-id="80ae9-461">Complex segments</span></span>

<span data-ttu-id="80ae9-462">Les segments complexes sont traités en faisant correspondre les délimiteurs littéraux de droite à gauche d’une façon [non gourmande](#greedy) .</span><span class="sxs-lookup"><span data-stu-id="80ae9-462">Complex segments are processed by matching up literal delimiters from right to left in a [non-greedy](#greedy) way.</span></span> <span data-ttu-id="80ae9-463">Par exemple, `[Route("/a{b}c{d}")]` est un segment complexe.</span><span class="sxs-lookup"><span data-stu-id="80ae9-463">For example, `[Route("/a{b}c{d}")]` is a complex segment.</span></span>
<span data-ttu-id="80ae9-464">Les segments complexes fonctionnent d’une manière particulière qui doit être comprise pour pouvoir les utiliser avec succès.</span><span class="sxs-lookup"><span data-stu-id="80ae9-464">Complex segments work in a particular way that must be understood to use them successfully.</span></span> <span data-ttu-id="80ae9-465">L’exemple de cette section montre pourquoi les segments complexes ne fonctionnent vraiment que si le texte du délimiteur ne s’affiche pas dans les valeurs de paramètre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-465">The example in this section demonstrates why complex segments only really work well when the delimiter text doesn't appear inside the parameter values.</span></span> <span data-ttu-id="80ae9-466">L’utilisation d’une [expression régulière](/dotnet/standard/base-types/regular-expressions) , puis l’extraction manuelle des valeurs est nécessaire pour les cas plus complexes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-466">Using a [regex](/dotnet/standard/base-types/regular-expressions) and then manually extracting the values is needed for more complex cases.</span></span>

<span data-ttu-id="80ae9-467">Il s’agit d’un résumé des étapes que le routage effectue avec le `/a{b}c{d}` de modèle et le chemin d’URL `/abcd`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-467">This is a summary of the steps that routing performs with the template `/a{b}c{d}` and the URL path `/abcd`.</span></span> <span data-ttu-id="80ae9-468">Le `|` est utilisé pour vous aider à visualiser le fonctionnement de l’algorithme :</span><span class="sxs-lookup"><span data-stu-id="80ae9-468">The `|` is used to help visualize how the algorithm works:</span></span>

* <span data-ttu-id="80ae9-469">Le premier littéral, de droite à gauche, est `c`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-469">The first literal, right to left, is `c`.</span></span> <span data-ttu-id="80ae9-470">`/abcd` est donc recherchée à partir de la droite et trouve `/ab|c|d`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-470">So `/abcd` is searched from right and finds `/ab|c|d`.</span></span>
* <span data-ttu-id="80ae9-471">Tout ce qui se trouve à droite (`d`) est maintenant mis en correspondance avec le paramètre d’itinéraire `{d}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-471">Everything to the right (`d`) is now matched to the route parameter `{d}`.</span></span>
* <span data-ttu-id="80ae9-472">Le littéral suivant, de droite à gauche, est `a`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-472">The next literal, right to left, is `a`.</span></span> <span data-ttu-id="80ae9-473">Par conséquent, `/ab|c|d` est recherché à partir de l’endroit où nous avons quitté, `a` est trouvé `/|a|b|c|d`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-473">So `/ab|c|d` is searched starting where we left off, then `a` is found `/|a|b|c|d`.</span></span>
* <span data-ttu-id="80ae9-474">La valeur à droite (`b`) est désormais mise en correspondance avec le paramètre d’itinéraire `{b}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-474">The value to the right (`b`) is now matched to the route parameter `{b}`.</span></span>
* <span data-ttu-id="80ae9-475">Il n’y a pas de texte restant et aucun modèle de route restant, donc il s’agit d’une correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-475">There is no remaining text and no remaining route template, so this is a match.</span></span>

<span data-ttu-id="80ae9-476">Voici un exemple de cas négatif utilisant le même `/a{b}c{d}` de modèle et le chemin d’URL `/aabcd`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-476">Here's an example of a negative case using the same template `/a{b}c{d}` and the URL path `/aabcd`.</span></span> <span data-ttu-id="80ae9-477">Le `|` est utilisé pour vous aider à visualiser le fonctionnement de l’algorithme.</span><span class="sxs-lookup"><span data-stu-id="80ae9-477">The `|` is used to help visualize how the algorithm works.</span></span> <span data-ttu-id="80ae9-478">Ce cas n’est pas une correspondance, qui est expliquée par le même algorithme :</span><span class="sxs-lookup"><span data-stu-id="80ae9-478">This case isn't a match, which is explained by the same algorithm:</span></span>
* <span data-ttu-id="80ae9-479">Le premier littéral, de droite à gauche, est `c`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-479">The first literal, right to left, is `c`.</span></span> <span data-ttu-id="80ae9-480">`/aabcd` est donc recherchée à partir de la droite et trouve `/aab|c|d`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-480">So `/aabcd` is searched from right and finds `/aab|c|d`.</span></span>
* <span data-ttu-id="80ae9-481">Tout ce qui se trouve à droite (`d`) est maintenant mis en correspondance avec le paramètre d’itinéraire `{d}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-481">Everything to the right (`d`) is now matched to the route parameter `{d}`.</span></span>
* <span data-ttu-id="80ae9-482">Le littéral suivant, de droite à gauche, est `a`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-482">The next literal, right to left, is `a`.</span></span> <span data-ttu-id="80ae9-483">Par conséquent, `/aab|c|d` est recherché à partir de l’endroit où nous avons quitté, `a` est trouvé `/a|a|b|c|d`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-483">So `/aab|c|d` is searched starting where we left off, then `a` is found `/a|a|b|c|d`.</span></span>
* <span data-ttu-id="80ae9-484">La valeur à droite (`b`) est désormais mise en correspondance avec le paramètre d’itinéraire `{b}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-484">The value to the right (`b`) is now matched to the route parameter `{b}`.</span></span>
* <span data-ttu-id="80ae9-485">À ce stade, il reste de la `a`de texte, mais l’algorithme ne dispose pas d’un modèle de routage à analyser, ce qui n’est pas une correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-485">At this point there is remaining text `a`, but the algorithm has run out of route template to parse, so this is not a match.</span></span>

<span data-ttu-id="80ae9-486">Étant donné que l’algorithme de correspondance n’est [pas gourmand](#greedy):</span><span class="sxs-lookup"><span data-stu-id="80ae9-486">Since the matching algorithm is [non-greedy](#greedy):</span></span>

* <span data-ttu-id="80ae9-487">Il correspond à la plus petite quantité de texte possible dans chaque étape.</span><span class="sxs-lookup"><span data-stu-id="80ae9-487">It matches the smallest amount of text possible in each step.</span></span>
* <span data-ttu-id="80ae9-488">Tout cas où la valeur de délimiteur apparaît à l’intérieur des valeurs de paramètre ne correspond pas.</span><span class="sxs-lookup"><span data-stu-id="80ae9-488">Any case where the delimiter value appears inside the parameter values results in not matching.</span></span>

<span data-ttu-id="80ae9-489">Les expressions régulières permettent de mieux contrôler le comportement de leur correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-489">Regular expressions provide much more control over their matching behavior.</span></span>

<a name="greedy"></a>

<span data-ttu-id="80ae9-490">La correspondance gourmande, également connue comme [correspondance tardive](https://wikipedia.org/wiki/Regular_expression#Lazy_matching), correspond à la plus grande chaîne possible.</span><span class="sxs-lookup"><span data-stu-id="80ae9-490">Greedy matching, also know as [lazy matching](https://wikipedia.org/wiki/Regular_expression#Lazy_matching), matches the largest possible string.</span></span> <span data-ttu-id="80ae9-491">Non gourmand correspond à la plus petite chaîne possible.</span><span class="sxs-lookup"><span data-stu-id="80ae9-491">Non-greedy matches the smallest possible string.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="80ae9-492">Informations de référence sur les contraintes de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-492">Route constraint reference</span></span>

<span data-ttu-id="80ae9-493">Les contraintes de route s’exécutent quand une correspondance s’est produite pour l’URL entrante, et le chemin de l’URL est tokenisé en valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-493">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="80ae9-494">En général, les contraintes de routage inspectent la valeur de routage associée via le modèle de routage et font une décision true ou false indiquant si la valeur est acceptable ou non.</span><span class="sxs-lookup"><span data-stu-id="80ae9-494">Route constraints generally inspect the route value associated via the route template and make a true or false decision about whether the value is acceptable.</span></span> <span data-ttu-id="80ae9-495">Certaines contraintes de routage utilisent des données hors de la valeur de route pour déterminer si la requête peut être routée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-495">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="80ae9-496">Par exemple, <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> peut accepter ou rejeter une requête en fonction de son verbe HTTP.</span><span class="sxs-lookup"><span data-stu-id="80ae9-496">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="80ae9-497">Les contraintes sont utilisées dans le routage des requêtes et la génération des liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-497">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="80ae9-498">N’utilisez pas de contraintes pour la validation d’entrée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-498">Don't use constraints for input validation.</span></span> <span data-ttu-id="80ae9-499">Si des contraintes sont utilisées pour la validation d’entrée, une entrée non valide entraîne une réponse `404` introuvable.</span><span class="sxs-lookup"><span data-stu-id="80ae9-499">If constraints are used for input validation, invalid input results in a `404` Not Found response.</span></span> <span data-ttu-id="80ae9-500">Une entrée non valide doit générer un `400` demande incorrecte avec un message d’erreur approprié.</span><span class="sxs-lookup"><span data-stu-id="80ae9-500">Invalid input should produce a `400` Bad Request with an appropriate error message.</span></span> <span data-ttu-id="80ae9-501">Les contraintes de routage sont utilisées pour lever l’ambiguïté entre des itinéraires similaires, et non pour valider les entrées pour un itinéraire particulier.</span><span class="sxs-lookup"><span data-stu-id="80ae9-501">Route constraints are used to disambiguate similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="80ae9-502">Le tableau suivant montre des exemples de contraintes de routage et leur comportement attendu :</span><span class="sxs-lookup"><span data-stu-id="80ae9-502">The following table demonstrates example route constraints and their expected behavior:</span></span>

| <span data-ttu-id="80ae9-503">contrainte</span><span class="sxs-lookup"><span data-stu-id="80ae9-503">constraint</span></span> | <span data-ttu-id="80ae9-504">Exemple</span><span class="sxs-lookup"><span data-stu-id="80ae9-504">Example</span></span> | <span data-ttu-id="80ae9-505">Exemples de correspondances</span><span class="sxs-lookup"><span data-stu-id="80ae9-505">Example Matches</span></span> | <span data-ttu-id="80ae9-506">Notes</span><span class="sxs-lookup"><span data-stu-id="80ae9-506">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="80ae9-507">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="80ae9-507">`123456789`, `-123456789`</span></span> | <span data-ttu-id="80ae9-508">Correspond à n’importe quel entier</span><span class="sxs-lookup"><span data-stu-id="80ae9-508">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="80ae9-509">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="80ae9-509">`true`, `FALSE`</span></span> | <span data-ttu-id="80ae9-510">Correspond à `true` ou `false`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-510">Matches `true` or `false`.</span></span> <span data-ttu-id="80ae9-511">Non-respect de la casse</span><span class="sxs-lookup"><span data-stu-id="80ae9-511">Case-insensitive</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="80ae9-512">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="80ae9-512">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="80ae9-513">Correspond à une valeur de `DateTime` valide dans la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-513">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="80ae9-514">Consultez l’avertissement précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-514">See preceding warning.</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="80ae9-515">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="80ae9-515">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="80ae9-516">Correspond à une valeur de `decimal` valide dans la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-516">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="80ae9-517">Consultez l’avertissement précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-517">See preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="80ae9-518">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="80ae9-518">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="80ae9-519">Correspond à une valeur de `double` valide dans la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-519">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="80ae9-520">Consultez l’avertissement précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-520">See preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="80ae9-521">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="80ae9-521">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="80ae9-522">Correspond à une valeur de `float` valide dans la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-522">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="80ae9-523">Consultez l’avertissement précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-523">See preceding warning.</span></span>|
| `guid` | `{id:guid}` | `CD2C1638-1638-72D5-1638-DEADBEEF1638` | <span data-ttu-id="80ae9-524">Correspond à une valeur `Guid` valide</span><span class="sxs-lookup"><span data-stu-id="80ae9-524">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="80ae9-525">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="80ae9-525">`123456789`, `-123456789`</span></span> | <span data-ttu-id="80ae9-526">Correspond à une valeur `long` valide</span><span class="sxs-lookup"><span data-stu-id="80ae9-526">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="80ae9-527">La chaîne doit comporter au moins 4 caractères</span><span class="sxs-lookup"><span data-stu-id="80ae9-527">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `MyFile` | <span data-ttu-id="80ae9-528">La chaîne ne doit pas comporter plus de 8 caractères</span><span class="sxs-lookup"><span data-stu-id="80ae9-528">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="80ae9-529">La chaîne doit comporter exactement 12 caractères</span><span class="sxs-lookup"><span data-stu-id="80ae9-529">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="80ae9-530">La chaîne doit comporter au moins 8 caractères et pas plus de 16 caractères</span><span class="sxs-lookup"><span data-stu-id="80ae9-530">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="80ae9-531">La valeur entière doit être au moins égale à 18</span><span class="sxs-lookup"><span data-stu-id="80ae9-531">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="80ae9-532">La valeur entière ne doit pas être supérieure à 120</span><span class="sxs-lookup"><span data-stu-id="80ae9-532">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="80ae9-533">La valeur entière doit être au moins égale à 18 mais ne doit pas être supérieure à 120</span><span class="sxs-lookup"><span data-stu-id="80ae9-533">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="80ae9-534">La chaîne doit comporter un ou plusieurs caractères alphabétiques, `a`-`z` et ne respecte pas la casse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-534">String must consist of one or more alphabetical characters, `a`-`z` and case-insensitive.</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="80ae9-535">La chaîne doit correspondre à l’expression régulière.</span><span class="sxs-lookup"><span data-stu-id="80ae9-535">String must match the regular expression.</span></span> <span data-ttu-id="80ae9-536">Consultez les conseils relatifs à la définition d’une expression régulière.</span><span class="sxs-lookup"><span data-stu-id="80ae9-536">See tips about defining a regular expression.</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="80ae9-537">Utilisé pour garantir qu’une valeur autre qu’un paramètre est présente pendant la génération de l’URL</span><span class="sxs-lookup"><span data-stu-id="80ae9-537">Used to enforce that a non-parameter value is present during URL generation</span></span> |

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="80ae9-538">Plusieurs contraintes séparées par des points-virgules peuvent être appliquées à un seul paramètre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-538">Multiple, colon delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="80ae9-539">Par exemple, la contrainte suivante limite un paramètre à une valeur entière supérieure ou égale à 1 :</span><span class="sxs-lookup"><span data-stu-id="80ae9-539">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="80ae9-540">Les contraintes de routage qui vérifient l’URL et sont converties en un type CLR utilisent toujours la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-540">Route constraints that verify the URL and are converted to a CLR type always use the invariant culture.</span></span> <span data-ttu-id="80ae9-541">Par exemple, la conversion vers le type CLR `int` ou `DateTime`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-541">For example, conversion to the CLR type `int` or `DateTime`.</span></span> <span data-ttu-id="80ae9-542">Ces contraintes supposent que l’URL n’est pas localisable.</span><span class="sxs-lookup"><span data-stu-id="80ae9-542">These constraints assume that the URL is not localizable.</span></span> <span data-ttu-id="80ae9-543">Les contraintes de routage fournies par le framework ne modifient pas les valeurs stockées dans les valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-543">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="80ae9-544">Toutes les valeurs de route analysées à partir de l’URL sont stockées sous forme de chaînes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-544">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="80ae9-545">Par exemple, la contrainte `float` tente de convertir la valeur de route en valeur float, mais la valeur convertie est utilisée uniquement pour vérifier qu’elle peut être convertie en valeur float.</span><span class="sxs-lookup"><span data-stu-id="80ae9-545">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

### <a name="regular-expressions-in-constraints"></a><span data-ttu-id="80ae9-546">Expressions régulières dans les contraintes</span><span class="sxs-lookup"><span data-stu-id="80ae9-546">Regular expressions in constraints</span></span>

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="80ae9-547">Les expressions régulières peuvent être spécifiées en tant que contraintes Inline à l’aide de la contrainte d’itinéraire `regex(...)`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-547">Regular expressions can be specified as inline constraints using the `regex(...)` route constraint.</span></span> <span data-ttu-id="80ae9-548">Les méthodes de la famille <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> acceptent également un littéral d’objet de contraintes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-548">Methods in the <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> family also accept an object literal of constraints.</span></span> <span data-ttu-id="80ae9-549">Si ce formulaire est utilisé, les valeurs de chaîne sont interprétées comme des expressions régulières.</span><span class="sxs-lookup"><span data-stu-id="80ae9-549">If that form is used, string values are interpreted as regular expressions.</span></span>

<span data-ttu-id="80ae9-550">Le code suivant utilise une contrainte Regex inline :</span><span class="sxs-lookup"><span data-stu-id="80ae9-550">The following code uses an inline regex constraint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRegex.cs?name=snippet)]

<span data-ttu-id="80ae9-551">Le code suivant utilise un littéral d’objet pour spécifier une contrainte Regex :</span><span class="sxs-lookup"><span data-stu-id="80ae9-551">The following code uses an object literal to specify a regex constraint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRegex2.cs?name=snippet)]

<span data-ttu-id="80ae9-552">Le framework ASP.NET Core ajoute `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` au constructeur d’expression régulière.</span><span class="sxs-lookup"><span data-stu-id="80ae9-552">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="80ae9-553">Pour obtenir une description de ces membres, consultez <xref:System.Text.RegularExpressions.RegexOptions>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-553">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="80ae9-554">Les expressions régulières utilisent des délimiteurs et des jetons similaires à ceux utilisés par C# le routage et le langage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-554">Regular expressions use delimiters and tokens similar to those used by routing and the C# language.</span></span> <span data-ttu-id="80ae9-555">Les jetons d’expression régulière doivent être placés dans une séquence d’échappement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-555">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="80ae9-556">Pour utiliser l’expression régulière `^\d{3}-\d{2}-\d{4}$` dans une contrainte incluse, utilisez l’une des méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-556">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in an inline constraint, use one of the following:</span></span>

* <span data-ttu-id="80ae9-557">Remplacez `\` caractères fournis dans la chaîne comme `\\` caractères dans le C# fichier source afin d’échapper le caractère d’échappement de la chaîne `\`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-557">Replace `\` characters provided in the string as `\\` characters in the C# source file in order to escape the `\` string escape character.</span></span>
* <span data-ttu-id="80ae9-558">[Littéraux de chaîne Verbatim](/dotnet/csharp/language-reference/keywords/string).</span><span class="sxs-lookup"><span data-stu-id="80ae9-558">[Verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span>

<span data-ttu-id="80ae9-559">Pour échapper les caractères de délimiteur de paramètre de routage `{`, `}`, `[``]`, doublez les caractères de l’expression, par exemple `{{`, `}}`, `[[`, `]]`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-559">To escape routing parameter delimiter characters `{`, `}`, `[`, `]`, double the characters in the expression, for example, `{{`, `}}`, `[[`, `]]`.</span></span> <span data-ttu-id="80ae9-560">Le tableau suivant montre une expression régulière et sa version échappée :</span><span class="sxs-lookup"><span data-stu-id="80ae9-560">The following table shows a regular expression and its escaped version:</span></span>

| <span data-ttu-id="80ae9-561">Expression régulière</span><span class="sxs-lookup"><span data-stu-id="80ae9-561">Regular expression</span></span>    | <span data-ttu-id="80ae9-562">Expression régulière placée dans une séquence d’échappement</span><span class="sxs-lookup"><span data-stu-id="80ae9-562">Escaped regular expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="80ae9-563">Les expressions régulières utilisées dans le routage commencent souvent par le caractère `^` et correspondent à la position de départ de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="80ae9-563">Regular expressions used in routing often start with the `^` character and match the starting position of the string.</span></span> <span data-ttu-id="80ae9-564">Les expressions se terminent souvent par le caractère `$` et correspondent à la fin de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="80ae9-564">The expressions often end with the `$` character and match the end of the string.</span></span> <span data-ttu-id="80ae9-565">Les caractères `^` et `$` garantissent que l’expression régulière correspond à l’intégralité de la valeur du paramètre d’itinéraire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-565">The `^` and `$` characters ensure that the regular expression matches the entire route parameter value.</span></span> <span data-ttu-id="80ae9-566">Sans les caractères `^` et `$`, l’expression régulière correspond à toute sous-chaîne de la chaîne, ce qui est souvent indésirable.</span><span class="sxs-lookup"><span data-stu-id="80ae9-566">Without the `^` and `$` characters, the regular expression matches any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="80ae9-567">Le tableau suivant fournit des exemples et explique pourquoi ils correspondent ou ne parviennent pas à faire correspondre :</span><span class="sxs-lookup"><span data-stu-id="80ae9-567">The following table provides examples and explains why they match or fail to match:</span></span>

| <span data-ttu-id="80ae9-568">Expression</span><span class="sxs-lookup"><span data-stu-id="80ae9-568">Expression</span></span>   | <span data-ttu-id="80ae9-569">String</span><span class="sxs-lookup"><span data-stu-id="80ae9-569">String</span></span>    | <span data-ttu-id="80ae9-570">Correspond</span><span class="sxs-lookup"><span data-stu-id="80ae9-570">Match</span></span> | <span data-ttu-id="80ae9-571">Commentaire</span><span class="sxs-lookup"><span data-stu-id="80ae9-571">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="80ae9-572">hello</span><span class="sxs-lookup"><span data-stu-id="80ae9-572">hello</span></span>     | <span data-ttu-id="80ae9-573">Oui</span><span class="sxs-lookup"><span data-stu-id="80ae9-573">Yes</span></span>   | <span data-ttu-id="80ae9-574">Correspondances de sous-chaînes</span><span class="sxs-lookup"><span data-stu-id="80ae9-574">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="80ae9-575">123abc456</span><span class="sxs-lookup"><span data-stu-id="80ae9-575">123abc456</span></span> | <span data-ttu-id="80ae9-576">Oui</span><span class="sxs-lookup"><span data-stu-id="80ae9-576">Yes</span></span>   | <span data-ttu-id="80ae9-577">Correspondances de sous-chaînes</span><span class="sxs-lookup"><span data-stu-id="80ae9-577">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="80ae9-578">mz</span><span class="sxs-lookup"><span data-stu-id="80ae9-578">mz</span></span>        | <span data-ttu-id="80ae9-579">Oui</span><span class="sxs-lookup"><span data-stu-id="80ae9-579">Yes</span></span>   | <span data-ttu-id="80ae9-580">Correspondance avec l’expression</span><span class="sxs-lookup"><span data-stu-id="80ae9-580">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="80ae9-581">MZ</span><span class="sxs-lookup"><span data-stu-id="80ae9-581">MZ</span></span>        | <span data-ttu-id="80ae9-582">Oui</span><span class="sxs-lookup"><span data-stu-id="80ae9-582">Yes</span></span>   | <span data-ttu-id="80ae9-583">Non-respect de la casse</span><span class="sxs-lookup"><span data-stu-id="80ae9-583">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="80ae9-584">hello</span><span class="sxs-lookup"><span data-stu-id="80ae9-584">hello</span></span>     | <span data-ttu-id="80ae9-585">Non</span><span class="sxs-lookup"><span data-stu-id="80ae9-585">No</span></span>    | <span data-ttu-id="80ae9-586">Voir `^` et `$` ci-dessus</span><span class="sxs-lookup"><span data-stu-id="80ae9-586">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="80ae9-587">123abc456</span><span class="sxs-lookup"><span data-stu-id="80ae9-587">123abc456</span></span> | <span data-ttu-id="80ae9-588">Non</span><span class="sxs-lookup"><span data-stu-id="80ae9-588">No</span></span>    | <span data-ttu-id="80ae9-589">Voir `^` et `$` ci-dessus</span><span class="sxs-lookup"><span data-stu-id="80ae9-589">See `^` and `$` above</span></span> |

<span data-ttu-id="80ae9-590">Pour plus d’informations sur la syntaxe des expressions régulières, consultez [Expressions régulières du .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-590">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="80ae9-591">Pour contraindre un paramètre à un ensemble connu de valeurs possibles, utilisez une expression régulière.</span><span class="sxs-lookup"><span data-stu-id="80ae9-591">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="80ae9-592">Par exemple, `{action:regex(^(list|get|create)$)}` établit une correspondance avec la valeur de route `action` uniquement pour `list`, `get` ou `create`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-592">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="80ae9-593">Si elle est passée dans le dictionnaire de contraintes, la chaîne `^(list|get|create)$` est équivalente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-593">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="80ae9-594">Les contraintes passées dans le dictionnaire de contraintes qui ne correspondent pas à l’une des contraintes connues sont également traitées comme des expressions régulières.</span><span class="sxs-lookup"><span data-stu-id="80ae9-594">Constraints that are passed in the constraints dictionary that don't match one of the known constraints are also treated as regular expressions.</span></span> <span data-ttu-id="80ae9-595">Les contraintes passées dans un modèle qui ne correspondent pas à l’une des contraintes connues ne sont pas traitées comme des expressions régulières.</span><span class="sxs-lookup"><span data-stu-id="80ae9-595">Constraints that are passed  within a template that don't match one of the known constraints are not treated as regular expressions.</span></span>

### <a name="custom-route-constraints"></a><span data-ttu-id="80ae9-596">Contraintes d’itinéraire personnalisées</span><span class="sxs-lookup"><span data-stu-id="80ae9-596">Custom route constraints</span></span>

<span data-ttu-id="80ae9-597">Vous pouvez créer des contraintes de routage personnalisées en implémentant l’interface <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-597">Custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="80ae9-598">L’interface `IRouteConstraint` contient <xref:System.Web.Routing.IRouteConstraint.Match*>, qui retourne `true` si la contrainte est satisfaite et `false` dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-598">The `IRouteConstraint` interface contains <xref:System.Web.Routing.IRouteConstraint.Match*>, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="80ae9-599">Les contraintes de routage personnalisées sont rarement nécessaires.</span><span class="sxs-lookup"><span data-stu-id="80ae9-599">Custom route constraints are rarely needed.</span></span> <span data-ttu-id="80ae9-600">Avant d’implémenter une contrainte d’itinéraire personnalisée, envisagez d’autres méthodes, telles que la liaison de modèle.</span><span class="sxs-lookup"><span data-stu-id="80ae9-600">Before implementing a custom route constraint, consider alternatives, such as model binding.</span></span>

<span data-ttu-id="80ae9-601">Pour utiliser une `IRouteConstraint`personnalisée, le type de contrainte d’itinéraire doit être inscrit avec le <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de l’application dans le conteneur de service.</span><span class="sxs-lookup"><span data-stu-id="80ae9-601">To use a custom `IRouteConstraint`, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the service container.</span></span> <span data-ttu-id="80ae9-602">Un `ConstraintMap` est un dictionnaire qui mappe les clés de contrainte d’itinéraire aux implémentations `IRouteConstraint` qui valident ces contraintes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-602">A `ConstraintMap` is a dictionary that maps route constraint keys to `IRouteConstraint` implementations that validate those constraints.</span></span> <span data-ttu-id="80ae9-603">Le `ConstraintMap` d’une application peut être mis à jour dans `Startup.ConfigureServices` dans le cadre d’un appel [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) ou en configurant <xref:Microsoft.AspNetCore.Routing.RouteOptions> directement avec `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-603">An app's `ConstraintMap` can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="80ae9-604">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="80ae9-604">For example:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint.cs?name=snippet)]

<span data-ttu-id="80ae9-605">La contrainte précédente est appliquée dans le code suivant :</span><span class="sxs-lookup"><span data-stu-id="80ae9-605">The preceding constraint is applied in the following code:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/TestController.cs?name=snippet&highlight=6,13)]

<span data-ttu-id="80ae9-606">La méthode [MyDisplayRouteInfo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x/RoutingSample/Extensions/ControllerContextExtensions.cs) est incluse dans l' [exemple de téléchargement](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) et est utilisée pour afficher des informations de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-606">The [MyDisplayRouteInfo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x/RoutingSample/Extensions/ControllerContextExtensions.cs) method is included in the [sample download](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) and is used to display routing information.</span></span>

<span data-ttu-id="80ae9-607">L’implémentation de `MyCustomConstraint` empêche `0` appliquée à un paramètre d’itinéraire :</span><span class="sxs-lookup"><span data-stu-id="80ae9-607">The implementation of `MyCustomConstraint` prevents `0` being applied to a route parameter:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint.cs?name=snippet2)]

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="80ae9-608">Le code précédent :</span><span class="sxs-lookup"><span data-stu-id="80ae9-608">The preceding code:</span></span>

* <span data-ttu-id="80ae9-609">Empêche `0` dans le segment `{id}` de l’itinéraire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-609">Prevents `0` in the `{id}` segment of the route.</span></span>
* <span data-ttu-id="80ae9-610">Est présenté pour fournir un exemple de base de l’implémentation d’une contrainte personnalisée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-610">Is shown to provide a basic example of implementing a custom constraint.</span></span> <span data-ttu-id="80ae9-611">Il ne doit pas être utilisé dans une application de production.</span><span class="sxs-lookup"><span data-stu-id="80ae9-611">It should not be used in a production app.</span></span>

<span data-ttu-id="80ae9-612">Le code suivant est une meilleure approche pour empêcher un `id` contenant un `0` d’être traité :</span><span class="sxs-lookup"><span data-stu-id="80ae9-612">The following code is a better approach to preventing an `id` containing a `0` from being processed:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/TestController.cs?name=snippet2)]

<span data-ttu-id="80ae9-613">Le code précédent présente les avantages suivants par rapport à l’approche `MyCustomConstraint` :</span><span class="sxs-lookup"><span data-stu-id="80ae9-613">The preceding code has the following advantages over the `MyCustomConstraint` approach:</span></span>

* <span data-ttu-id="80ae9-614">Elle ne nécessite pas de contrainte personnalisée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-614">It doesn't require a custom constraint.</span></span>
* <span data-ttu-id="80ae9-615">Elle retourne une erreur plus descriptive lorsque le paramètre d’itinéraire comprend `0`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-615">It returns a more descriptive error when the route parameter includes `0`.</span></span>

## <a name="parameter-transformer-reference"></a><span data-ttu-id="80ae9-616">Informations de référence sur le transformateur de paramètre</span><span class="sxs-lookup"><span data-stu-id="80ae9-616">Parameter transformer reference</span></span>

<span data-ttu-id="80ae9-617">Transformateurs de paramètre :</span><span class="sxs-lookup"><span data-stu-id="80ae9-617">Parameter transformers:</span></span>

* <span data-ttu-id="80ae9-618">Exécuter lors de la génération d’un lien à l’aide de <xref:Microsoft.AspNetCore.Routing.LinkGenerator>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-618">Execute when generating a link using <xref:Microsoft.AspNetCore.Routing.LinkGenerator>.</span></span>
* <span data-ttu-id="80ae9-619">Implémentez <xref:Microsoft.AspNetCore.Routing.IOutboundParameterTransformer?displayProperty=fullName>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-619">Implement <xref:Microsoft.AspNetCore.Routing.IOutboundParameterTransformer?displayProperty=fullName>.</span></span>
* <span data-ttu-id="80ae9-620">Sont configurés à l’aide de <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-620">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="80ae9-621">Prennent la valeur de routage du paramètre et la convertissent en une nouvelle valeur de chaîne.</span><span class="sxs-lookup"><span data-stu-id="80ae9-621">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="80ae9-622">Aboutissent à l’utilisation de la valeur transformée dans le lien généré.</span><span class="sxs-lookup"><span data-stu-id="80ae9-622">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="80ae9-623">Par exemple, un transformateur de paramètre `slugify` personnalisé dans le modèle d’itinéraire `blog\{article:slugify}` avec `Url.Action(new { article = "MyTestArticle" })` génère `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-623">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="80ae9-624">Tenez compte de l’implémentation de `IOutboundParameterTransformer` suivante :</span><span class="sxs-lookup"><span data-stu-id="80ae9-624">Consider the following `IOutboundParameterTransformer` implementation:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint2.cs?name=snippet2)]

<span data-ttu-id="80ae9-625">Pour utiliser un transformateur de paramètre dans un modèle d’itinéraire, configurez-le à l’aide de <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> dans `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-625">To use a parameter transformer in a route pattern, configure it using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint2.cs?name=snippet)]

<span data-ttu-id="80ae9-626">L’infrastructure de ASP.NET Core utilise des transformateurs de paramètre pour transformer l’URI dans lequel un point de terminaison est résolu.</span><span class="sxs-lookup"><span data-stu-id="80ae9-626">The ASP.NET Core framework uses parameter transformers to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="80ae9-627">Par exemple, les transformateurs de paramètres transforment les valeurs d’itinéraire utilisées pour faire correspondre un `area`, `controller`, `action`et `page`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-627">For example, parameter transformers transform the route values used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapControllerRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="80ae9-628">Avec le modèle de route précédent, le `SubscriptionManagementController.GetAll` d’action est mis en correspondance avec l’URI `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-628">With the preceding route template, the action `SubscriptionManagementController.GetAll` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="80ae9-629">Un transformateur de paramètre ne modifie pas les valeurs de routage utilisées pour générer un lien.</span><span class="sxs-lookup"><span data-stu-id="80ae9-629">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="80ae9-630">Par exemple, `Url.Action("GetAll", "SubscriptionManagement")` produit `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-630">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="80ae9-631">ASP.NET Core fournit des conventions d’API pour l’utilisation de transformateurs de paramètres avec des itinéraires générés :</span><span class="sxs-lookup"><span data-stu-id="80ae9-631">ASP.NET Core provides API conventions for using parameter transformers with generated routes:</span></span>

* <span data-ttu-id="80ae9-632">La convention MVC <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention?displayProperty=fullName> applique un transformateur de paramètre spécifié à tous les itinéraires d’attribut dans l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-632">The <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention?displayProperty=fullName> MVC convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="80ae9-633">Le transformateur de paramètre transforme les jetons de routage d’attribut quand ils sont remplacés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-633">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="80ae9-634">Pour plus d’informations, consultez [Utiliser un transformateur de paramètre pour personnaliser le remplacement des jetons](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="80ae9-634">For more information, see [Use a parameter transformer to customize token replacement](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="80ae9-635">Razor Pages utilise la Convention d’API <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-635">Razor Pages uses the <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention> API convention.</span></span> <span data-ttu-id="80ae9-636">Cette convention applique un transformateur de paramètre spécifié à toutes les pages Razor découvertes automatiquement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-636">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="80ae9-637">Le transformateur de paramètre transforme les segments du nom de dossier et du nom de fichier des routes Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="80ae9-637">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="80ae9-638">Pour plus d’informations, consultez [Utiliser un transformateur de paramètre pour personnaliser les routages de pages](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="80ae9-638">For more information, see [Use a parameter transformer to customize page routes](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

<a name="ugr"></a>

## <a name="url-generation-reference"></a><span data-ttu-id="80ae9-639">Informations de référence sur la génération d’URL</span><span class="sxs-lookup"><span data-stu-id="80ae9-639">URL generation reference</span></span>

<span data-ttu-id="80ae9-640">Cette section contient une référence pour l’algorithme implémenté par la génération d’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-640">This section contains a reference for the algorithm implemented by URL generation.</span></span> <span data-ttu-id="80ae9-641">Dans la pratique, la plupart des exemples complexes de génération d’URL utilisent des contrôleurs ou des Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="80ae9-641">In practice, most complex examples of URL generation use controllers or Razor Pages.</span></span> <span data-ttu-id="80ae9-642">Pour plus d’informations, consultez [routage dans les contrôleurs](xref:mvc/controllers/routing) .</span><span class="sxs-lookup"><span data-stu-id="80ae9-642">See  [routing in controllers](xref:mvc/controllers/routing) for additional information.</span></span>

<span data-ttu-id="80ae9-643">Le processus de génération d’URL commence par un appel à [LinkGenerator. GetPathByAddress](xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*) ou à une méthode similaire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-643">The URL generation process begins with a call to [LinkGenerator.GetPathByAddress](xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*) or a similar method.</span></span> <span data-ttu-id="80ae9-644">La méthode est fournie avec une adresse, un ensemble de valeurs d’itinéraire et éventuellement des informations sur la requête actuelle à partir de `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-644">The method is provided with an address, a set of route values, and optionally information about the current request from `HttpContext`.</span></span>

<span data-ttu-id="80ae9-645">La première étape consiste à utiliser l’adresse pour résoudre un jeu de points de terminaison candidats à l’aide d’un [`IEndpointAddressScheme<TAddress>`](xref:Microsoft.AspNetCore.Routing.IEndpointAddressScheme`1) qui correspond au type de l’adresse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-645">The first step is to use the address to resolve a set of candidate endpoints using an [`IEndpointAddressScheme<TAddress>`](xref:Microsoft.AspNetCore.Routing.IEndpointAddressScheme`1) that matches the address's type.</span></span>

<span data-ttu-id="80ae9-646">Une fois l’ensemble de candidats trouvé par le schéma d’adresse, les points de terminaison sont triés et traités de manière itérative jusqu’à ce qu’une opération de génération d’URL aboutisse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-646">Once of set of candidates is found by the address scheme, the endpoints are ordered and processed iteratively until a URL generation operation succeeds.</span></span> <span data-ttu-id="80ae9-647">La génération d’URL ne vérifie **pas** les ambiguïtés, le premier résultat retourné est le résultat final.</span><span class="sxs-lookup"><span data-stu-id="80ae9-647">URL generation does **not** check for ambiguities, the first result returned is the final result.</span></span>

### <a name="troubleshooting-url-generation-with-logging"></a><span data-ttu-id="80ae9-648">Résolution des problèmes de génération d’URL avec journalisation</span><span class="sxs-lookup"><span data-stu-id="80ae9-648">Troubleshooting URL generation with logging</span></span>

<span data-ttu-id="80ae9-649">La première étape de la résolution des problèmes de génération d’URL consiste à définir le niveau de journalisation de `Microsoft.AspNetCore.Routing` sur `TRACE`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-649">The first step in troubleshooting URL generation is setting the logging level of `Microsoft.AspNetCore.Routing` to `TRACE`.</span></span> <span data-ttu-id="80ae9-650">`LinkGenerator` enregistre de nombreux détails sur son traitement, ce qui peut être utile pour résoudre les problèmes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-650">`LinkGenerator` logs many details about its processing which can be useful to troubleshoot problems.</span></span>

<span data-ttu-id="80ae9-651">Pour plus d’informations sur la génération d’URL, consultez [référence de génération d’URL](#ugr) .</span><span class="sxs-lookup"><span data-stu-id="80ae9-651">See [URL generation reference](#ugr) for details on URL generation.</span></span>

### <a name="addresses"></a><span data-ttu-id="80ae9-652">Adresses</span><span class="sxs-lookup"><span data-stu-id="80ae9-652">Addresses</span></span>

<span data-ttu-id="80ae9-653">Les adresses sont le concept dans la génération d’URL utilisé pour lier un appel dans le générateur de liens à un jeu de points de terminaison candidats.</span><span class="sxs-lookup"><span data-stu-id="80ae9-653">Addresses are the concept in URL generation used to bind a call into the link generator to a set of candidate endpoints.</span></span>

<span data-ttu-id="80ae9-654">Les adresses sont un concept extensible qui est fourni avec deux implémentations par défaut :</span><span class="sxs-lookup"><span data-stu-id="80ae9-654">Addresses are an extensible concept that come with two implementations by default:</span></span>

* <span data-ttu-id="80ae9-655">Utilisation du *nom de point de terminaison* (`string`) comme adresse :</span><span class="sxs-lookup"><span data-stu-id="80ae9-655">Using *endpoint name* (`string`) as the address:</span></span>
    * <span data-ttu-id="80ae9-656">Fournit des fonctionnalités similaires au nom d’itinéraire de MVC.</span><span class="sxs-lookup"><span data-stu-id="80ae9-656">Provides similar functionality to MVC's route name.</span></span>
    * <span data-ttu-id="80ae9-657">Utilise le type de métadonnées <xref:Microsoft.AspNetCore.Routing.IEndpointNameMetadata>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-657">Uses the <xref:Microsoft.AspNetCore.Routing.IEndpointNameMetadata> metadata type.</span></span>
    * <span data-ttu-id="80ae9-658">Résout la chaîne fournie par rapport aux métadonnées de tous les points de terminaison inscrits.</span><span class="sxs-lookup"><span data-stu-id="80ae9-658">Resolves the provided string against the metadata of all registered endpoints.</span></span>
    * <span data-ttu-id="80ae9-659">Lève une exception au démarrage si plusieurs points de terminaison utilisent le même nom.</span><span class="sxs-lookup"><span data-stu-id="80ae9-659">Throws an exception on startup if multiple endpoints use the same name.</span></span>
    * <span data-ttu-id="80ae9-660">Recommandé pour une utilisation à usage général en dehors des contrôleurs et des Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="80ae9-660">Recommended for general-purpose use outside of controllers and Razor Pages.</span></span>
* <span data-ttu-id="80ae9-661">Utilisation des *valeurs de route* (<xref:Microsoft.AspNetCore.Routing.RouteValuesAddress>) comme adresse :</span><span class="sxs-lookup"><span data-stu-id="80ae9-661">Using *route values* (<xref:Microsoft.AspNetCore.Routing.RouteValuesAddress>) as the address:</span></span>
    * <span data-ttu-id="80ae9-662">Fournit des fonctionnalités similaires aux contrôleurs et Razor Pages la génération d’URL héritée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-662">Provides similar functionality to controllers and Razor Pages legacy URL generation.</span></span>
    * <span data-ttu-id="80ae9-663">Très complexe à étendre et à déboguer.</span><span class="sxs-lookup"><span data-stu-id="80ae9-663">Very complex to extend and debug.</span></span>
    * <span data-ttu-id="80ae9-664">Fournit l’implémentation utilisée par les `IUrlHelper`, les tag helpers, les applications auxiliaires HTML, les résultats d’action, etc.</span><span class="sxs-lookup"><span data-stu-id="80ae9-664">Provides the implementation used by `IUrlHelper`, Tag Helpers, HTML Helpers, Action Results, etc.</span></span>

<span data-ttu-id="80ae9-665">Le rôle du schéma d’adresse consiste à effectuer l’association entre l’adresse et les points de terminaison correspondants à l’aide de critères arbitraires :</span><span class="sxs-lookup"><span data-stu-id="80ae9-665">The role of the address scheme is to make the association between the address and matching endpoints by arbitrary criteria:</span></span>

* <span data-ttu-id="80ae9-666">Le modèle de nom de point de terminaison effectue une recherche de dictionnaire de base.</span><span class="sxs-lookup"><span data-stu-id="80ae9-666">The endpoint name scheme performs a basic dictionary lookup.</span></span>
* <span data-ttu-id="80ae9-667">Le schéma de valeurs d’itinéraire a un meilleur sous-ensemble complexe de l’algorithme Set.</span><span class="sxs-lookup"><span data-stu-id="80ae9-667">The route values scheme has a complex best subset of set algorithm.</span></span>

<a name="ambient"></a>

### <a name="ambient-values-and-explicit-values"></a><span data-ttu-id="80ae9-668">Valeurs ambiantes et valeurs explicites</span><span class="sxs-lookup"><span data-stu-id="80ae9-668">Ambient values and explicit values</span></span>

<span data-ttu-id="80ae9-669">À partir de la requête actuelle, le routage accède aux valeurs d’itinéraire de la requête actuelle `HttpContext.Request.RouteValues`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-669">From the current request, routing accesses the route values of the current request `HttpContext.Request.RouteValues`.</span></span> <span data-ttu-id="80ae9-670">Les valeurs associées à la requête actuelle sont appelées **valeurs ambiantes**.</span><span class="sxs-lookup"><span data-stu-id="80ae9-670">The values associated with the current request are referred to as the **ambient values**.</span></span> <span data-ttu-id="80ae9-671">Pour des raisons de clarté, la documentation fait référence aux valeurs de route transmises aux méthodes en tant que **valeurs explicites**.</span><span class="sxs-lookup"><span data-stu-id="80ae9-671">For the purpose of clarity, the documentation refers to the route values passed in to methods as **explicit values**.</span></span>

<span data-ttu-id="80ae9-672">L’exemple suivant montre des valeurs ambiantes et des valeurs explicites.</span><span class="sxs-lookup"><span data-stu-id="80ae9-672">The following example shows ambient values and explicit values.</span></span> <span data-ttu-id="80ae9-673">Il fournit des valeurs ambiantes à partir de la requête actuelle et des valeurs explicites : `{ id = 17, }`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-673">It provides ambient values from the current request and explicit values: `{ id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet)]

<span data-ttu-id="80ae9-674">Le code précédent :</span><span class="sxs-lookup"><span data-stu-id="80ae9-674">The preceding code:</span></span>

* <span data-ttu-id="80ae9-675">Retourne `/Widget/Index/17`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-675">Returns `/Widget/Index/17`</span></span>
* <span data-ttu-id="80ae9-676">Obtient <xref:Microsoft.AspNetCore.Routing.LinkGenerator> via [di](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="80ae9-676">Gets <xref:Microsoft.AspNetCore.Routing.LinkGenerator> via [DI](xref:fundamentals/dependency-injection).</span></span>

<span data-ttu-id="80ae9-677">Le code suivant ne fournit aucune valeur ambiante ni valeur explicite : `{ controller = "Home", action = "Subscribe", id = 17, }`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-677">The following code provides no ambient values and explicit values: `{ controller = "Home", action = "Subscribe", id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet2)]

<span data-ttu-id="80ae9-678">La méthode précédente retourne `/Home/Subscribe/17`</span><span class="sxs-lookup"><span data-stu-id="80ae9-678">The preceding  method returns `/Home/Subscribe/17`</span></span>

<span data-ttu-id="80ae9-679">Le code suivant dans le `WidgetController` retourne `/Widget/Subscribe/17`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-679">The following code in the `WidgetController` returns `/Widget/Subscribe/17`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet3)]

<span data-ttu-id="80ae9-680">Le code suivant fournit le contrôleur à partir des valeurs ambiantes dans la requête actuelle et les valeurs explicites : `{ action = "Edit", id = 17, }`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-680">The following code provides the controller from ambient values in the current request and explicit values: `{ action = "Edit", id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/GadgetController.cs?name=snippet)]

<span data-ttu-id="80ae9-681">Dans le code précédent :</span><span class="sxs-lookup"><span data-stu-id="80ae9-681">In the preceding code:</span></span>

* <span data-ttu-id="80ae9-682">`/Gadget/Edit/17` est retourné.</span><span class="sxs-lookup"><span data-stu-id="80ae9-682">`/Gadget/Edit/17` is returned.</span></span>
* <span data-ttu-id="80ae9-683"><xref:Microsoft.AspNetCore.Mvc.ControllerBase.Url> obtient le <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-683"><xref:Microsoft.AspNetCore.Mvc.ControllerBase.Url> gets the <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>.</span></span>
* <xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*>   
<span data-ttu-id="80ae9-684">génère une URL avec un chemin d’accès absolu pour une méthode d’action.</span><span class="sxs-lookup"><span data-stu-id="80ae9-684">generates a URL with an absolute path for an action method.</span></span> <span data-ttu-id="80ae9-685">L’URL contient le nom de `action` spécifié et les valeurs de `route`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-685">The URL contains the specified `action` name and `route` values.</span></span>

<span data-ttu-id="80ae9-686">Le code suivant fournit des valeurs ambiantes à partir de la requête actuelle et des valeurs explicites : `{ page = "./Edit, id = 17, }`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-686">The following code provides ambient values from the current request and explicit values: `{ page = "./Edit, id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Pages/Index.cshtml.cs?name=snippet)]

<span data-ttu-id="80ae9-687">Le code précédent définit `url` à `/Edit/17` lorsque la page de modification Razor contient la directive de page suivante :</span><span class="sxs-lookup"><span data-stu-id="80ae9-687">The preceding code sets `url` to  `/Edit/17` when the Edit Razor Page contains the following page directive:</span></span>

 `@page "{id:int}"`

<span data-ttu-id="80ae9-688">Si la page de modification ne contient pas le modèle `"{id:int}"` route, `url` est `/Edit?id=17`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-688">If the Edit page doesn't contain the `"{id:int}"` route template, `url` is `/Edit?id=17`.</span></span>

<span data-ttu-id="80ae9-689">Le comportement de <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> de MVC ajoute une couche de complexité en plus des règles décrites ici :</span><span class="sxs-lookup"><span data-stu-id="80ae9-689">The behavior of MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> adds a layer of complexity in addition to the rules described here:</span></span>

* <span data-ttu-id="80ae9-690">`IUrlHelper` fournit toujours les valeurs d’itinéraire de la requête actuelle comme valeurs ambiantes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-690">`IUrlHelper` always provides the route values from the current request as ambient values.</span></span>
* <span data-ttu-id="80ae9-691">[IUrlHelper. action](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*) copie toujours le `action` actuel et `controller` valeurs de route en tant que valeurs explicites, sauf si elles sont remplacées par le développeur.</span><span class="sxs-lookup"><span data-stu-id="80ae9-691">[IUrlHelper.Action](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*) always copies the current `action` and `controller` route values as explicit values unless overridden by the developer.</span></span>
* <span data-ttu-id="80ae9-692">[IUrlHelper. page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*) copie toujours la valeur actuelle de l’itinéraire `page` en tant que valeur explicite, sauf si elle est substituée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-692">[IUrlHelper.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*) always copies the current `page` route value as an explicit value unless overridden.</span></span> <!--by the user-->
* <span data-ttu-id="80ae9-693">`IUrlHelper.Page` remplace toujours la valeur actuelle de l’itinéraire `handler` par `null` en tant que valeurs explicites, sauf si elle est substituée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-693">`IUrlHelper.Page` always overrides the current `handler` route value with `null` as an explicit values unless overridden.</span></span>

<span data-ttu-id="80ae9-694">Les utilisateurs sont souvent surpris par les détails de comportement des valeurs ambiantes, car MVC ne semble pas suivre ses propres règles.</span><span class="sxs-lookup"><span data-stu-id="80ae9-694">Users are often surprised by the behavioral details of ambient values, because MVC doesn't seem to follow its own rules.</span></span> <span data-ttu-id="80ae9-695">Pour des raisons d’historique et de compatibilité, certaines valeurs de route, telles que `action`, `controller`, `page`et `handler` ont leur propre comportement de cas spéciaux.</span><span class="sxs-lookup"><span data-stu-id="80ae9-695">For historical and compatibility reasons, certain route values such as `action`, `controller`, `page`, and `handler` have their own special-case behavior.</span></span>

<span data-ttu-id="80ae9-696">Les fonctionnalités équivalentes fournies par `LinkGenerator.GetPathByAction` et `LinkGenerator.GetPathByPage` dupliquent ces anomalies de `IUrlHelper` à des fins de compatibilité.</span><span class="sxs-lookup"><span data-stu-id="80ae9-696">The equivalent functionality provided by `LinkGenerator.GetPathByAction` and `LinkGenerator.GetPathByPage` duplicates these anomalies of `IUrlHelper` for compatibility.</span></span>

### <a name="url-generation-process"></a><span data-ttu-id="80ae9-697">Processus de génération d’URL</span><span class="sxs-lookup"><span data-stu-id="80ae9-697">URL generation process</span></span>

<span data-ttu-id="80ae9-698">Une fois que le jeu de points de terminaison candidats est trouvé, l’algorithme de génération d’URL :</span><span class="sxs-lookup"><span data-stu-id="80ae9-698">Once the set of candidate endpoints are found, the URL generation algorithm:</span></span>

* <span data-ttu-id="80ae9-699">Traite les points de terminaison de manière itérative.</span><span class="sxs-lookup"><span data-stu-id="80ae9-699">Processes the endpoints iteratively.</span></span>
* <span data-ttu-id="80ae9-700">Retourne le premier résultat réussi.</span><span class="sxs-lookup"><span data-stu-id="80ae9-700">Returns the first successful result.</span></span>

<span data-ttu-id="80ae9-701">La première étape de ce processus est appelée **invalidation**de la valeur de l’itinéraire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-701">The first step in this process is called **route value invalidation**.</span></span>  <span data-ttu-id="80ae9-702">L’invalidation de la valeur de routage est le processus par lequel le routage décide des valeurs d’itinéraire des valeurs ambiantes qui doivent être utilisées et qui doivent être ignorées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-702">Route value invalidation is the process by which routing decides which route values from the ambient values should be used and which should be ignored.</span></span> <span data-ttu-id="80ae9-703">Chaque valeur ambiante est prise en compte et soit combinée avec les valeurs explicites, soit ignorée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-703">Each ambient value is considered and either combined with the explicit values, or ignored.</span></span>

<span data-ttu-id="80ae9-704">La meilleure façon de réfléchir au rôle des valeurs ambiantes est qu’elles essaient d’enregistrer les développeurs d’applications qui tapent, dans certains cas courants.</span><span class="sxs-lookup"><span data-stu-id="80ae9-704">The best way to think about the role of ambient values is that they attempt to save application developers typing, in some common cases.</span></span> <span data-ttu-id="80ae9-705">Traditionnellement, les scénarios où les valeurs ambiantes sont utiles sont liés à MVC :</span><span class="sxs-lookup"><span data-stu-id="80ae9-705">Traditionally, the scenarios where ambient values are helpful are related to MVC:</span></span>

* <span data-ttu-id="80ae9-706">Lors de la liaison à une autre action dans le même contrôleur, le nom du contrôleur n’a pas besoin d’être spécifié.</span><span class="sxs-lookup"><span data-stu-id="80ae9-706">When linking to another action in the same controller, the controller name doesn't need to be specified.</span></span>
* <span data-ttu-id="80ae9-707">Lors de la liaison à un autre contrôleur dans la même zone, il n’est pas nécessaire de spécifier le nom de la zone.</span><span class="sxs-lookup"><span data-stu-id="80ae9-707">When linking to another controller in the same area, the area name doesn't need to be specified.</span></span>
* <span data-ttu-id="80ae9-708">Lors de la liaison à la même méthode d’action, il n’est pas nécessaire de spécifier des valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-708">When linking to the same action method, route values don't need to be specified.</span></span>
* <span data-ttu-id="80ae9-709">Lors de la liaison à une autre partie de l’application, vous ne souhaitez pas transférer les valeurs de route qui n’ont aucune signification dans cette partie de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-709">When linking to another part of the app, you don't want to carry over route values that have no meaning in that part of the app.</span></span>

<span data-ttu-id="80ae9-710">Les appels à `LinkGenerator` ou `IUrlHelper` qui retournent `null` sont généralement provoqués par la non-compréhension de l’invalidation de la valeur de l’itinéraire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-710">Calls to `LinkGenerator` or `IUrlHelper` that return `null` are usually caused by not understanding route value invalidation.</span></span> <span data-ttu-id="80ae9-711">Résolvez les problèmes d’invalidation de valeur de routage en spécifiant explicitement plus de valeurs d’itinéraire pour voir si cela résout le problème.</span><span class="sxs-lookup"><span data-stu-id="80ae9-711">Troubleshoot route value invalidation by explicitly specifying more of the route values to see if that solves the problem.</span></span>

<span data-ttu-id="80ae9-712">L’invalidation de la valeur de routage fonctionne en partant du principe que le schéma d’URL de l’application est hiérarchique, avec une hiérarchie formée de gauche à droite.</span><span class="sxs-lookup"><span data-stu-id="80ae9-712">Route value invalidation works on the assumption that the app's URL scheme is hierarchical, with a hierarchy formed from left-to-right.</span></span> <span data-ttu-id="80ae9-713">Considérez le modèle de routage de base du contrôleur `{controller}/{action}/{id?}` pour avoir une idée intuitive de son fonctionnement dans la pratique.</span><span class="sxs-lookup"><span data-stu-id="80ae9-713">Consider the basic controller route template `{controller}/{action}/{id?}` to get an intuitive sense of how this works in practice.</span></span> <span data-ttu-id="80ae9-714">Une **modification apportée** à une valeur **invalide** toutes les valeurs d’itinéraire qui s’affichent à droite.</span><span class="sxs-lookup"><span data-stu-id="80ae9-714">A **change** to a value **invalidates** all of the route values that appear to the right.</span></span> <span data-ttu-id="80ae9-715">Cela reflète l’hypothèse sur la hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="80ae9-715">This reflects the assumption about hierarchy.</span></span> <span data-ttu-id="80ae9-716">Si l’application a une valeur ambiante pour `id`, et que l’opération spécifie une valeur différente pour le `controller`:</span><span class="sxs-lookup"><span data-stu-id="80ae9-716">If the app has an ambient value for `id`, and the operation specifies a different value for the `controller`:</span></span>

* <span data-ttu-id="80ae9-717">`id` ne sera pas réutilisé car `{controller}` est à gauche de `{id?}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-717">`id` won't be reused because `{controller}` is to the left of `{id?}`.</span></span>

<span data-ttu-id="80ae9-718">Voici quelques exemples qui illustrent ce principe :</span><span class="sxs-lookup"><span data-stu-id="80ae9-718">Some examples demonstrating this principle:</span></span>

* <span data-ttu-id="80ae9-719">Si les valeurs explicites contiennent une valeur pour `id`, la valeur ambiante pour `id` est ignorée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-719">If the explicit values contain a value for `id`, the ambient value for `id` is ignored.</span></span> <span data-ttu-id="80ae9-720">Les valeurs ambiantes pour `controller` et `action` peuvent être utilisées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-720">The ambient values for `controller` and `action` can be used.</span></span>
* <span data-ttu-id="80ae9-721">Si les valeurs explicites contiennent une valeur pour `action`, toute valeur ambiante pour `action` est ignorée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-721">If the explicit values contain a value for `action`, any ambient value for `action` is ignored.</span></span> <span data-ttu-id="80ae9-722">Vous pouvez utiliser les valeurs ambiantes pour `controller`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-722">The ambient values for `controller` can be used.</span></span> <span data-ttu-id="80ae9-723">Si la valeur explicite de `action` est différente de la valeur ambiante de `action`, la valeur de `id` n’est pas utilisée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-723">If the explicit value for `action` is different from the ambient value for `action`, the `id` value won't be used.</span></span>  <span data-ttu-id="80ae9-724">Si la valeur explicite de `action` est identique à la valeur ambiante de `action`, la valeur de `id` peut être utilisée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-724">If the explicit value for `action` is the same as the ambient value for `action`, the `id` value can be used.</span></span>
* <span data-ttu-id="80ae9-725">Si les valeurs explicites contiennent une valeur pour `controller`, toute valeur ambiante pour `controller` est ignorée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-725">If the explicit values contain a value for `controller`, any ambient value for `controller` is ignored.</span></span> <span data-ttu-id="80ae9-726">Si la valeur explicite de `controller` est différente de la valeur ambiante pour `controller`, les valeurs `action` et `id` ne sont pas utilisées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-726">If the explicit value for `controller` is different from the ambient value for `controller`, the `action` and `id` values won't be used.</span></span> <span data-ttu-id="80ae9-727">Si la valeur explicite de `controller` est identique à la valeur ambiante pour `controller`, les valeurs `action` et `id` peuvent être utilisées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-727">If the explicit value for `controller` is the same as the ambient value for `controller`, the `action` and `id` values can be used.</span></span>

<span data-ttu-id="80ae9-728">Ce processus est encore plus compliqué par l’existence d’itinéraires d’attribut et d’itinéraires conventionnels dédiés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-728">This process is further complicated by the existence of attribute routes and dedicated conventional routes.</span></span> <span data-ttu-id="80ae9-729">Les itinéraires conventionnels du contrôleur, comme `{controller}/{action}/{id?}` spécifier une hiérarchie à l’aide de paramètres de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-729">Controller conventional routes such as `{controller}/{action}/{id?}` specify a hierarchy using route parameters.</span></span> <span data-ttu-id="80ae9-730">Pour les [itinéraires conventionnels](xref:mvc/controllers/routing#dcr) et les [itinéraires d’attribut](xref:mvc/controllers/routing#ar) dédiés aux contrôleurs et Razor pages :</span><span class="sxs-lookup"><span data-stu-id="80ae9-730">For [dedicated conventional routes](xref:mvc/controllers/routing#dcr) and [attribute routes](xref:mvc/controllers/routing#ar) to controllers and Razor Pages:</span></span>

* <span data-ttu-id="80ae9-731">Il existe une hiérarchie de valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-731">There is a hierarchy of route values.</span></span>
* <span data-ttu-id="80ae9-732">Ils n’apparaissent pas dans le modèle.</span><span class="sxs-lookup"><span data-stu-id="80ae9-732">They don't appear in the template.</span></span>

<span data-ttu-id="80ae9-733">Dans ce cas, la génération d’URL définit le concept de **valeurs requis** .</span><span class="sxs-lookup"><span data-stu-id="80ae9-733">For these cases, URL generation defines the **required values** concept.</span></span> <span data-ttu-id="80ae9-734">Les points de terminaison créés par les contrôleurs et les Razor Pages ont des valeurs requises spécifiées qui autorisent le fonctionnement de l’invalidation de la valeur de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-734">Endpoints created by controllers and Razor Pages have required values specified that allow route value invalidation to work.</span></span>

<span data-ttu-id="80ae9-735">L’algorithme d’invalidation de la valeur de routage est en détail :</span><span class="sxs-lookup"><span data-stu-id="80ae9-735">The route value invalidation algorithm in detail:</span></span>

* <span data-ttu-id="80ae9-736">Les noms de valeur requis sont combinés avec les paramètres de route, puis traités de gauche à droite.</span><span class="sxs-lookup"><span data-stu-id="80ae9-736">The required value names are combined with the route parameters, then processed from left-to-right.</span></span>
* <span data-ttu-id="80ae9-737">Pour chaque paramètre, la valeur ambiante et la valeur explicite sont comparées :</span><span class="sxs-lookup"><span data-stu-id="80ae9-737">For each parameter, the ambient value and explicit value are compared:</span></span>
    * <span data-ttu-id="80ae9-738">Si la valeur ambiante et la valeur explicite sont identiques, le processus se poursuit.</span><span class="sxs-lookup"><span data-stu-id="80ae9-738">If the ambient value and explicit value are the same, the process continues.</span></span>
    * <span data-ttu-id="80ae9-739">Si la valeur ambiante est présente et que la valeur explicite n’est pas, la valeur ambiante est utilisée lors de la génération de l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-739">If the ambient value is present and the explicit value isn't, the ambient value is used when generating the URL.</span></span>
    * <span data-ttu-id="80ae9-740">Si la valeur ambiante n’est pas présente et si la valeur explicite est, rejetez la valeur ambiante et toutes les valeurs ambiantes suivantes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-740">If the ambient value isn't present and the explicit value is, reject the ambient value and all subsequent ambient values.</span></span>
    * <span data-ttu-id="80ae9-741">Si la valeur ambiante et la valeur explicite sont présentes, et si les deux valeurs sont différentes, rejetez la valeur ambiante et toutes les valeurs ambiantes suivantes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-741">If the ambient value and the explicit value are present, and the two values are different, reject the ambient value and all subsequent ambient values.</span></span>

<span data-ttu-id="80ae9-742">À ce stade, l’opération de génération d’URL est prête à évaluer les contraintes de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-742">At this point, the URL generation operation is ready to evaluate route constraints.</span></span> <span data-ttu-id="80ae9-743">L’ensemble de valeurs acceptées est associé aux valeurs par défaut du paramètre, qui sont fournies aux contraintes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-743">The set of accepted values is combined with the parameter default values, which is provided to constraints.</span></span> <span data-ttu-id="80ae9-744">Si les contraintes réussissent, l’opération continue.</span><span class="sxs-lookup"><span data-stu-id="80ae9-744">If the constraints all pass, the operation continues.</span></span>

<span data-ttu-id="80ae9-745">Ensuite, les **valeurs acceptées** peuvent être utilisées pour développer le modèle de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-745">Next, the **accepted values** can be used to expand the route template.</span></span> <span data-ttu-id="80ae9-746">Le modèle de routage est traité :</span><span class="sxs-lookup"><span data-stu-id="80ae9-746">The route template is processed:</span></span>

* <span data-ttu-id="80ae9-747">De gauche à droite.</span><span class="sxs-lookup"><span data-stu-id="80ae9-747">From left-to-right.</span></span>
* <span data-ttu-id="80ae9-748">La valeur acceptée est remplacée pour chaque paramètre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-748">Each parameter has its accepted value substituted.</span></span>
* <span data-ttu-id="80ae9-749">Dans les cas spéciaux suivants :</span><span class="sxs-lookup"><span data-stu-id="80ae9-749">With the following special cases:</span></span>
  * <span data-ttu-id="80ae9-750">Si une valeur est manquante pour les valeurs acceptées et que le paramètre a une valeur par défaut, la valeur par défaut est utilisée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-750">If the accepted values is missing a value and the parameter has a default value, the default value is used.</span></span>
  * <span data-ttu-id="80ae9-751">Si une valeur est manquante pour les valeurs acceptées et que le paramètre est facultatif, le traitement continue.</span><span class="sxs-lookup"><span data-stu-id="80ae9-751">If the accepted values is missing a value and the parameter is optional, processing continues.</span></span>
  * <span data-ttu-id="80ae9-752">Si un paramètre d’itinéraire à droite d’un paramètre facultatif manquant a une valeur, l’opération échoue.</span><span class="sxs-lookup"><span data-stu-id="80ae9-752">If any route parameter to the right of a missing optional parameter has a value, the operation fails.</span></span>
  * <!-- review default-valued parameters optional parameters --> <span data-ttu-id="80ae9-753">Les paramètres par défaut et les paramètres facultatifs contigus sont réduits dans la mesure du possible.</span><span class="sxs-lookup"><span data-stu-id="80ae9-753">Contiguous default-valued parameters and optional parameters are collapsed where possible.</span></span>

<span data-ttu-id="80ae9-754">Les valeurs fournies explicitement qui ne correspondent pas à un segment de l’itinéraire sont ajoutées à la chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-754">Values explicitly provided that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="80ae9-755">Le tableau suivant présente le résultat en cas d’utilisation du modèle de routage `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-755">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="80ae9-756">Valeurs ambiantes</span><span class="sxs-lookup"><span data-stu-id="80ae9-756">Ambient Values</span></span>                     | <span data-ttu-id="80ae9-757">Valeurs explicites</span><span class="sxs-lookup"><span data-stu-id="80ae9-757">Explicit Values</span></span>                        | <span data-ttu-id="80ae9-758">Résultats</span><span class="sxs-lookup"><span data-stu-id="80ae9-758">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="80ae9-759">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="80ae9-759">controller = "Home"</span></span>                | <span data-ttu-id="80ae9-760">action = "About"</span><span class="sxs-lookup"><span data-stu-id="80ae9-760">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="80ae9-761">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="80ae9-761">controller = "Home"</span></span>                | <span data-ttu-id="80ae9-762">controller = "Order", action = "About"</span><span class="sxs-lookup"><span data-stu-id="80ae9-762">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="80ae9-763">controller = "Home", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="80ae9-763">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="80ae9-764">action = "About"</span><span class="sxs-lookup"><span data-stu-id="80ae9-764">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="80ae9-765">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="80ae9-765">controller = "Home"</span></span>                | <span data-ttu-id="80ae9-766">action = "About", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="80ae9-766">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

### <a name="problems-with-route-value-invalidation"></a><span data-ttu-id="80ae9-767">Problèmes liés à l’invalidation de la valeur de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-767">Problems with route value invalidation</span></span>

<span data-ttu-id="80ae9-768">À partir de ASP.NET Core 3,0, certains modèles de génération d’URL utilisés dans les versions ASP.NET Core antérieures ne fonctionnent pas correctement avec la génération d’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-768">As of ASP.NET Core 3.0, some URL generation schemes used in earlier ASP.NET Core versions don't work well with URL generation.</span></span> <span data-ttu-id="80ae9-769">L’équipe ASP.NET Core prévoit d’ajouter des fonctionnalités pour répondre à ces besoins dans une version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="80ae9-769">The ASP.NET Core team plans to add features to address these needs in a future release.</span></span> <span data-ttu-id="80ae9-770">Pour le moment, la meilleure solution consiste à utiliser le routage hérité.</span><span class="sxs-lookup"><span data-stu-id="80ae9-770">For now the best solution is to use legacy routing.</span></span>

<span data-ttu-id="80ae9-771">Le code suivant montre un exemple de schéma de génération d’URL qui n’est pas pris en charge par le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-771">The following code shows an example of a URL generation scheme that's not supported by routing.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupUnsupported.cs?name=snippet)]

<span data-ttu-id="80ae9-772">Dans le code précédent, le paramètre d’itinéraire `culture` est utilisé pour la localisation.</span><span class="sxs-lookup"><span data-stu-id="80ae9-772">In the preceding code, the `culture` route parameter is used for localization.</span></span> <span data-ttu-id="80ae9-773">Le souhait est de faire en sorte que le paramètre `culture` soit toujours accepté comme valeur ambiante.</span><span class="sxs-lookup"><span data-stu-id="80ae9-773">The desire is to have the `culture` parameter always accepted as an ambient value.</span></span> <span data-ttu-id="80ae9-774">Toutefois, le paramètre `culture` n’est pas accepté comme valeur ambiante en raison de la façon dont les valeurs requises fonctionnent :</span><span class="sxs-lookup"><span data-stu-id="80ae9-774">However, the `culture` parameter is not accepted as an ambient value because of the way required values work:</span></span>

* <span data-ttu-id="80ae9-775">Dans le modèle d’itinéraire `"default"`, le `culture` paramètre d’itinéraire se trouve à gauche de `controller`. par conséquent, les modifications apportées à `controller` n’invalideront pas `culture`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-775">In the `"default"` route template, the `culture` route parameter is to the left of `controller`, so changes to `controller` won't invalidate `culture`.</span></span>
* <span data-ttu-id="80ae9-776">Dans le modèle d’itinéraire `"blog"`, le paramètre d’itinéraire `culture` est considéré à droite de `controller`, qui apparaît dans les valeurs requises.</span><span class="sxs-lookup"><span data-stu-id="80ae9-776">In the `"blog"` route template, the `culture` route parameter is considered to be to the right of `controller`, which appears in the required values.</span></span>

## <a name="configuring-endpoint-metadata"></a><span data-ttu-id="80ae9-777">Configuration des métadonnées de point de terminaison</span><span class="sxs-lookup"><span data-stu-id="80ae9-777">Configuring endpoint metadata</span></span>

<span data-ttu-id="80ae9-778">Les liens suivants fournissent des informations sur la configuration des métadonnées de point de terminaison :</span><span class="sxs-lookup"><span data-stu-id="80ae9-778">The following links provide information on configuring endpoint metadata:</span></span>

* [<span data-ttu-id="80ae9-779">Activer cors avec routage du point de terminaison</span><span class="sxs-lookup"><span data-stu-id="80ae9-779">Enable Cors with endpoint routing</span></span>](xref:security/cors#enable-cors-with-endpoint-routing)
* <span data-ttu-id="80ae9-780">[Exemple IAuthorizationPolicyProvider](https://github.com/dotnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) à l’aide d’un attribut de `[MinimumAgeAuthorize]` personnalisé</span><span class="sxs-lookup"><span data-stu-id="80ae9-780">[IAuthorizationPolicyProvider sample](https://github.com/dotnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) using a custom `[MinimumAgeAuthorize]` attribute</span></span>
* <span data-ttu-id="80ae9-781">[Tester l’authentification avec l’attribut [Authorize]](xref:security/authentication/identity#test-identity)</span><span class="sxs-lookup"><span data-stu-id="80ae9-781">[Test authentication with the [Authorize] attribute](xref:security/authentication/identity#test-identity)</span></span>
* <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*>
* <span data-ttu-id="80ae9-782">[Sélection du schéma avec l’attribut [Authorize]](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span><span class="sxs-lookup"><span data-stu-id="80ae9-782">[Selecting the scheme with the [Authorize] attribute](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span></span>
* <span data-ttu-id="80ae9-783">[Application de stratégies à l’aide de l’attribut [Authorize]](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span><span class="sxs-lookup"><span data-stu-id="80ae9-783">[Applying policies using the [Authorize] attribute](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span></span>
* <xref:security/authorization/roles>

<a name="hostmatch"></a>

## <a name="host-matching-in-routes-with-requirehost"></a><span data-ttu-id="80ae9-784">Correspondance d’hôte dans les itinéraires avec RequireHost</span><span class="sxs-lookup"><span data-stu-id="80ae9-784">Host matching in routes with RequireHost</span></span>

<span data-ttu-id="80ae9-785"><xref:Microsoft.AspNetCore.Builder.RoutingEndpointConventionBuilderExtensions.RequireHost*> applique une contrainte à l’itinéraire qui requiert l’hôte spécifié.</span><span class="sxs-lookup"><span data-stu-id="80ae9-785"><xref:Microsoft.AspNetCore.Builder.RoutingEndpointConventionBuilderExtensions.RequireHost*> applies a constraint to the route which requires the specified host.</span></span> <span data-ttu-id="80ae9-786">Le paramètre `RequireHost` ou [[Host]](xref:Microsoft.AspNetCore.Routing.HostAttribute) peut être :</span><span class="sxs-lookup"><span data-stu-id="80ae9-786">The `RequireHost` or [[Host]](xref:Microsoft.AspNetCore.Routing.HostAttribute) parameter can be:</span></span>

* <span data-ttu-id="80ae9-787">Host : `www.domain.com`, correspond à `www.domain.com` avec n’importe quel port.</span><span class="sxs-lookup"><span data-stu-id="80ae9-787">Host: `www.domain.com`, matches `www.domain.com` with any port.</span></span>
* <span data-ttu-id="80ae9-788">Hôte avec caractère générique : `*.domain.com`, correspond `www.domain.com`, `subdomain.domain.com`ou `www.subdomain.domain.com` sur n’importe quel port.</span><span class="sxs-lookup"><span data-stu-id="80ae9-788">Host with wildcard: `*.domain.com`, matches `www.domain.com`, `subdomain.domain.com`, or `www.subdomain.domain.com` on any port.</span></span>
* <span data-ttu-id="80ae9-789">Port : `*:5000`, correspond au port 5000 avec n’importe quel hôte.</span><span class="sxs-lookup"><span data-stu-id="80ae9-789">Port: `*:5000`, matches port 5000 with any host.</span></span>
* <span data-ttu-id="80ae9-790">Hôte et port : `www.domain.com:5000` ou `*.domain.com:5000`, correspond à l’hôte et au port.</span><span class="sxs-lookup"><span data-stu-id="80ae9-790">Host and port: `www.domain.com:5000` or `*.domain.com:5000`, matches host and port.</span></span>

<span data-ttu-id="80ae9-791">Plusieurs paramètres peuvent être spécifiés à l’aide de `RequireHost` ou `[Host]`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-791">Multiple parameters can be specified using `RequireHost` or `[Host]`.</span></span> <span data-ttu-id="80ae9-792">La contrainte correspond aux hôtes valides pour l’un des paramètres.</span><span class="sxs-lookup"><span data-stu-id="80ae9-792">The constraint  matches hosts valid for any of the parameters.</span></span> <span data-ttu-id="80ae9-793">Par exemple, `[Host("domain.com", "*.domain.com")]` correspond à `domain.com`, `www.domain.com`et `subdomain.domain.com`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-793">For example, `[Host("domain.com", "*.domain.com")]` matches `domain.com`, `www.domain.com`, and `subdomain.domain.com`.</span></span>

<span data-ttu-id="80ae9-794">Le code suivant utilise `RequireHost` pour exiger l’hôte spécifié sur l’itinéraire :</span><span class="sxs-lookup"><span data-stu-id="80ae9-794">The following code uses `RequireHost` to require the specified host on the route:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRequireHost.cs?name=snippet)]

<span data-ttu-id="80ae9-795">Le code suivant utilise l’attribut `[Host]` sur le contrôleur pour exiger l’un des ordinateurs hôtes spécifiés :</span><span class="sxs-lookup"><span data-stu-id="80ae9-795">The following code uses the `[Host]` attribute on the controller to require any of the specified hosts:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/ProductController.cs?name=snippet)]

<span data-ttu-id="80ae9-796">Lorsque l’attribut `[Host]` est appliqué au contrôleur et à la méthode d’action :</span><span class="sxs-lookup"><span data-stu-id="80ae9-796">When the `[Host]` attribute is applied to both the controller and action method:</span></span>

* <span data-ttu-id="80ae9-797">L’attribut de l’action est utilisé.</span><span class="sxs-lookup"><span data-stu-id="80ae9-797">The attribute on the action is used.</span></span>
* <span data-ttu-id="80ae9-798">L’attribut Controller est ignoré.</span><span class="sxs-lookup"><span data-stu-id="80ae9-798">The controller attribute is ignored.</span></span>

## <a name="performance-guidance-for-routing"></a><span data-ttu-id="80ae9-799">Aide sur les performances pour le routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-799">Performance guidance for routing</span></span>

<span data-ttu-id="80ae9-800">La plupart des routages ont été mis à jour dans ASP.NET Core 3,0 pour améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="80ae9-800">Most of routing was updated in ASP.NET Core 3.0 to increase performance.</span></span>

<span data-ttu-id="80ae9-801">Quand une application présente des problèmes de performances, le routage est souvent soupçonné de le résoudre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-801">When an app has performance problems, routing is often suspected as the problem.</span></span> <span data-ttu-id="80ae9-802">La raison pour laquelle le routage est suspecté est que les infrastructures comme les contrôleurs et les Razor Pages rapportent le temps passé dans l’infrastructure dans leurs messages de journalisation.</span><span class="sxs-lookup"><span data-stu-id="80ae9-802">The reason routing is suspected is that frameworks like controllers and Razor Pages report the amount of time spent inside the framework in their logging messages.</span></span> <span data-ttu-id="80ae9-803">Lorsqu’il y a une différence importante entre l’heure indiquée par les contrôleurs et la durée totale de la demande :</span><span class="sxs-lookup"><span data-stu-id="80ae9-803">When there's a significant difference between the time reported by controllers and the total time of the request:</span></span>

* <span data-ttu-id="80ae9-804">Les développeurs éliminent leur code d’application comme source du problème.</span><span class="sxs-lookup"><span data-stu-id="80ae9-804">Developers eliminate their app code as the source of the problem.</span></span>
* <span data-ttu-id="80ae9-805">Il est courant de supposer que le routage est la cause.</span><span class="sxs-lookup"><span data-stu-id="80ae9-805">It's common to assume routing is the cause.</span></span>

<span data-ttu-id="80ae9-806">Le routage est testé sur les performances à l’aide de milliers de points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-806">Routing is performance tested using thousands of endpoints.</span></span> <span data-ttu-id="80ae9-807">Il est peu probable qu’une application typique rencontre un problème de performances tout simplement trop important.</span><span class="sxs-lookup"><span data-stu-id="80ae9-807">It's unlikely that a typical app will encounter a performance problem just by being too large.</span></span> <span data-ttu-id="80ae9-808">La cause la plus courante de la lenteur des performances de routage est généralement un intergiciel (middleware) personnalisé.</span><span class="sxs-lookup"><span data-stu-id="80ae9-808">The most common root cause of slow routing performance is usually a badly-behaving custom middleware.</span></span>

<span data-ttu-id="80ae9-809">L’exemple de code suivant illustre une technique de base pour réduire la source de délai :</span><span class="sxs-lookup"><span data-stu-id="80ae9-809">This following code sample demonstrates a basic technique for narrowing down the source of delay:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupDelay.cs?name=snippet)]

<span data-ttu-id="80ae9-810">Pour le routage temporel :</span><span class="sxs-lookup"><span data-stu-id="80ae9-810">To time routing:</span></span>

* <span data-ttu-id="80ae9-811">Entrelacer chaque intergiciel à l’aide d’une copie de l’intergiciel (middleware) de minuterie indiquée dans le code précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-811">Interleave each middleware with a copy of the timing middleware shown in the preceding code.</span></span>
* <span data-ttu-id="80ae9-812">Ajoutez un identificateur unique pour corréler les données de temporisation avec le code.</span><span class="sxs-lookup"><span data-stu-id="80ae9-812">Add a unique identifier to correlate the timing data with the code.</span></span>

<span data-ttu-id="80ae9-813">Il s’agit d’une méthode de base pour réduire le délai lorsqu’il est significatif, par exemple, plus que `10ms`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-813">This is a basic way to narrow down the delay when it's significant, for example, more than `10ms`.</span></span>  <span data-ttu-id="80ae9-814">Le fait de soustraire des `Time 2` du `Time 1` signale le temps passé dans l’intergiciel (middleware) `UseRouting`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-814">Subtracting `Time 2` from `Time 1` reports the time spent inside the `UseRouting` middleware.</span></span>

<span data-ttu-id="80ae9-815">Le code suivant utilise une approche plus compacte pour le code de minutage précédent :</span><span class="sxs-lookup"><span data-stu-id="80ae9-815">The following code uses a more compact approach to the preceding timing code:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupSW.cs?name=snippetSW)]

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupSW.cs?name=snippet)]

### <a name="potentially-expensive-routing-features"></a><span data-ttu-id="80ae9-816">Fonctionnalités de routage potentiellement onéreuses</span><span class="sxs-lookup"><span data-stu-id="80ae9-816">Potentially expensive routing features</span></span>

<span data-ttu-id="80ae9-817">La liste suivante fournit des informations sur les fonctionnalités de routage relativement coûteuses par rapport aux modèles de routage de base :</span><span class="sxs-lookup"><span data-stu-id="80ae9-817">The following list provides some insight into routing features that are relatively expensive compared with basic route templates:</span></span>

* <span data-ttu-id="80ae9-818">Expressions régulières : il est possible d’écrire des expressions régulières complexes ou ayant une durée d’exécution longue avec une petite quantité d’entrée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-818">Regular expressions: It's possible to write regular expressions that are complex, or have long running time with a small amount of input.</span></span>

* <span data-ttu-id="80ae9-819">Segments complexes (`{x}-{y}-{z}`) :</span><span class="sxs-lookup"><span data-stu-id="80ae9-819">Complex segments (`{x}-{y}-{z}`):</span></span> 
  * <span data-ttu-id="80ae9-820">Sont beaucoup plus coûteuses que l’analyse d’un segment de chemin d’accès d’URL normal.</span><span class="sxs-lookup"><span data-stu-id="80ae9-820">Are significantly more expensive than parsing a regular URL path segment.</span></span>
  * <span data-ttu-id="80ae9-821">Entraîne l’allocation de beaucoup plus de sous-chaînes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-821">Result in many more substrings being allocated.</span></span>
  * <span data-ttu-id="80ae9-822">La logique de segment complexe n’a pas été mise à jour dans ASP.NET Core mise à jour des performances de routage 3,0.</span><span class="sxs-lookup"><span data-stu-id="80ae9-822">The complex segment logic was not updated in ASP.NET Core 3.0 routing performance update.</span></span>

* <span data-ttu-id="80ae9-823">Accès synchrone aux données : de nombreuses applications complexes ont accès aux bases de données dans le cadre de leur routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-823">Synchronous data access: Many complex apps have database access as part of their routing.</span></span> <span data-ttu-id="80ae9-824">ASP.NET Core 2,2 et le routage antérieur peuvent ne pas fournir les points d’extensibilité appropriés pour prendre en charge le routage de l’accès aux bases de données.</span><span class="sxs-lookup"><span data-stu-id="80ae9-824">ASP.NET Core 2.2 and earlier routing might not provide the right extensibility points to support database access routing.</span></span> <span data-ttu-id="80ae9-825">Par exemple, <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>et <xref:Microsoft.AspNetCore.Mvc.ActionConstraints.IActionConstraint> sont synchrones.</span><span class="sxs-lookup"><span data-stu-id="80ae9-825">For example, <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, and <xref:Microsoft.AspNetCore.Mvc.ActionConstraints.IActionConstraint> are synchronous.</span></span> <span data-ttu-id="80ae9-826">Les points d’extensibilité tels que <xref:Microsoft.AspNetCore.Routing.MatcherPolicy> et <xref:Microsoft.AspNetCore.Routing.EndpointSelectorContext> sont asynchrones.</span><span class="sxs-lookup"><span data-stu-id="80ae9-826">Extensibility points such as <xref:Microsoft.AspNetCore.Routing.MatcherPolicy> and <xref:Microsoft.AspNetCore.Routing.EndpointSelectorContext> are asynchronous.</span></span>

## <a name="guidance-for-library-authors"></a><span data-ttu-id="80ae9-827">Conseils pour les auteurs de bibliothèque</span><span class="sxs-lookup"><span data-stu-id="80ae9-827">Guidance for library authors</span></span>

<span data-ttu-id="80ae9-828">Cette section contient des conseils pour les auteurs de bibliothèque qui créent sur le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-828">This section contains guidance for library authors building on top of routing.</span></span> <span data-ttu-id="80ae9-829">Ces détails visent à garantir que les développeurs d’applications ont une bonne expérience en utilisant des bibliothèques et des infrastructures qui étendent le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-829">These details are intended to ensure that app developers have a good experience using libraries and frameworks that extend routing.</span></span>

### <a name="define-endpoints"></a><span data-ttu-id="80ae9-830">Définir des points de terminaison</span><span class="sxs-lookup"><span data-stu-id="80ae9-830">Define endpoints</span></span>

<span data-ttu-id="80ae9-831">Pour créer une infrastructure qui utilise le routage pour la correspondance d’URL, commencez par définir une expérience utilisateur qui s’appuie sur <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-831">To create a framework that uses routing for URL matching, start by defining a user experience that builds on top of <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>

<span data-ttu-id="80ae9-832">**Effectuez** une génération par-dessus <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-832">**DO** build on top of <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span></span> <span data-ttu-id="80ae9-833">Cela permet aux utilisateurs de composer votre infrastructure avec d’autres fonctionnalités de ASP.NET Core sans confusion.</span><span class="sxs-lookup"><span data-stu-id="80ae9-833">This allows users to compose your framework with other ASP.NET Core features without confusion.</span></span> <span data-ttu-id="80ae9-834">Chaque modèle de ASP.NET Core comprend le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-834">Every ASP.NET Core template includes routing.</span></span> <span data-ttu-id="80ae9-835">Supposons que le routage est présent et familier pour les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="80ae9-835">Assume routing is present and familiar for users.</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...);

    endpoints.MapHealthChecks("/healthz");
});
```

<span data-ttu-id="80ae9-836">**Retournez un** type concret sealed à partir d’un appel à `MapMyFramework(...)` qui implémente <xref:Microsoft.AspNetCore.Builder.IEndpointConventionBuilder>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-836">**DO** return a sealed concrete type from a call to `MapMyFramework(...)` that implements <xref:Microsoft.AspNetCore.Builder.IEndpointConventionBuilder>.</span></span> <span data-ttu-id="80ae9-837">La plupart des méthodes d' `Map...` d’infrastructure suivent ce modèle.</span><span class="sxs-lookup"><span data-stu-id="80ae9-837">Most framework `Map...` methods follow this pattern.</span></span> <span data-ttu-id="80ae9-838">Interface `IEndpointConventionBuilder` :</span><span class="sxs-lookup"><span data-stu-id="80ae9-838">The `IEndpointConventionBuilder` interface:</span></span>

* <span data-ttu-id="80ae9-839">Permet la composition des métadonnées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-839">Allows composability of metadata.</span></span>
* <span data-ttu-id="80ae9-840">Est ciblé par une variété de méthodes d’extension.</span><span class="sxs-lookup"><span data-stu-id="80ae9-840">Is targeted by a variety of extension methods.</span></span>

<span data-ttu-id="80ae9-841">La déclaration de votre propre type vous permet d’ajouter vos propres fonctionnalités propres au Framework au générateur.</span><span class="sxs-lookup"><span data-stu-id="80ae9-841">Declaring your own type allows you to add your own framework-specific functionality to the builder.</span></span> <span data-ttu-id="80ae9-842">Il est OK d’inclure dans un wrapper un générateur déclaré par l’infrastructure et de transférer des appels vers celui-ci.</span><span class="sxs-lookup"><span data-stu-id="80ae9-842">It's ok to wrap a framework-declared builder and forward calls to it.</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...).RequrireAuthorization()
                                 .WithMyFrameworkFeature(awesome: true);

    endpoints.MapHealthChecks("/healthz");
});
```

<span data-ttu-id="80ae9-843">**Envisagez** d’écrire vos propres <xref:Microsoft.AspNetCore.Routing.EndpointDataSource>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-843">**CONSIDER** writing your own <xref:Microsoft.AspNetCore.Routing.EndpointDataSource>.</span></span> <span data-ttu-id="80ae9-844">`EndpointDataSource` est la primitive de bas niveau pour la déclaration et la mise à jour d’une collection de points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-844">`EndpointDataSource` is the low-level primitive for declaring and updating a collection of endpoints.</span></span> <span data-ttu-id="80ae9-845">`EndpointDataSource` est une API puissante utilisée par les contrôleurs et les Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="80ae9-845">`EndpointDataSource` is a powerful API used by controllers and Razor Pages.</span></span>

<span data-ttu-id="80ae9-846">Les tests de routage ont un [exemple de base](https://github.com/aspnet/AspNetCore/blob/master/src/Http/Routing/test/testassets/RoutingSandbox/Framework/FrameworkEndpointDataSource.cs#L17) d’une source de données qui ne met pas à jour.</span><span class="sxs-lookup"><span data-stu-id="80ae9-846">The routing tests have a [basic example](https://github.com/aspnet/AspNetCore/blob/master/src/Http/Routing/test/testassets/RoutingSandbox/Framework/FrameworkEndpointDataSource.cs#L17) of a non-updating data source.</span></span>

<span data-ttu-id="80ae9-847">**N’essayez pas** d’inscrire un `EndpointDataSource` par défaut.</span><span class="sxs-lookup"><span data-stu-id="80ae9-847">**DO NOT** attempt to register an `EndpointDataSource` by default.</span></span> <span data-ttu-id="80ae9-848">Obligez les utilisateurs à inscrire votre infrastructure dans <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-848">Require users to register your framework in <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span> <span data-ttu-id="80ae9-849">La philosophie du routage est que rien n’est inclus par défaut, et que `UseEndpoints` est l’endroit où inscrire des points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-849">The philosophy of routing is that nothing is included by default, and that `UseEndpoints` is the place to register endpoints.</span></span>

### <a name="creating-routing-integrated-middleware"></a><span data-ttu-id="80ae9-850">Création d’un intergiciel (middleware) intégré au routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-850">Creating routing-integrated middleware</span></span>

<span data-ttu-id="80ae9-851">**Envisagez** de définir des types de métadonnées en tant qu’interface.</span><span class="sxs-lookup"><span data-stu-id="80ae9-851">**CONSIDER** defining metadata types as an interface.</span></span>

<span data-ttu-id="80ae9-852">**Vous pouvez** utiliser les types de métadonnées en tant qu’attribut sur les classes et les méthodes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-852">**DO** make it possible to use metadata types as an attribute on classes and methods.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/ICoolMetadata.cs?name=snippet2)]

<span data-ttu-id="80ae9-853">Les infrastructures comme les contrôleurs et les Razor Pages prennent en charge l’application des attributs de métadonnées aux types et aux méthodes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-853">Frameworks like controllers and Razor Pages support applying metadata attributes to types and methods.</span></span> <span data-ttu-id="80ae9-854">Si vous déclarez des types de métadonnées :</span><span class="sxs-lookup"><span data-stu-id="80ae9-854">If you declare metadata types:</span></span>

* <span data-ttu-id="80ae9-855">Rendez-les accessibles en tant qu' [attributs](/dotnet/csharp/programming-guide/concepts/attributes/).</span><span class="sxs-lookup"><span data-stu-id="80ae9-855">Make them accessible as [attributes](/dotnet/csharp/programming-guide/concepts/attributes/).</span></span>
* <span data-ttu-id="80ae9-856">La plupart des utilisateurs sont habitués à appliquer des attributs.</span><span class="sxs-lookup"><span data-stu-id="80ae9-856">Most users are familiar with applying attributes.</span></span>

<span data-ttu-id="80ae9-857">La déclaration d’un type de métadonnées en tant qu’interface ajoute une autre couche de flexibilité :</span><span class="sxs-lookup"><span data-stu-id="80ae9-857">Declaring a metadata type as an interface adds another layer of flexibility:</span></span>

* <span data-ttu-id="80ae9-858">Les interfaces sont composables.</span><span class="sxs-lookup"><span data-stu-id="80ae9-858">Interfaces are composable.</span></span>
* <span data-ttu-id="80ae9-859">Les développeurs peuvent déclarer leurs propres types qui combinent plusieurs stratégies.</span><span class="sxs-lookup"><span data-stu-id="80ae9-859">Developers can declare their own types that combine multiple policies.</span></span>

<span data-ttu-id="80ae9-860">**Vous pouvez** remplacer les métadonnées, comme illustré dans l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="80ae9-860">**DO** make it possible to override metadata, as shown in the following example:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/ICoolMetadata.cs?name=snippet)]

<span data-ttu-id="80ae9-861">La meilleure façon de suivre ces instructions consiste à éviter de définir des **métadonnées de marqueur**:</span><span class="sxs-lookup"><span data-stu-id="80ae9-861">The best way to follow these guidelines is to avoid defining **marker metadata**:</span></span>

* <span data-ttu-id="80ae9-862">Ne cherchez pas simplement la présence d’un type de métadonnées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-862">Don't just look for the presence of a metadata type.</span></span>
* <span data-ttu-id="80ae9-863">Définissez une propriété sur les métadonnées et vérifiez la propriété.</span><span class="sxs-lookup"><span data-stu-id="80ae9-863">Define a property on the metadata and check the property.</span></span>

<span data-ttu-id="80ae9-864">La collection de métadonnées est triée et prend en charge le remplacement par priorité.</span><span class="sxs-lookup"><span data-stu-id="80ae9-864">The metadata collection is ordered and supports overriding by priority.</span></span> <span data-ttu-id="80ae9-865">Dans le cas de contrôleurs, les métadonnées de la méthode d’action sont plus spécifiques.</span><span class="sxs-lookup"><span data-stu-id="80ae9-865">In the case of controllers, metadata on the action method is most specific.</span></span>

<span data-ttu-id="80ae9-866">Faites en sorte que les intergiciels (middleware) **soient** utiles avec et sans routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-866">**DO** make middleware useful with and without routing.</span></span>

```csharp
app.UseRouting();

app.UseAuthorization(new AuthorizationPolicy() { ... });

app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...).RequrireAuthorization();
});
```

<span data-ttu-id="80ae9-867">À titre d’exemple, considérez l’intergiciel (middleware) `UseAuthorization`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-867">As an example of this guideline, consider the `UseAuthorization` middleware.</span></span> <span data-ttu-id="80ae9-868">L’intergiciel d’autorisation vous permet de passer une stratégie de secours.</span><span class="sxs-lookup"><span data-stu-id="80ae9-868">The authorization middleware allows you to pass in a fallback policy.</span></span> <!-- shown where?  (shown here) --> <span data-ttu-id="80ae9-869">La stratégie de secours, si elle est spécifiée, s’applique aux deux :</span><span class="sxs-lookup"><span data-stu-id="80ae9-869">The fallback policy, if specified, applies to both:</span></span>

* <span data-ttu-id="80ae9-870">Points de terminaison sans stratégie spécifiée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-870">Endpoints without a specified policy.</span></span>
* <span data-ttu-id="80ae9-871">Les demandes qui ne correspondent pas à un point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-871">Requests that don't match an endpoint.</span></span>

<span data-ttu-id="80ae9-872">Cela rend l’intergiciel (middleware) d’autorisation utile en dehors du contexte du routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-872">This makes the authorization middleware useful outside of the context of routing.</span></span> <span data-ttu-id="80ae9-873">L’intergiciel d’autorisation peut être utilisé pour la programmation d’intergiciel (middleware) classique.</span><span class="sxs-lookup"><span data-stu-id="80ae9-873">The authorization middleware can be used for traditional middleware programming.</span></span>

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="80ae9-874">Le routage est chargé de mapper les URI de requête aux points de terminaison et de distribuer les demandes entrantes à ces points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-874">Routing is responsible for mapping request URIs to endpoints and dispatching incoming requests to those endpoints.</span></span> <span data-ttu-id="80ae9-875">Les routes sont définies dans l’application et configurées au démarrage de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-875">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="80ae9-876">Une route peut éventuellement extraire des valeurs de l’URL contenue dans la requête, et ces valeurs peuvent ensuite être utilisées pour le traitement de la requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-876">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="80ae9-877">À l’aide des informations de routage de l’application, le routage est également en mesure de générer des URL qui mappent aux points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-877">Using route information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="80ae9-878">Pour utiliser les scénarios de routage les plus récents dans ASP.NET Core 2.2, spécifiez la [version de compatibilité](xref:mvc/compatibility-version) à l’inscription des services MVC dans `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="80ae9-878">To use the latest routing scenarios in ASP.NET Core 2.2, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="80ae9-879">L’option <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> détermine si le routage doit utiliser en interne une logique basée sur les points de terminaison ou la logique basée sur <xref:Microsoft.AspNetCore.Routing.IRouter> d’ASP.NET Core 2.1 ou antérieur.</span><span class="sxs-lookup"><span data-stu-id="80ae9-879">The <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> option determines if routing should internally use endpoint-based logic or the <xref:Microsoft.AspNetCore.Routing.IRouter>-based logic of ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="80ae9-880">Quand la version de compatibilité est définie sur 2.2 ou ultérieur, la valeur par défaut est `true`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-880">When the compatibility version is set to 2.2 or later, the default value is `true`.</span></span> <span data-ttu-id="80ae9-881">Définissez la valeur sur `false` pour utiliser la logique de routage antérieure :</span><span class="sxs-lookup"><span data-stu-id="80ae9-881">Set the value to `false` to use the prior routing logic:</span></span>

```csharp
// Use the routing logic of ASP.NET Core 2.1 or earlier:
services.AddMvc(options => options.EnableEndpointRouting = false)
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="80ae9-882">Pour plus d’informations sur le routage basé sur <xref:Microsoft.AspNetCore.Routing.IRouter>, consultez la [version ASP.NET Core 2.1 de cette rubrique](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="80ae9-882">For more information on <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, see the [ASP.NET Core 2.1 version of this topic](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="80ae9-883">Ce document traite du routage ASP.NET Core de bas niveau.</span><span class="sxs-lookup"><span data-stu-id="80ae9-883">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="80ae9-884">Pour plus d’informations sur le routage ASP.NET Core MVC, consultez <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-884">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="80ae9-885">Pour plus d’informations sur les conventions de routage dans Razor Pages, consultez <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-885">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="80ae9-886">[Affichez ou téléchargez l’exemple de code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([procédure de téléchargement](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="80ae9-886">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="80ae9-887">Concepts de base du routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-887">Routing basics</span></span>

<span data-ttu-id="80ae9-888">La plupart des applications doivent choisir un schéma de routage de base et descriptif pour que les URL soient lisibles et explicites.</span><span class="sxs-lookup"><span data-stu-id="80ae9-888">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="80ae9-889">La route conventionnelle par défaut `{controller=Home}/{action=Index}/{id?}` :</span><span class="sxs-lookup"><span data-stu-id="80ae9-889">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="80ae9-890">Prend en charge un schéma de routage de base et descriptif.</span><span class="sxs-lookup"><span data-stu-id="80ae9-890">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="80ae9-891">Est un point de départ pratique pour les applications basées sur une interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="80ae9-891">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="80ae9-892">Les développeurs ajoutent généralement des itinéraires succincts supplémentaires aux zones à trafic élevé d’une application dans des situations particulières en utilisant le [routage d’attributs](xref:mvc/controllers/routing#attribute-routing) ou des itinéraires conventionnels dédiés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-892">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span> <span data-ttu-id="80ae9-893">Les exemples de situations spécialisées incluent les points de terminaison de blog et de commerce électronique.</span><span class="sxs-lookup"><span data-stu-id="80ae9-893">Specialized situations examples include, blog and ecommerce endpoints.</span></span>

<span data-ttu-id="80ae9-894">Les API web doivent utiliser le routage d’attributs pour modéliser les fonctionnalités de l’application sous la forme d’un ensemble de ressources dans lequel les opérations sont représentées par des verbes HTTP.</span><span class="sxs-lookup"><span data-stu-id="80ae9-894">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="80ae9-895">Cela signifie que de nombreuses opérations, par exemple, obtenir et poster, sur la même ressource logique utilisent la même URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-895">This means that many operations, for example, GET, and POST, on the same logical resource use the same URL.</span></span> <span data-ttu-id="80ae9-896">Le routage d’attributs fournit le niveau de contrôle nécessaire pour concevoir avec soin la disposition des points de terminaison publics d’une API.</span><span class="sxs-lookup"><span data-stu-id="80ae9-896">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="80ae9-897">Les applications Razor Pages utilisent le routage conventionnel par défaut pour délivrer des ressources nommées dans le dossier *Pages* d’une application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-897">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="80ae9-898">Des conventions supplémentaires sont disponibles : elles vous permettent de personnaliser le comportement de routage de Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="80ae9-898">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="80ae9-899">Pour plus d’informations, consultez <xref:razor-pages/index> et <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-899">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="80ae9-900">La prise en charge de la génération d’URL permet de développer l’application sans coder en dur les URL pour lier l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-900">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="80ae9-901">Cette prise en charge permet de commencer avec une configuration de routage de base, puis de modifier les routes une fois que la disposition des ressources de l’application est déterminée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-901">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="80ae9-902">Le routage utilise des *points de terminaison* (`Endpoint`) pour représenter les points de terminaison logiques dans une application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-902">Routing uses *endpoints* (`Endpoint`) to represent logical endpoints in an app.</span></span>

<span data-ttu-id="80ae9-903">Un point de terminaison définit un délégué pour traiter les requêtes et une collection de métadonnées arbitraires.</span><span class="sxs-lookup"><span data-stu-id="80ae9-903">An endpoint defines a delegate to process requests and a collection of arbitrary metadata.</span></span> <span data-ttu-id="80ae9-904">Les métadonnées sont utilisées pour implémenter des problèmes transversaux basés sur des stratégies et une configuration attachées à chaque point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-904">The metadata is used implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="80ae9-905">Le système de routage a les caractéristiques suivantes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-905">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="80ae9-906">Une syntaxe des modèles de route est utilisée pour définir des routes avec des paramètres de route tokenisés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-906">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="80ae9-907">La configuration de points de terminaison de style conventionnel et de style « attribut » est autorisée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-907">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="80ae9-908"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> est utilisé pour déterminer si un paramètre d’URL contient une valeur valide pour une contrainte de point de terminaison donné.</span><span class="sxs-lookup"><span data-stu-id="80ae9-908"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="80ae9-909">Les modèles d’application, comme MVC/Razor Pages, inscrivent tous leurs points de terminaison, qui ont une implémentation prévisible de scénarios de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-909">App models, such as MVC/Razor Pages, register all of their endpoints, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="80ae9-910">L’implémentation du routage prend des décisions de routage partout où vous le souhaitez dans le pipeline de middleware (intergiciel).</span><span class="sxs-lookup"><span data-stu-id="80ae9-910">The routing implementation makes routing decisions wherever desired in the middleware pipeline.</span></span>
* <span data-ttu-id="80ae9-911">Le middleware qui apparaît après un middleware de routage peut inspecter le résultat de la décision du middleware de routage quant au point de terminaison d’un URI de requête donné.</span><span class="sxs-lookup"><span data-stu-id="80ae9-911">Middleware that appears after a Routing Middleware can inspect the result of the Routing Middleware's endpoint decision for a given request URI.</span></span>
* <span data-ttu-id="80ae9-912">Il est possible d’énumérer tous les points de terminaison dans l’application n’importe où dans le pipeline de middleware.</span><span class="sxs-lookup"><span data-stu-id="80ae9-912">It's possible to enumerate all of the endpoints in the app anywhere in the middleware pipeline.</span></span>
* <span data-ttu-id="80ae9-913">Une application peut utiliser le routage pour générer des URL (par exemple pour la redirection ou pour des liens) en fonction des informations des points de terminaison et éviter ainsi les URL codées en dur, ce qui facilite la maintenance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-913">An app can use routing to generate URLs (for example, for redirection or links) based on endpoint information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="80ae9-914">La génération d’URL est basée sur des adresses, qui prennent en charge l’extensibilité arbitraire :</span><span class="sxs-lookup"><span data-stu-id="80ae9-914">URL generation is based on addresses, which support arbitrary extensibility:</span></span>

  * <span data-ttu-id="80ae9-915">L’API du générateur de liens (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) peut être résolue partout avec [l’injection de dépendances](xref:fundamentals/dependency-injection) pour générer des URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-915">The Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) can be resolved anywhere using [dependency injection (DI)](xref:fundamentals/dependency-injection) to generate URLs.</span></span>
  * <span data-ttu-id="80ae9-916">Quand l’API du générateur de liens n’est pas disponible via l’injection de dépendances, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offre des méthodes pour générer des URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-916">Where the Link Generator API isn't available via DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

> [!NOTE]
> <span data-ttu-id="80ae9-917">Avec la publication du routage des points de terminaison dans ASP.NET Core 2.2, la liaison de point de terminaison est limitée aux actions et aux pages MVC/Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="80ae9-917">With the release of endpoint routing in ASP.NET Core 2.2, endpoint linking is limited to MVC/Razor Pages actions and pages.</span></span> <span data-ttu-id="80ae9-918">Les expansions des fonctionnalités de liaison de point de terminaison sont prévues pour les versions futures.</span><span class="sxs-lookup"><span data-stu-id="80ae9-918">The expansions of endpoint-linking capabilities is planned for future releases.</span></span>

<span data-ttu-id="80ae9-919">Le routage est connecté au pipeline de [l’intergiciel (middleware)](xref:fundamentals/middleware/index) par la classe <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-919">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="80ae9-920">[ASP.NET Core MVC](xref:mvc/overview) ajoute le routage au pipeline de middleware dans le cadre de sa configuration, et gère le routage dans les applications MVC et Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="80ae9-920">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="80ae9-921">Pour découvrir comment utiliser le routage en tant que composant autonome, consultez la section [Utiliser le middleware de routage](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="80ae9-921">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="80ae9-922">Correspondance d’URL</span><span class="sxs-lookup"><span data-stu-id="80ae9-922">URL matching</span></span>

<span data-ttu-id="80ae9-923">La correspondance d’URL est le processus par lequel le routage distribue une requête entrante à un *point de terminaison*.</span><span class="sxs-lookup"><span data-stu-id="80ae9-923">URL matching is the process by which routing dispatches an incoming request to an *endpoint*.</span></span> <span data-ttu-id="80ae9-924">Ce processus est basé sur des données présentes dans le chemin de l’URL, mais il peut être étendu pour prendre en compte toutes les données de la requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-924">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="80ae9-925">La possibilité de distribuer des requêtes à des gestionnaires distincts est essentielle pour adapter la taille et la complexité d’une application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-925">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="80ae9-926">Le système de routage dans le routage de point de terminaison est responsable de toutes les décisions de distribution.</span><span class="sxs-lookup"><span data-stu-id="80ae9-926">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="80ae9-927">Comme le middleware applique des stratégies basées sur le point de terminaison sélectionné, il est important que les décisions susceptibles d’affecter la distribution ou l’application des stratégies de sécurité soient prises au sein du système de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-927">Since the middleware applies policies based on the selected endpoint, it's important that any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

<span data-ttu-id="80ae9-928">Quand le délégué du point de terminaison est exécuté, les propriétés de [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) sont définies sur des valeurs appropriées en fonction du traitement des requêtes effectué jusqu’à présent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-928">When the endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="80ae9-929">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) est un dictionnaire de *valeurs de route* produites à partir de la route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-929">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="80ae9-930">Ces valeurs sont généralement déterminées en décomposant l’URL en jetons. Elles peuvent être utilisées pour accepter l’entrée d’utilisateur ou pour prendre d’autres décisions relatives à la distribution à l’intérieur de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-930">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="80ae9-931">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) est un conteneur de propriétés des données supplémentaires associées à la route mise en correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-931">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="80ae9-932">Les <xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> sont fournis pour prendre en charge l’association de données d’état à chaque route, de façon que l’application puisse prendre des décisions en fonction de la route avec laquelle la correspondance a été établie.</span><span class="sxs-lookup"><span data-stu-id="80ae9-932"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="80ae9-933">Ces valeurs sont définies par le développeur et n’affectent **pas** le comportement du routage de quelque manière que ce soit.</span><span class="sxs-lookup"><span data-stu-id="80ae9-933">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="80ae9-934">De plus, les valeurs dissimulées dans [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) peuvent être de n’importe quel type, contrairement aux valeurs [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), qui doivent être convertibles en chaînes et à partir de chaînes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-934">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="80ae9-935">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) est une liste des routes qui ont participé à la mise en correspondance correcte de la requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-935">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="80ae9-936">Les routes peuvent être imbriquées les unes dans les autres.</span><span class="sxs-lookup"><span data-stu-id="80ae9-936">Routes can be nested inside of one another.</span></span> <span data-ttu-id="80ae9-937">La propriété <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> reflète le chemin à travers l’arborescence logique des routes qui ont généré une correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-937">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="80ae9-938">En général le premier élément de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> est la collection de routes et il doit être utilisé pour la génération d’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-938">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="80ae9-939">Le dernier élément de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> est le gestionnaire de routage avec lequel la correspondance a été établie.</span><span class="sxs-lookup"><span data-stu-id="80ae9-939">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation-with-linkgenerator"></a><span data-ttu-id="80ae9-940">Génération d’URL avec LinkGenerator</span><span class="sxs-lookup"><span data-stu-id="80ae9-940">URL generation with LinkGenerator</span></span>

<span data-ttu-id="80ae9-941">La génération d’URL est le processus par lequel le routage peut créer un chemin d’URL basé sur un ensemble de valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-941">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="80ae9-942">Ceci permet une séparation logique entre vos points de terminaison et les URL qui y accèdent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-942">This allows for a logical separation between your endpoints and the URLs that access them.</span></span>

<span data-ttu-id="80ae9-943">Le routage des points de terminaison inclut l’API de générateur de liens (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span><span class="sxs-lookup"><span data-stu-id="80ae9-943">Endpoint routing includes the Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span></span> <span data-ttu-id="80ae9-944"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> est un service singleton qui peut être récupéré à partir de [di](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="80ae9-944"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is a singleton service that can be retrieved from [DI](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="80ae9-945">L’API peut être utilisée en dehors du contexte d’une requête en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="80ae9-945">The API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="80ae9-946">Le <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> de MVC et les scénarios qui s’appuient sur <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, comme les [Tag Helpers](xref:mvc/views/tag-helpers/intro), les helpers HTML et les [résultats d’action](xref:mvc/controllers/actions), utilisent le générateur de liens pour fournir les fonctionnalités de création de liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-946">MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the link generator to provide link generating capabilities.</span></span>

<span data-ttu-id="80ae9-947">Le générateur de liens est basé sur le concept d’une *adresse* et de *schémas d’adresse*.</span><span class="sxs-lookup"><span data-stu-id="80ae9-947">The link generator is backed by the concept of an *address* and *address schemes*.</span></span> <span data-ttu-id="80ae9-948">Un schéma d’adresse est un moyen de déterminer les points de terminaison à prendre en compte pour la génération de liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-948">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="80ae9-949">Par exemple, les scénarios de nom de route et de valeurs de route que connaissent bien nombre d’utilisateurs dans les MVC/Razor Pages sont implémentés en tant que schémas d’adresse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-949">For example, the route name and route values scenarios many users are familiar with from MVC/Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="80ae9-950">Le générateur de liens peut lier à des actions et à des pages MVC/Razor Pages via les méthodes d’extension suivantes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-950">The link generator can link to MVC/Razor Pages actions and pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="80ae9-951">Une surcharge de ces méthodes accepte des arguments qui incluent le `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-951">An overload of these methods accepts arguments that include the `HttpContext`.</span></span> <span data-ttu-id="80ae9-952">Ces méthodes sont fonctionnellement équivalentes à `Url.Action` et à `Url.Page`, mais elles offrent davantage de flexibilité et d’options.</span><span class="sxs-lookup"><span data-stu-id="80ae9-952">These methods are functionally equivalent to `Url.Action` and `Url.Page` but offer additional flexibility and options.</span></span>

<span data-ttu-id="80ae9-953">Les méthodes `GetPath*` sont les plus proches de `Url.Action` et de `Url.Page` en ce qu’elles génèrent un URI contenant un chemin absolu.</span><span class="sxs-lookup"><span data-stu-id="80ae9-953">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page` in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="80ae9-954">Les méthodes `GetUri*` génèrent toujours un URI absolu contenant un schéma et un hôte.</span><span class="sxs-lookup"><span data-stu-id="80ae9-954">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="80ae9-955">Les méthodes qui acceptent un `HttpContext` génèrent un URI dans le contexte de la requête en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="80ae9-955">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="80ae9-956">Les valeurs de route ambiante, le chemin de base d’URL, le schéma et l’hôte de la requête en cours d’exécution sont utilisés, sauf s’ils sont remplacés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-956">The ambient route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="80ae9-957"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> est appelé avec une adresse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-957"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="80ae9-958">La génération d’un URI se fait en deux étapes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-958">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="80ae9-959">Une adresse est liée à une liste de points de terminaison qui correspondent à l’adresse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-959">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="80ae9-960">Le `RoutePattern` de chaque point de terminaison est évalué jusqu’à ce qu’un modèle de route correspondant aux valeurs fournies soit trouvé.</span><span class="sxs-lookup"><span data-stu-id="80ae9-960">Each endpoint's `RoutePattern` is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="80ae9-961">Le résultat obtenu est combiné avec d’autres parties de l’URI fournies par le générateur de liens, puis il est retourné.</span><span class="sxs-lookup"><span data-stu-id="80ae9-961">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="80ae9-962">Les méthodes fournies par <xref:Microsoft.AspNetCore.Routing.LinkGenerator> prennent en charge des fonctionnalités de génération de liens standard pour n’importe quel type d’adresse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-962">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="80ae9-963">La façon la plus pratique d’utiliser le générateur de liens est de le faire via des méthodes d’extension qui effectuent des opérations pour un type d’adresse spécifique.</span><span class="sxs-lookup"><span data-stu-id="80ae9-963">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type.</span></span>

| <span data-ttu-id="80ae9-964">Méthode d'extension</span><span class="sxs-lookup"><span data-stu-id="80ae9-964">Extension Method</span></span>   | <span data-ttu-id="80ae9-965">Description</span><span class="sxs-lookup"><span data-stu-id="80ae9-965">Description</span></span>                                                         |
| ------------------ | ------------------------------------------------------------------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="80ae9-966">Génère un URI avec un chemin absolu basé sur les valeurs fournies.</span><span class="sxs-lookup"><span data-stu-id="80ae9-966">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="80ae9-967">Génère un URI absolu basé sur les valeurs fournies.</span><span class="sxs-lookup"><span data-stu-id="80ae9-967">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="80ae9-968">Faites attention aux implications suivantes de l’appel de méthodes <xref:Microsoft.AspNetCore.Routing.LinkGenerator> :</span><span class="sxs-lookup"><span data-stu-id="80ae9-968">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="80ae9-969">Utilisez les méthodes d’extension `GetUri*` avec précaution dans une configuration d’application qui ne valide pas l’en-tête `Host` des requêtes entrantes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-969">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="80ae9-970">Si l’en-tête `Host` des requêtes entrantes n’est pas validé, l’entrée de requête non approuvée peut être renvoyée au client dans les URI d’une page/vue.</span><span class="sxs-lookup"><span data-stu-id="80ae9-970">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view/page.</span></span> <span data-ttu-id="80ae9-971">Nous recommandons que toutes les applications de production configurent leur serveur pour qu’il valide l’en-tête `Host` par rapport à des valeurs valides connues.</span><span class="sxs-lookup"><span data-stu-id="80ae9-971">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="80ae9-972">Utilisez <xref:Microsoft.AspNetCore.Routing.LinkGenerator> avec précaution dans le middleware en combinaison avec `Map` ou `MapWhen`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-972">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="80ae9-973">`Map*` modifie le chemin de base de la requête en cours d’exécution, ce qui affecte la sortie de la génération de liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-973">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="80ae9-974">Toutes les API <xref:Microsoft.AspNetCore.Routing.LinkGenerator> permettent la spécification d’un chemin de base.</span><span class="sxs-lookup"><span data-stu-id="80ae9-974">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="80ae9-975">Spécifiez toujours un chemin de base vide pour annuler l’effet de `Map*` sur la génération de liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-975">Always specify an empty base path to undo `Map*`'s affect on link generation.</span></span>

## <a name="differences-from-earlier-versions-of-routing"></a><span data-ttu-id="80ae9-976">Différences par rapport aux versions précédentes du routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-976">Differences from earlier versions of routing</span></span>

<span data-ttu-id="80ae9-977">Il existe quelques différences entre le routage de points de terminaison d’ASP.NET Core 2.2 ou ultérieur et celui des versions antérieures d’ASP.NET Core :</span><span class="sxs-lookup"><span data-stu-id="80ae9-977">A few differences exist between endpoint routing in ASP.NET Core 2.2 or later and earlier versions of routing in ASP.NET Core:</span></span>

* <span data-ttu-id="80ae9-978">Le système de routage de points de terminaison ne prend pas en charge l’extensibilité basée sur <xref:Microsoft.AspNetCore.Routing.IRouter>, notamment l’héritage de <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-978">The endpoint routing system doesn't support <xref:Microsoft.AspNetCore.Routing.IRouter>-based extensibility, including inheriting from <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>

* <span data-ttu-id="80ae9-979">Le routage de points de terminaison ne prend pas en charge [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span><span class="sxs-lookup"><span data-stu-id="80ae9-979">Endpoint routing doesn't support [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span></span> <span data-ttu-id="80ae9-980">Utilisez la [version de compatibilité](xref:mvc/compatibility-version) 2.1 (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) pour continuer à utiliser le shim de compatibilité.</span><span class="sxs-lookup"><span data-stu-id="80ae9-980">Use the 2.1 [compatibility version](xref:mvc/compatibility-version) (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) to continue using the compatibility shim.</span></span>

* <span data-ttu-id="80ae9-981">Le routage de points de terminaison a un comportement différent pour la casse des URI générés lors de l’utilisation de routes conventionnelles.</span><span class="sxs-lookup"><span data-stu-id="80ae9-981">Endpoint Routing has different behavior for the casing of generated URIs when using conventional routes.</span></span>

  <span data-ttu-id="80ae9-982">Considérez le modèle de route par défaut suivant :</span><span class="sxs-lookup"><span data-stu-id="80ae9-982">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="80ae9-983">Supposez que vous générez un lien vers une action avec la route suivante :</span><span class="sxs-lookup"><span data-stu-id="80ae9-983">Suppose you generate a link to an action using the following route:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "blog", new { id = 17, });
  ```

  <span data-ttu-id="80ae9-984">Avec le routage basé sur <xref:Microsoft.AspNetCore.Routing.IRouter>, ce code génère un URI `/blog/ReadPost/17`, qui respecte la casse de la valeur de la route fournie.</span><span class="sxs-lookup"><span data-stu-id="80ae9-984">With <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, this code generates a URI of `/blog/ReadPost/17`, which respects the casing of the provided route value.</span></span> <span data-ttu-id="80ae9-985">Le routage de points de terminaison dans ASP.NET Core 2.2 ou ultérieur produit `/Blog/ReadPost/17` (« Blog » commence par une majuscule).</span><span class="sxs-lookup"><span data-stu-id="80ae9-985">Endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` ("Blog" is capitalized).</span></span> <span data-ttu-id="80ae9-986">Le routage de points de terminaison fournit l’interface `IOutboundParameterTransformer`, qui peut être utilisée pour personnaliser ce comportement de façon globale ou pour appliquer des conventions différentes pour le mappage d’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-986">Endpoint routing provides the `IOutboundParameterTransformer` interface that can be used to customize this behavior globally or to apply different conventions for mapping URLs.</span></span>

  <span data-ttu-id="80ae9-987">Pour plus d’informations, consultez la section [Informations de référence sur les transformateurs de paramètre](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-987">For more information, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

* <span data-ttu-id="80ae9-988">La génération de liens utilisée par MVC/Razor Pages avec des routes conventionnelles se comporte différemment quand vous tentez de lier à un contrôleur/action ou à une page qui n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="80ae9-988">Link Generation used by MVC/Razor Pages with conventional routes behaves differently when attempting to link to an controller/action or page that doesn't exist.</span></span>

  <span data-ttu-id="80ae9-989">Considérez le modèle de route par défaut suivant :</span><span class="sxs-lookup"><span data-stu-id="80ae9-989">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="80ae9-990">Supposez que vous générez un lien vers une action en utilisant le modèle par défaut avec ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="80ae9-990">Suppose you generate a link to an action using the default template with the following:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "Blog", new { id = 17, });
  ```

  <span data-ttu-id="80ae9-991">Avec le routage basé sur `IRouter`, le résultat est toujours `/Blog/ReadPost/17`, même si le `BlogController` n’existe pas ou n’a pas de méthode d’action `ReadPost`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-991">With `IRouter`-based routing, the result is always `/Blog/ReadPost/17`, even if the `BlogController` doesn't exist or doesn't have a `ReadPost` action method.</span></span> <span data-ttu-id="80ae9-992">Comme prévu, le routage de points de terminaison dans ASP.NET Core 2.2 ou ultérieur produit `/Blog/ReadPost/17` si la méthode d’action existe.</span><span class="sxs-lookup"><span data-stu-id="80ae9-992">As expected, endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` if the action method exists.</span></span> <span data-ttu-id="80ae9-993">*Cependant, le routage de points de terminaison produit une chaîne vide si l’action n’existe pas.*</span><span class="sxs-lookup"><span data-stu-id="80ae9-993">*However, endpoint routing produces an empty string if the action doesn't exist.*</span></span> <span data-ttu-id="80ae9-994">Sur le plan conceptuel, le routage de points de terminaison ne fait pas l’hypothèse que le point de terminaison existe si l’action n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="80ae9-994">Conceptually, endpoint routing doesn't assume that the endpoint exists if the action doesn't exist.</span></span>

* <span data-ttu-id="80ae9-995">L’*algorithme d’invalidation de valeur ambiante* de la génération de liens se comporte différemment quand il est utilisé avec le routage de points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="80ae9-995">The link generation *ambient value invalidation algorithm* behaves differently when used with endpoint routing.</span></span>

  <span data-ttu-id="80ae9-996">L’*invalidation de valeur ambiante* est l’algorithme qui décide quelles valeurs de route provenant de la requête en cours d’exécution (les valeurs ambiantes) peuvent être utilisées dans les opérations de génération de liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-996">*Ambient value invalidation* is the algorithm that decides which route values from the currently executing request (the ambient values) can be used in link generation operations.</span></span> <span data-ttu-id="80ae9-997">Le routage conventionnel a toujours invalidé les valeurs de route supplémentaires lors de la liaison à une action différente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-997">Conventional routing always invalidated extra route values when linking to a different action.</span></span> <span data-ttu-id="80ae9-998">Le routage d’attributs n’a pas ce comportement avant la publication d’ASP.NET Core 2.2.</span><span class="sxs-lookup"><span data-stu-id="80ae9-998">Attribute routing didn't have this behavior prior to the release of ASP.NET Core 2.2.</span></span> <span data-ttu-id="80ae9-999">Dans les versions antérieures d’ASP.NET Core, les liens vers une autre action utilisant les mêmes noms de paramètre de route provoquaient des erreurs de génération de liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-999">In earlier versions of ASP.NET Core, links to another action that use the same route parameter names resulted in link generation errors.</span></span> <span data-ttu-id="80ae9-1000">Dans ASP.NET Core 2.2 ou ultérieur, les deux formes de routage invalident les valeurs lors de la liaison vers une autre action.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1000">In ASP.NET Core 2.2 or later, both forms of routing invalidate values when linking to another action.</span></span>

  <span data-ttu-id="80ae9-1001">Considérez l’exemple suivant dans ASP.NET Core 2.1 ou antérieur.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1001">Consider the following example in ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="80ae9-1002">Lors de la liaison à une autre action (ou une autre page), les valeurs de route peuvent être réutilisées de façon non souhaitée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1002">When linking to another action (or another page), route values can be reused in undesirable ways.</span></span>

  <span data-ttu-id="80ae9-1003">Dans */Pages/Store/Product.cshtml* :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1003">In */Pages/Store/Product.cshtml*:</span></span>

  ```cshtml
  @page "{id}"
  @Url.Page("/Login")
  ```

  <span data-ttu-id="80ae9-1004">Dans */Pages/Login.cshtml* :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1004">In */Pages/Login.cshtml*:</span></span>

  ```cshtml
  @page "{id?}"
  ```

  <span data-ttu-id="80ae9-1005">Si l’URI est `/Store/Product/18` dans ASP.NET Core 2.1 ou antérieur, le lien généré sur la page Store/Info par `@Url.Page("/Login")` est `/Login/18`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1005">If the URI is `/Store/Product/18` in ASP.NET Core 2.1 or earlier, the link generated on the Store/Info page by `@Url.Page("/Login")` is `/Login/18`.</span></span> <span data-ttu-id="80ae9-1006">La valeur 18 pour `id` est réutilisée, même si la destination du lien est une partie entièrement différente de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1006">The `id` value of 18 is reused, even though the link destination is different part of the app entirely.</span></span> <span data-ttu-id="80ae9-1007">La valeur de route pour `id` dans le contexte de la page `/Login` est probablement une valeur d’ID utilisateur, et non pas une valeur d’ID de produit de magasin.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1007">The `id` route value in the context of the `/Login` page is probably a user ID value, not a store product ID value.</span></span>

  <span data-ttu-id="80ae9-1008">Dans le routage de points de terminaison avec ASP.NET Core 2.2 ou ultérieur, le résultat est `/Login`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1008">In endpoint routing with ASP.NET Core 2.2 or later, the result is `/Login`.</span></span> <span data-ttu-id="80ae9-1009">Les valeurs ambiantes ne sont pas réutilisées quand la destination liée est une action ou une page différente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1009">Ambient values aren't reused when the linked destination is a different action or page.</span></span>

* <span data-ttu-id="80ae9-1010">Syntaxe des paramètres de route avec aller-retour : les barres obliques ne sont pas encodées lors de l’utilisation d’une syntaxe de paramètre passe-partout avec double astérisque (`**`).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1010">Round-tripping route parameter syntax: Forward slashes aren't encoded when using a double-asterisk (`**`) catch-all parameter syntax.</span></span>

  <span data-ttu-id="80ae9-1011">Pendant la génération de liens, le système de routage encode la valeur capturée dans un paramètre passe-partout avec double astérisque (`**`) (par exemple `{**myparametername}`) sans les barres obliques.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1011">During link generation, the routing system encodes the value captured in a double-asterisk (`**`) catch-all parameter (for example, `{**myparametername}`) except the forward slashes.</span></span> <span data-ttu-id="80ae9-1012">Le passe-partout avec double astérisque est pris en charge avec le routage basé sur `IRouter` dans ASP.NET Core 2.2 ou ultérieur.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1012">The double-asterisk catch-all is supported with `IRouter`-based routing in ASP.NET Core 2.2 or later.</span></span>

  <span data-ttu-id="80ae9-1013">La syntaxe de paramètre passe-partout avec un seul astérisque dans les versions antérieures d’ASP.NET Core (`{*myparametername}`) reste prise en charge, et les barres obliques sont encodées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1013">The single asterisk catch-all parameter syntax in prior versions of ASP.NET Core (`{*myparametername}`) remains supported, and forward slashes are encoded.</span></span>

  | <span data-ttu-id="80ae9-1014">Routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-1014">Route</span></span>              | <span data-ttu-id="80ae9-1015">Lien généré avec</span><span class="sxs-lookup"><span data-stu-id="80ae9-1015">Link generated with</span></span><br>`Url.Action(new { category = "admin/products" })`&hellip; |
  | ------------------ | --------------------------------------------------------------------- |
  | `/search/{*page}`  | <span data-ttu-id="80ae9-1016">`/search/admin%2Fproducts` (la barre oblique est encodée)</span><span class="sxs-lookup"><span data-stu-id="80ae9-1016">`/search/admin%2Fproducts` (the forward slash is encoded)</span></span>             |
  | `/search/{**page}` | `/search/admin/products`                                              |

### <a name="middleware-example"></a><span data-ttu-id="80ae9-1017">Exemple de middleware</span><span class="sxs-lookup"><span data-stu-id="80ae9-1017">Middleware example</span></span>

<span data-ttu-id="80ae9-1018">Dans l’exemple suivant, un middleware utilise l’API <xref:Microsoft.AspNetCore.Routing.LinkGenerator> pour créer un lien vers une méthode d’action qui liste les produits d’un magasin.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1018">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create link to an action method that lists store products.</span></span> <span data-ttu-id="80ae9-1019">L’utilisation du générateur de liens en l’injectant dans une classe et en appelant `GenerateLink` est disponible pour n’importe quelle classe dans une application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1019">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app.</span></span>

```csharp
using Microsoft.AspNetCore.Routing;

public class ProductsLinkMiddleware
{
    private readonly LinkGenerator _linkGenerator;

    public ProductsLinkMiddleware(RequestDelegate next, LinkGenerator linkGenerator)
    {
        _linkGenerator = linkGenerator;
    }

    public async Task InvokeAsync(HttpContext httpContext)
    {
        var url = _linkGenerator.GetPathByAction("ListProducts", "Store");

        httpContext.Response.ContentType = "text/plain";

        await httpContext.Response.WriteAsync($"Go to {url} to see our products.");
    }
}
```

### <a name="create-routes"></a><span data-ttu-id="80ae9-1020">Créer des itinéraires</span><span class="sxs-lookup"><span data-stu-id="80ae9-1020">Create routes</span></span>

<span data-ttu-id="80ae9-1021">La plupart des applications créent des routes en appelant <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> ou l’une des méthodes d’extension similaires définies sur <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1021">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="80ae9-1022">Toutes les méthodes d’extension de <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> créent une instance de <xref:Microsoft.AspNetCore.Routing.Route> et l’ajoutent à la collection de routes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1022">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="80ae9-1023"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> n’accepte pas de paramètre de gestionnaire de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1023"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="80ae9-1024"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> ajoute uniquement des routes gérées par <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1024"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="80ae9-1025">Pour plus d’informations sur le routage dans MVC, consultez <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1025">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="80ae9-1026">L’exemple de code suivant est un exemple d’appel à <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> utilisé par une définition de route ASP.NET Core MVC classique :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1026">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="80ae9-1027">Ce modèle établit une correspondance avec un chemin d’URL et extrait les valeurs de route .</span><span class="sxs-lookup"><span data-stu-id="80ae9-1027">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="80ae9-1028">Par exemple, le chemin `/Products/Details/17` génère les valeurs de route suivantes : `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1028">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="80ae9-1029">Les valeurs de route sont déterminées en divisant le chemin d’URL en segments et en mettant en correspondance chaque segment avec le nom des *paramètres de routage* dans le modèle de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1029">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="80ae9-1030">Les paramètres de routage sont nommés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1030">Route parameters are named.</span></span> <span data-ttu-id="80ae9-1031">Vous définissez des paramètres en plaçant leur nom entre des accolades `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1031">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="80ae9-1032">Le modèle précédent peut également mettre en correspondance le chemin d’URL `/` et produire les valeurs `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1032">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="80ae9-1033">Cela s’explique par le fait que les paramètres de routage `{controller}` et `{action}` ont des valeurs par défaut et que le paramètre de routage `id` est facultatif.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1033">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="80ae9-1034">Un signe égal (`=`) suivi d’une valeur après le nom du paramètre de routage définit une valeur par défaut pour le paramètre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1034">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="80ae9-1035">Un point d’interrogation (`?`) après le nom du paramètre de routage définit un paramètre facultatif.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1035">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="80ae9-1036">Les paramètres de routage ayant une valeur par défaut produisent *toujours* une valeur de routage quand la route correspond.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1036">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="80ae9-1037">Les paramètres facultatifs ne produisent pas de valeur de route s’il n’y a pas de segment de chemin d’URL correspondant.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1037">Optional parameters don't produce a route value if there is no corresponding URL path segment.</span></span> <span data-ttu-id="80ae9-1038">Pour obtenir une description complète des scénarios et de la syntaxe des modèles de routage, consultez la section [Informations de référence sur les modèles de routage](#route-template-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1038">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="80ae9-1039">Dans l’exemple suivant, la définition du paramètre de route `{id:int}` définit une [contrainte de route](#route-constraint-reference) pour le paramètre de route `id` :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1039">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="80ae9-1040">Ce modèle établit une correspondance avec un chemin d’URL comme `/Products/Details/17`, mais pas `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1040">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="80ae9-1041">Les contraintes de routage implémentent <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> et inspectent les valeurs de route pour les vérifier.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1041">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="80ae9-1042">Dans cet exemple, la valeur de route `id` doit être convertible en entier.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1042">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="80ae9-1043">Pour obtenir une explication des contraintes de route fournies par le framework, consultez [Informations de référence sur les contraintes de route](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1043">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="80ae9-1044">Des surcharges supplémentaires de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> acceptent des values pour `constraints`, `dataTokens` et `defaults`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1044">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="80ae9-1045">L’utilisation classique de ces paramètres consiste à passer un objet typé anonymement, où les noms des propriétés du type anonyme correspondent aux noms de paramètre de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1045">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="80ae9-1046">Les exemples de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> suivants créent des routes équivalentes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1046">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="80ae9-1047">La syntaxe inline pour la définition des contraintes et des valeurs par défaut peut être pratique pour les routes simples.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1047">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="80ae9-1048">Cependant, certains scénarios, comme les jetons de données, ne sont pas pris en charge par la syntaxe inline.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1048">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="80ae9-1049">L’exemple suivant montre quelques autres scénarios :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1049">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{**article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="80ae9-1050">Le modèle précédent établit une correspondance avec un chemin d’URL comme `/Blog/All-About-Routing/Introduction` et extrait les valeurs `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1050">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="80ae9-1051">Les valeurs de route par défaut pour `controller` et `action` sont produites par la route, même s’il n’existe aucun paramètre de routage correspondant dans le modèle.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1051">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="80ae9-1052">Il est possible de spécifier des valeurs par défaut dans le modèle de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1052">Default values can be specified in the route template.</span></span> <span data-ttu-id="80ae9-1053">Le paramètre de route `article` est défini comme *passe-partout*  par la présence d’un double astérisque (`**`) avant le nom du paramètre de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1053">The `article` route parameter is defined as a *catch-all* by the appearance of an double asterisk (`**`) before the route parameter name.</span></span> <span data-ttu-id="80ae9-1054">Les paramètres de routage fourre-tout capturent le reste du chemin d’URL et peuvent également établir une correspondance avec la chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1054">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="80ae9-1055">L’exemple suivant ajoute des contraintes de route et des jetons de données :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1055">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="80ae9-1056">Le modèle précédent établit une correspondance avec un chemin d’URL comme `/en-US/Products/5`, et extrait les valeurs `{ controller = Products, action = Details, id = 5 }` et les jetons de données `{ locale = en-US }`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1056">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Jetons Windows de variables locales](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="80ae9-1058">Génération d’URL de classe de route</span><span class="sxs-lookup"><span data-stu-id="80ae9-1058">Route class URL generation</span></span>

<span data-ttu-id="80ae9-1059">La classe <xref:Microsoft.AspNetCore.Routing.Route> peut également effectuer une génération d’URL en combinant un ensemble de valeurs de route et son modèle de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1059">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="80ae9-1060">Il s’agit logiquement du processus inverse de la mise en correspondance du chemin d’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1060">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="80ae9-1061">Pour mieux comprendre la génération d’URL, imaginez l’URL que vous voulez générer, puis pensez à la façon dont un modèle de routage établirait une correspondance avec cette URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1061">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="80ae9-1062">Quelles valeurs seraient produites ?</span><span class="sxs-lookup"><span data-stu-id="80ae9-1062">What values would be produced?</span></span> <span data-ttu-id="80ae9-1063">Cela équivaut approximativement à la façon dont la génération d’URL fonctionne dans la classe <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1063">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="80ae9-1064">L’exemple suivant utilise une route par défaut ASP.NET Core MVC générale :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1064">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="80ae9-1065">Avec les valeurs de route `{ controller = Products, action = List }`, l’URL `/Products/List` est générée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1065">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="80ae9-1066">Les valeurs de route remplacent les paramètres de routage correspondant pour former le chemin d’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1066">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="80ae9-1067">Dans la mesure où `id` est un paramètre de route facultatif, l’URL est générée correctement sans valeur pour `id`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1067">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="80ae9-1068">Avec les valeurs de route `{ controller = Home, action = Index }`, l’URL `/` est générée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1068">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="80ae9-1069">Les valeurs de route fournies correspondent aux valeurs par défaut, et les segments correspondant aux valeurs par défaut peuvent être omis sans risque.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1069">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="80ae9-1070">Les deux URL générées effectuent un aller-retour avec la définition de route suivante (`/Home/Index` et `/`), et produisent les mêmes valeurs de route que celles utilisées pour générer l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1070">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="80ae9-1071">Pour générer des URL, une application utilisant ASP.NET Core MVC doit utiliser <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> au lieu d’effectuer un appel directement dans le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1071">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="80ae9-1072">Pour plus d’informations sur la génération d’URL, consultez la section [Informations de référence sur la génération d’URL](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1072">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="80ae9-1073">Utilisation du middleware de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-1073">Use Routing Middleware</span></span>

<span data-ttu-id="80ae9-1074">Référencez le [métapackage Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) dans le fichier projet de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1074">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="80ae9-1075">Ajoutez le routage au conteneur de service dans `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1075">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="80ae9-1076">Les routes doivent être configurées dans la méthode `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1076">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="80ae9-1077">L’exemple d’application utilise les API suivantes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1077">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="80ae9-1078"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; correspond uniquement aux requêtes HTTP.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1078"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="80ae9-1079">Le tableau suivant montre les réponses avec les URI donnés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1079">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="80ae9-1080">URI</span><span class="sxs-lookup"><span data-stu-id="80ae9-1080">URI</span></span>                    | <span data-ttu-id="80ae9-1081">response</span><span class="sxs-lookup"><span data-stu-id="80ae9-1081">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="80ae9-1082">Bonjour !</span><span class="sxs-lookup"><span data-stu-id="80ae9-1082">Hello!</span></span> <span data-ttu-id="80ae9-1083">Valeurs de route : [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="80ae9-1083">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="80ae9-1084">Bonjour !</span><span class="sxs-lookup"><span data-stu-id="80ae9-1084">Hello!</span></span> <span data-ttu-id="80ae9-1085">Valeurs de route : [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="80ae9-1085">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="80ae9-1086">Bonjour !</span><span class="sxs-lookup"><span data-stu-id="80ae9-1086">Hello!</span></span> <span data-ttu-id="80ae9-1087">Valeurs de route : [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="80ae9-1087">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="80ae9-1088">La requête passe à travers ceci, aucune correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1088">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="80ae9-1089">Hi, Joe!</span><span class="sxs-lookup"><span data-stu-id="80ae9-1089">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="80ae9-1090">La requête passe à travers ceci, correspondance seulement avec HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1090">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="80ae9-1091">La requête passe à travers ceci, aucune correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1091">The request falls through, no match.</span></span>              |

<span data-ttu-id="80ae9-1092">Le framework fournit un ensemble de méthodes d’extension pour la création de routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>) :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1092">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="80ae9-1093">Les méthodes `Map[Verb]` utilisent des contraintes pour limiter la route au verbe HTTP dans le nom de la méthode.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1093">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="80ae9-1094">Par exemple, consultez <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> et <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1094">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="80ae9-1095">Informations de référence sur les modèles de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-1095">Route template reference</span></span>

<span data-ttu-id="80ae9-1096">Les jetons placés entre accolades (`{ ... }`) définissent des *paramètres de routage* qui sont liés si une correspondance est trouvée pour la route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1096">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="80ae9-1097">Vous pouvez définir plusieurs paramètres de routage dans un segment de route, mais ils doivent être séparés par une valeur littérale.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1097">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="80ae9-1098">Par exemple `{controller=Home}{action=Index}` n’est pas une route valide, car il n’y a aucune valeur littérale entre `{controller}` et `{action}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1098">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="80ae9-1099">Ces paramètres de routage doivent avoir un nom, et ils autorisent la spécification d’attributs supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1099">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="80ae9-1100">Un texte littéral autre que les paramètres de routage (par exemple, `{id}`) et le séparateur de chemin `/` doit correspondre au texte présent dans l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1100">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="80ae9-1101">La correspondance de texte ne respecte pas la casse et est basée sur la représentation décodée du chemin des URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1101">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="80ae9-1102">Pour mettre en correspondance un délimiteur de paramètre de route littéral (`{` ou `}`), placez-le dans une séquence d’échappement en répétant le caractère (`{{` ou `}}`).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1102">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="80ae9-1103">Les modèles d’URL qui tentent de capturer un nom de fichier avec une extension de fichier facultative doivent faire l’objet de considérations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1103">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="80ae9-1104">Prenez par exemple le modèle `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1104">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="80ae9-1105">Quand des valeurs existent à la fois pour `filename` et pour `ext`, les deux valeurs sont renseignées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1105">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="80ae9-1106">Si seule une valeur existe pour `filename` dans l’URL, une correspondance est trouvée pour la route, car le point final (`.`) est facultatif.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1106">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="80ae9-1107">Les URL suivantes correspondent à cette route :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1107">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="80ae9-1108">Vous pouvez utiliser un astérisque (`*`) ou un double astérisque (`**`) comme préfixe d’un paramètre de route à lier au reste de l’URI.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1108">You can use an asterisk (`*`) or double asterisk (`**`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="80ae9-1109">Ils sont appelés des paramètres *passe-partout*.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1109">These are called a *catch-all* parameters.</span></span> <span data-ttu-id="80ae9-1110">Par exemple, `blog/{**slug}` établit une correspondance avec n’importe quel URI commençant par `/blog` et suivi de n’importe quelle valeur, qui est affectée à la valeur de route `slug`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1110">For example, `blog/{**slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="80ae9-1111">Les paramètres fourre-tout peuvent également établir une correspondance avec la chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1111">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="80ae9-1112">Le paramètre fourre-tout place les caractères appropriés dans une séquence d’échappement lorsque la route est utilisée pour générer une URL, y compris les caractères de séparation de chemin (`/`).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1112">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="80ae9-1113">Par exemple, la route `foo/{*path}` avec les valeurs de route `{ path = "my/path" }` génère `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1113">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="80ae9-1114">Notez la barre oblique d’échappement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1114">Note the escaped forward slash.</span></span> <span data-ttu-id="80ae9-1115">Pour les séparateurs de chemin aller-retour, utilisez le préfixe de paramètre de routage `**`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1115">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="80ae9-1116">La route `foo/{**path}` avec `{ path = "my/path" }` génère `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1116">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="80ae9-1117">Les paramètres de route peuvent avoir des *valeurs par défaut*, désignées en spécifiant la valeur par défaut après le nom du paramètre, séparée par un signe égal (`=`).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1117">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="80ae9-1118">Par exemple, `{controller=Home}` définit `Home` comme valeur par défaut de `controller`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1118">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="80ae9-1119">La valeur par défaut est utilisée si aucune valeur n’est présente dans l’URL pour le paramètre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1119">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="80ae9-1120">Vous pouvez rendre facultatifs les paramètres de route en ajoutant un point d’interrogation (`?`) à la fin du nom du paramètre, comme dans `id?`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1120">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="80ae9-1121">La différence entre les valeurs facultatives et les paramètres de route par défaut est qu’un paramètre de route ayant une valeur par défaut produit toujours une valeur, tandis qu’un paramètre facultatif a une valeur seulement quand celle-ci est fournie par l’URL de requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1121">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="80ae9-1122">Les paramètres de route peuvent avoir des contraintes, qui doivent correspondre à la valeur de route liée à partir de l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1122">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="80ae9-1123">L’ajout d’un signe deux-points (`:`) et d’un nom de contrainte après le nom du paramètre de routage spécifie une *contrainte inline* sur un paramètre de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1123">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="80ae9-1124">Si la contrainte nécessite des arguments, ils sont fournis entre parenthèses (`(...)`) après le nom de la contrainte.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1124">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="80ae9-1125">Il est possible de spécifier plusieurs contraintes inline en ajoutant un autre signe deux-points (`:`) et le nom d’une autre contrainte.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1125">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="80ae9-1126">Le nom de la contrainte et les arguments sont passés au service <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> pour créer une instance de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> à utiliser dans le traitement des URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1126">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="80ae9-1127">Par exemple, le modèle de routage `blog/{article:minlength(10)}` spécifie une contrainte `minlength` avec l’argument `10`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1127">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="80ae9-1128">Pour plus d’informations sur les contraintes de route et pour obtenir la liste des contraintes fournies par le framework, consultez la section [Informations de référence sur les contraintes de route](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1128">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="80ae9-1129">Les paramètres de route peuvent également contenir des transformateurs de paramètre, qui transforment une valeur de paramètre lors de la génération des liens et de la mise en correspondance des actions et des pages avec les URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1129">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="80ae9-1130">À l’instar des contraintes, les transformateurs de paramètre peuvent être ajoutés inline à un paramètre de routage en ajoutant un signe deux-points (`:`) et le nom du transformateur après le nom du paramètre de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1130">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="80ae9-1131">Par exemple, le modèle de routage `blog/{article:slugify}` spécifie un transformateur `slugify`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1131">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="80ae9-1132">Pour plus d’informations sur les transformateurs de paramètre, consultez la section [Informations de référence sur les transformateurs de paramètre](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1132">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="80ae9-1133">Le tableau suivant montre des exemples de modèles de route et leur comportement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1133">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="80ae9-1134">Modèle de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-1134">Route Template</span></span>                           | <span data-ttu-id="80ae9-1135">Exemple d’URI en correspondance</span><span class="sxs-lookup"><span data-stu-id="80ae9-1135">Example Matching URI</span></span>    | <span data-ttu-id="80ae9-1136">URI de la requête&hellip;</span><span class="sxs-lookup"><span data-stu-id="80ae9-1136">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="80ae9-1137">Correspond seulement au chemin unique `/hello`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1137">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="80ae9-1138">Correspond à `Page` et le définit sur `Home`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1138">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="80ae9-1139">Correspond à `Page` et le définit sur `Contact`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1139">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="80ae9-1140">Mappe au contrôleur `Products` et à l’action `List`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1140">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="80ae9-1141">Mappe au contrôleur `Products` et à l’action `Details` (`id` défini sur 123).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1141">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="80ae9-1142">Mappe au contrôleur `Home` et à la méthode `Index` (`id` est ignoré).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1142">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="80ae9-1143">L’utilisation d’un modèle est généralement l’approche la plus simple pour le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1143">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="80ae9-1144">Il est également possible de spécifier des contraintes et des valeurs par défaut hors du modèle de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1144">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="80ae9-1145">Activez la [journalisation](xref:fundamentals/logging/index) pour voir comment les implémentations de routage intégrées, comme <xref:Microsoft.AspNetCore.Routing.Route>, établissent des correspondances avec les requêtes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1145">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="80ae9-1146">Noms de routage réservés</span><span class="sxs-lookup"><span data-stu-id="80ae9-1146">Reserved routing names</span></span>

<span data-ttu-id="80ae9-1147">Les mots clés suivants sont des noms réservés qui ne peuvent pas être utilisés comme paramètres ou noms de routage :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1147">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="80ae9-1148">Informations de référence sur les contraintes de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-1148">Route constraint reference</span></span>

<span data-ttu-id="80ae9-1149">Les contraintes de route s’exécutent quand une correspondance s’est produite pour l’URL entrante, et le chemin de l’URL est tokenisé en valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1149">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="80ae9-1150">En général, les contraintes de routage inspectent la valeur de route associée par le biais du modèle de routage, et créent une décision oui/non indiquant si la valeur est, ou non, acceptable.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1150">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="80ae9-1151">Certaines contraintes de routage utilisent des données hors de la valeur de route pour déterminer si la requête peut être routée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1151">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="80ae9-1152">Par exemple, <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> peut accepter ou rejeter une requête en fonction de son verbe HTTP.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1152">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="80ae9-1153">Les contraintes sont utilisées dans le routage des requêtes et la génération des liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1153">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="80ae9-1154">N’utilisez pas de contraintes pour la **validation des entrées**.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1154">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="80ae9-1155">Si des contraintes sont utilisées pour la **validation des entrées**, une entrée non valide génère une réponse *404 - Introuvable* au lieu d’une réponse *400 - Requête incorrecte* avec un message d’erreur approprié.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1155">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="80ae9-1156">Les contraintes de route sont utilisées pour **lever l’ambiguïté** entre des routes similaires, et non pas pour valider les entrées d’une route particulière.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1156">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="80ae9-1157">Le tableau suivant montre des exemples de contrainte de route et leur comportement attendu.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1157">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="80ae9-1158">contrainte</span><span class="sxs-lookup"><span data-stu-id="80ae9-1158">constraint</span></span> | <span data-ttu-id="80ae9-1159">Exemple</span><span class="sxs-lookup"><span data-stu-id="80ae9-1159">Example</span></span> | <span data-ttu-id="80ae9-1160">Exemples de correspondances</span><span class="sxs-lookup"><span data-stu-id="80ae9-1160">Example Matches</span></span> | <span data-ttu-id="80ae9-1161">Notes</span><span class="sxs-lookup"><span data-stu-id="80ae9-1161">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="80ae9-1162">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1162">`123456789`, `-123456789`</span></span> | <span data-ttu-id="80ae9-1163">Correspond à n’importe quel entier.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1163">Matches any integer.</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="80ae9-1164">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1164">`true`, `FALSE`</span></span> | <span data-ttu-id="80ae9-1165">Correspond à `true` ou’false.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1165">Matches `true` or \`false.</span></span> <span data-ttu-id="80ae9-1166">Non-respect de la casse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1166">Case-insensitive.</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="80ae9-1167">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1167">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="80ae9-1168">Correspond à une valeur de `DateTime` valide dans la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1168">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="80ae9-1169">Consultez l’avertissement précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1169">See  preceding warning.</span></span>|
| `decimal` | `{price:decimal}` | <span data-ttu-id="80ae9-1170">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1170">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="80ae9-1171">Correspond à une valeur de `decimal` valide dans la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1171">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="80ae9-1172">Consultez l’avertissement précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1172">See  preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="80ae9-1173">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1173">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="80ae9-1174">Correspond à une valeur de `double` valide dans la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1174">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="80ae9-1175">Consultez l’avertissement précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1175">See  preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="80ae9-1176">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1176">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="80ae9-1177">Correspond à une valeur de `float` valide dans la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1177">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="80ae9-1178">Consultez l’avertissement précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1178">See  preceding warning.</span></span>|
| `guid` | `{id:guid}` | <span data-ttu-id="80ae9-1179">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1179">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="80ae9-1180">Correspond à une valeur de `Guid` valide.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1180">Matches a valid `Guid` value.</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="80ae9-1181">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1181">`123456789`, `-123456789`</span></span> | <span data-ttu-id="80ae9-1182">Correspond à une valeur de `long` valide.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1182">Matches a valid `long` value.</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="80ae9-1183">La chaîne doit comporter au moins 4 caractères.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1183">String must be at least 4 characters.</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `MyFile` | <span data-ttu-id="80ae9-1184">La chaîne ne doit pas comporter plus de 8 caractères.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1184">String has maximum of 8 characters.</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="80ae9-1185">La chaîne doit contenir exactement 12 caractères.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1185">String must be exactly 12 characters long.</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="80ae9-1186">La chaîne doit être au moins égale à 8 et comporter jusqu’à 16 caractères.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1186">String must be at least 8 and has maximum of 16 characters.</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="80ae9-1187">La valeur entière doit être au moins égale à 18.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1187">Integer value must be at least 18.</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="80ae9-1188">Valeur entière maximale de 120.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1188">Integer value maximum of 120.</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="80ae9-1189">La valeur entière doit être au moins égale à 18 et 120.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1189">Integer value must be at least 18 and maximum of 120.</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="80ae9-1190">La chaîne doit comporter un ou plusieurs caractères alphabétiques `a`-`z`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1190">String must consist of one or more alphabetical characters `a`-`z`.</span></span>  <span data-ttu-id="80ae9-1191">Non-respect de la casse.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1191">Case-insensitive.</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="80ae9-1192">La chaîne doit correspondre à l’expression régulière.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1192">String must match the regular expression.</span></span> <span data-ttu-id="80ae9-1193">Consultez les conseils relatifs à la définition d’une expression régulière.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1193">See tips about defining a regular expression.</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="80ae9-1194">Permet d’appliquer qu’une valeur sans paramètre est présente pendant la génération de l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1194">Used to enforce that a non-parameter value is present during URL generation.</span></span> |

<span data-ttu-id="80ae9-1195">Il est possible d’appliquer plusieurs contraintes séparées par un point-virgule à un même paramètre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1195">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="80ae9-1196">Par exemple, la contrainte suivante limite un paramètre à une valeur entière supérieure ou égale à 1 :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1196">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="80ae9-1197">Les contraintes de routage qui vérifient que l’URL peut être convertie en type CLR (comme `int` ou `DateTime`) utilisent toujours la culture invariant.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1197">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="80ae9-1198">ces contraintes partent du principe que l’URL n’est pas localisable.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1198">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="80ae9-1199">Les contraintes de routage fournies par le framework ne modifient pas les valeurs stockées dans les valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1199">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="80ae9-1200">Toutes les valeurs de route analysées à partir de l’URL sont stockées sous forme de chaînes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1200">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="80ae9-1201">Par exemple, la contrainte `float` tente de convertir la valeur de route en valeur float, mais la valeur convertie est utilisée uniquement pour vérifier qu’elle peut être convertie en valeur float.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1201">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="80ae9-1202">Expressions régulières</span><span class="sxs-lookup"><span data-stu-id="80ae9-1202">Regular expressions</span></span>

<span data-ttu-id="80ae9-1203">Le framework ASP.NET Core ajoute `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` au constructeur d’expression régulière.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1203">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="80ae9-1204">Pour obtenir une description de ces membres, consultez <xref:System.Text.RegularExpressions.RegexOptions>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1204">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="80ae9-1205">Les expressions régulières utilisent des délimiteurs et des jetons similaires à ceux utilisés par C# le routage et le langage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1205">Regular expressions use delimiters and tokens similar to those used by routing and the C# language.</span></span> <span data-ttu-id="80ae9-1206">Les jetons d’expression régulière doivent être placés dans une séquence d’échappement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1206">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="80ae9-1207">Pour utiliser l’expression régulière `^\d{3}-\d{2}-\d{4}$` dans le routage :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1207">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing:</span></span>

* <span data-ttu-id="80ae9-1208">L’expression doit avoir la barre oblique inverse unique `\` caractères fournis dans la chaîne sous la forme d’une double barre oblique inverse `\\` caractères dans le code source.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1208">The expression must have the single backslash `\` characters provided in the string as double backslash `\\` characters in the source code.</span></span>
* <span data-ttu-id="80ae9-1209">L’expression régulière doit nous `\\` pour échapper le caractère d’échappement de la chaîne `\`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1209">The regular expression must us `\\` in order to escape the `\` string escape character.</span></span>
* <span data-ttu-id="80ae9-1210">L’expression régulière ne requiert pas de `\\` lors de l’utilisation de [littéraux de chaîne Verbatim](/dotnet/csharp/language-reference/keywords/string).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1210">The regular expression doesn't require `\\` when using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span>

<span data-ttu-id="80ae9-1211">Pour échapper les caractères de délimiteur de paramètre de routage `{`, `}``[`, `]`, doublez les caractères dans l’expression `{{`, `}`, `[[`, `]]`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1211">To escape routing parameter delimiter characters `{`, `}`, `[`, `]`, double the characters in the expression `{{`, `}`, `[[`, `]]`.</span></span> <span data-ttu-id="80ae9-1212">Le tableau suivant montre une expression régulière et la version échappée :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1212">The following table shows a regular expression and the escaped version:</span></span>

| <span data-ttu-id="80ae9-1213">Expression régulière</span><span class="sxs-lookup"><span data-stu-id="80ae9-1213">Regular Expression</span></span>    | <span data-ttu-id="80ae9-1214">Expression régulière en échappement</span><span class="sxs-lookup"><span data-stu-id="80ae9-1214">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="80ae9-1215">Les expressions régulières utilisées dans le routage commencent souvent par le signe insertion `^` caractère et correspondent à la position de départ de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1215">Regular expressions used in routing often start with the caret `^` character and match starting position of the string.</span></span> <span data-ttu-id="80ae9-1216">Les expressions se terminent souvent par le signe dollar `$` caractère et la fin de la correspondance de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1216">The expressions often end with the dollar sign `$` character and match end of the string.</span></span> <span data-ttu-id="80ae9-1217">Les caractères `^` et `$` garantissent que l’expression régulière établit une correspondance avec la totalité de la valeur du paramètre de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1217">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="80ae9-1218">Sans les caractères `^` et `$`, l’expression régulière peut correspondre à n’importe quelle sous-chaîne dans la chaîne, ce qui est souvent indésirable.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1218">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="80ae9-1219">Le tableau suivant contient des exemples et explique pourquoi ils établissent ou non une correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1219">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="80ae9-1220">Expression</span><span class="sxs-lookup"><span data-stu-id="80ae9-1220">Expression</span></span>   | <span data-ttu-id="80ae9-1221">String</span><span class="sxs-lookup"><span data-stu-id="80ae9-1221">String</span></span>    | <span data-ttu-id="80ae9-1222">Correspond</span><span class="sxs-lookup"><span data-stu-id="80ae9-1222">Match</span></span> | <span data-ttu-id="80ae9-1223">Commentaire</span><span class="sxs-lookup"><span data-stu-id="80ae9-1223">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="80ae9-1224">hello</span><span class="sxs-lookup"><span data-stu-id="80ae9-1224">hello</span></span>     | <span data-ttu-id="80ae9-1225">Oui</span><span class="sxs-lookup"><span data-stu-id="80ae9-1225">Yes</span></span>   | <span data-ttu-id="80ae9-1226">Correspondances de sous-chaînes</span><span class="sxs-lookup"><span data-stu-id="80ae9-1226">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="80ae9-1227">123abc456</span><span class="sxs-lookup"><span data-stu-id="80ae9-1227">123abc456</span></span> | <span data-ttu-id="80ae9-1228">Oui</span><span class="sxs-lookup"><span data-stu-id="80ae9-1228">Yes</span></span>   | <span data-ttu-id="80ae9-1229">Correspondances de sous-chaînes</span><span class="sxs-lookup"><span data-stu-id="80ae9-1229">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="80ae9-1230">mz</span><span class="sxs-lookup"><span data-stu-id="80ae9-1230">mz</span></span>        | <span data-ttu-id="80ae9-1231">Oui</span><span class="sxs-lookup"><span data-stu-id="80ae9-1231">Yes</span></span>   | <span data-ttu-id="80ae9-1232">Correspondance avec l’expression</span><span class="sxs-lookup"><span data-stu-id="80ae9-1232">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="80ae9-1233">MZ</span><span class="sxs-lookup"><span data-stu-id="80ae9-1233">MZ</span></span>        | <span data-ttu-id="80ae9-1234">Oui</span><span class="sxs-lookup"><span data-stu-id="80ae9-1234">Yes</span></span>   | <span data-ttu-id="80ae9-1235">Non-respect de la casse</span><span class="sxs-lookup"><span data-stu-id="80ae9-1235">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="80ae9-1236">hello</span><span class="sxs-lookup"><span data-stu-id="80ae9-1236">hello</span></span>     | <span data-ttu-id="80ae9-1237">Non</span><span class="sxs-lookup"><span data-stu-id="80ae9-1237">No</span></span>    | <span data-ttu-id="80ae9-1238">Voir `^` et `$` ci-dessus</span><span class="sxs-lookup"><span data-stu-id="80ae9-1238">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="80ae9-1239">123abc456</span><span class="sxs-lookup"><span data-stu-id="80ae9-1239">123abc456</span></span> | <span data-ttu-id="80ae9-1240">Non</span><span class="sxs-lookup"><span data-stu-id="80ae9-1240">No</span></span>    | <span data-ttu-id="80ae9-1241">Voir `^` et `$` ci-dessus</span><span class="sxs-lookup"><span data-stu-id="80ae9-1241">See `^` and `$` above</span></span> |

<span data-ttu-id="80ae9-1242">Pour plus d’informations sur la syntaxe des expressions régulières, consultez [Expressions régulières du .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1242">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="80ae9-1243">Pour contraindre un paramètre à un ensemble connu de valeurs possibles, utilisez une expression régulière.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1243">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="80ae9-1244">Par exemple, `{action:regex(^(list|get|create)$)}` établit une correspondance avec la valeur de route `action` uniquement pour `list`, `get` ou `create`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1244">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="80ae9-1245">Si elle est passée dans le dictionnaire de contraintes, la chaîne `^(list|get|create)$` est équivalente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1245">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="80ae9-1246">Les contraintes passées dans le dictionnaire de contraintes (c’est-à-dire qui ne sont pas inline dans un modèle) qui ne correspondent pas à l’une des contraintes connues sont également traitées comme des expressions régulières.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1246">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="80ae9-1247">Contraintes d’itinéraire personnalisées</span><span class="sxs-lookup"><span data-stu-id="80ae9-1247">Custom route constraints</span></span>

<span data-ttu-id="80ae9-1248">Outre les contraintes d’itinéraire intégré, les contraintes d’itinéraire personnalisé peuvent être créées en implémentant l’interface <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1248">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="80ae9-1249">L’interface <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> contient une méthode unique, `Match`, qui retourne `true` si la contrainte est satisfaite et `false` dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1249">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="80ae9-1250">Pour utiliser un <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> personnalisé, le type de contrainte d’itinéraire doit être inscrit avec le <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de l’application dans le conteneur de service de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1250">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="80ae9-1251">Un <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> est un dictionnaire qui mappe les clés de contrainte d’itinéraire aux implémentations <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> qui valident ces contraintes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1251">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="80ae9-1252">Le <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> d’une application peut être mis à jour dans `Startup.ConfigureServices` dans le cadre d’un appel [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) ou en configurant <xref:Microsoft.AspNetCore.Routing.RouteOptions> directement avec `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1252">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="80ae9-1253">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1253">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="80ae9-1254">La contrainte peut ensuite être appliquée aux itinéraires de la manière habituelle, en utilisant le nom spécifié lors de l’inscription du type de contrainte.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1254">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="80ae9-1255">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1255">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="parameter-transformer-reference"></a><span data-ttu-id="80ae9-1256">Informations de référence sur le transformateur de paramètre</span><span class="sxs-lookup"><span data-stu-id="80ae9-1256">Parameter transformer reference</span></span>

<span data-ttu-id="80ae9-1257">Transformateurs de paramètre :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1257">Parameter transformers:</span></span>

* <span data-ttu-id="80ae9-1258">Sont exécutés lors de la génération d’un lien pour un <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1258">Execute when generating a link for a <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>
* <span data-ttu-id="80ae9-1259">Implémentez `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1259">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="80ae9-1260">Sont configurés à l’aide de <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1260">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="80ae9-1261">Prennent la valeur de routage du paramètre et la convertissent en une nouvelle valeur de chaîne.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1261">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="80ae9-1262">Aboutissent à l’utilisation de la valeur transformée dans le lien généré.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1262">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="80ae9-1263">Par exemple, un transformateur de paramètre `slugify` personnalisé dans le modèle d’itinéraire `blog\{article:slugify}` avec `Url.Action(new { article = "MyTestArticle" })` génère `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1263">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="80ae9-1264">Pour utiliser un transformateur de paramètre dans un modèle d’itinéraire, configurez-le d’abord en utilisant <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> dans `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1264">To use a parameter transformer in a route pattern, configure it first using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddRouting(options =>
{
    // Replace the type and the name used to refer to it with your own
    // IOutboundParameterTransformer implementation
    options.ConstraintMap["slugify"] = typeof(SlugifyParameterTransformer);
});
```

<span data-ttu-id="80ae9-1265">Les transformateurs de paramètre sont utilisés par le framework pour transformer l’URI où un point de terminaison est résolu.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1265">Parameter transformers are used by the framework to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="80ae9-1266">Par exemple, ASP.NET Core MVC utilise des transformateurs de paramètre pour convertir la valeur de routage utilisée et la faire correspondre à un `area`, `controller`, `action` et `page`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1266">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="80ae9-1267">Avec la route précédente, l’action `SubscriptionManagementController.GetAll` est mise en correspondance avec l’URI `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1267">With the preceding route, the action `SubscriptionManagementController.GetAll` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="80ae9-1268">Un transformateur de paramètre ne modifie pas les valeurs de routage utilisées pour générer un lien.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1268">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="80ae9-1269">Par exemple, `Url.Action("GetAll", "SubscriptionManagement")` produit `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1269">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="80ae9-1270">ASP.NET Core fournit des conventions d’API pour l’utilisation des transformateurs de paramètre avec des routages générés :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1270">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="80ae9-1271">La convention de l’API `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` est fournie avec ASP.NET Core MVC.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1271">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="80ae9-1272">Cette convention applique un transformateur de paramètre spécifié à tous les routages d’attributs dans l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1272">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="80ae9-1273">Le transformateur de paramètre transforme les jetons de routage d’attribut quand ils sont remplacés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1273">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="80ae9-1274">Pour plus d’informations, consultez [Utiliser un transformateur de paramètre pour personnaliser le remplacement des jetons](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1274">For more information, see [Use a parameter transformer to customize token replacement](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="80ae9-1275">Razor Pages a la convention d’API `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1275">Razor Pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="80ae9-1276">Cette convention applique un transformateur de paramètre spécifié à toutes les pages Razor découvertes automatiquement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1276">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="80ae9-1277">Le transformateur de paramètre transforme les segments du nom de dossier et du nom de fichier des routes Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1277">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="80ae9-1278">Pour plus d’informations, consultez [Utiliser un transformateur de paramètre pour personnaliser les routages de pages](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1278">For more information, see [Use a parameter transformer to customize page routes](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="80ae9-1279">Informations de référence sur la génération d’URL</span><span class="sxs-lookup"><span data-stu-id="80ae9-1279">URL generation reference</span></span>

<span data-ttu-id="80ae9-1280">L’exemple suivant montre comment générer un lien vers une route selon un dictionnaire de valeurs de route et un <xref:Microsoft.AspNetCore.Routing.RouteCollection> données.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1280">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="80ae9-1281">Le <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> généré à la fin de l’exemple précédent est `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1281">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="80ae9-1282">Le dictionnaire fournit les valeurs de route `operation` et `id` du modèle « Suivi de package de route », `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1282">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="80ae9-1283">Pour plus d’informations, consultez l’exemple de code dans la section [Utilisation du middleware de routage](#use-routing-middleware) ou l’[exemple d’application](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1283">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="80ae9-1284">Le deuxième paramètre pour le constructeur <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> est une collection de *valeurs ambiantes*.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1284">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="80ae9-1285">Les valeurs ambiantes sont pratiques à utiliser, car elles limitent le nombre de valeurs qu’un développeur doit spécifier dans un contexte de requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1285">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="80ae9-1286">Les valeurs de route actuelles de la requête actuelle sont considérées comme des valeurs ambiantes pour la génération de liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1286">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="80ae9-1287">Dans l’action `About` de `HomeController` d’une application ASP.NET Core MVC, vous n’avez pas besoin de spécifier la valeur de route du contrôleur pour créer un lien vers l’action `Index` : la valeur ambiante de &mdash; est utilisée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1287">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="80ae9-1288">Les valeurs ambiantes qui ne correspondent pas à un paramètre sont ignorées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1288">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="80ae9-1289">Les valeurs ambiantes sont également ignorées quand une valeur explicitement fournie remplace la valeur ambiante.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1289">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="80ae9-1290">La mise en correspondance se produit de gauche à droite dans l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1290">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="80ae9-1291">Les valeurs fournies explicitement mais qui n’ont pas de correspondance avec un segment de la route sont ajoutées à la chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1291">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="80ae9-1292">Le tableau suivant présente le résultat en cas d’utilisation du modèle de routage `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1292">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="80ae9-1293">Valeurs ambiantes</span><span class="sxs-lookup"><span data-stu-id="80ae9-1293">Ambient Values</span></span>                     | <span data-ttu-id="80ae9-1294">Valeurs explicites</span><span class="sxs-lookup"><span data-stu-id="80ae9-1294">Explicit Values</span></span>                        | <span data-ttu-id="80ae9-1295">Résultats</span><span class="sxs-lookup"><span data-stu-id="80ae9-1295">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="80ae9-1296">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1296">controller = "Home"</span></span>                | <span data-ttu-id="80ae9-1297">action = "About"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1297">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="80ae9-1298">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1298">controller = "Home"</span></span>                | <span data-ttu-id="80ae9-1299">controller = "Order", action = "About"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1299">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="80ae9-1300">controller = "Home", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1300">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="80ae9-1301">action = "About"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1301">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="80ae9-1302">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1302">controller = "Home"</span></span>                | <span data-ttu-id="80ae9-1303">action = "About", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1303">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="80ae9-1304">Si une route a une valeur par défaut qui ne correspond pas à un paramètre et que cette valeur est explicitement fournie, elle doit correspondre à la valeur par défaut :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1304">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="80ae9-1305">La génération de liens génère un lien pour cette route seulement quand les valeurs correspondantes pour `controller` et pour `action` sont fournies.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1305">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="80ae9-1306">Segments complexes</span><span class="sxs-lookup"><span data-stu-id="80ae9-1306">Complex segments</span></span>

<span data-ttu-id="80ae9-1307">Les segments complexes (par exemple, `[Route("/x{token}y")]`) sont traités par la mise en correspondance des littéraux de droite à gauche de manière non gourmande.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1307">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="80ae9-1308">Consultez [ce code](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) pour obtenir une explication détaillée de la façon dont les segments complexes sont mis en correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1308">See [this code](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="80ae9-1309">[L’exemple de code](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) n’est pas utilisé par ASP.NET Core, mais il fournit une bonne explication des segments complexes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1309">The [code sample](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/dotnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="80ae9-1310">Le routage est responsable du mappage des URI des requêtes aux gestionnaires de routage et de la distribution des requêtes entrantes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1310">Routing is responsible for mapping request URIs to route handlers and dispatching an incoming requests.</span></span> <span data-ttu-id="80ae9-1311">Les routes sont définies dans l’application et configurées au démarrage de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1311">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="80ae9-1312">Une route peut éventuellement extraire des valeurs de l’URL contenue dans la requête, et ces valeurs peuvent ensuite être utilisées pour le traitement de la requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1312">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="80ae9-1313">En utilisant des routes configurées à partir de l’application, le routage est en mesure de générer des URL qui mappent à des gestionnaires de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1313">Using configured routes from the app, routing is able to generate URLs that map to route handlers.</span></span>

<span data-ttu-id="80ae9-1314">Pour utiliser les scénarios de routage les plus récents dans ASP.NET Core 2.1, spécifiez la [version de compatibilité](xref:mvc/compatibility-version) à l’inscription des services MVC dans `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1314">To use the latest routing scenarios in ASP.NET Core 2.1, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_1);
```

> [!IMPORTANT]
> <span data-ttu-id="80ae9-1315">Ce document traite du routage ASP.NET Core de bas niveau.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1315">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="80ae9-1316">Pour plus d’informations sur le routage ASP.NET Core MVC, consultez <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1316">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="80ae9-1317">Pour plus d’informations sur les conventions de routage dans Razor Pages, consultez <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1317">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="80ae9-1318">[Affichez ou téléchargez l’exemple de code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([procédure de téléchargement](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="80ae9-1318">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="80ae9-1319">Concepts de base du routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-1319">Routing basics</span></span>

<span data-ttu-id="80ae9-1320">La plupart des applications doivent choisir un schéma de routage de base et descriptif pour que les URL soient lisibles et explicites.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1320">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="80ae9-1321">La route conventionnelle par défaut `{controller=Home}/{action=Index}/{id?}` :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1321">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="80ae9-1322">Prend en charge un schéma de routage de base et descriptif.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1322">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="80ae9-1323">Est un point de départ pratique pour les applications basées sur une interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1323">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="80ae9-1324">Les développeurs ajoutent fréquemment des routes laconiques supplémentaires aux zones à trafic élevé de l’application dans des situations particulières (par exemple des points de terminaison de blog ou d’e-commerce) en utilisant le [routage d’attributs](xref:mvc/controllers/routing#attribute-routing) ou des routes conventionnelles dédiées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1324">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="80ae9-1325">Les API web doivent utiliser le routage d’attributs pour modéliser les fonctionnalités de l’application sous la forme d’un ensemble de ressources dans lequel les opérations sont représentées par des verbes HTTP.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1325">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="80ae9-1326">Cela signifie que plusieurs opérations (comme GET et POST) sur la même ressource logique utilisent la même URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1326">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="80ae9-1327">Le routage d’attributs fournit le niveau de contrôle nécessaire pour concevoir avec soin la disposition des points de terminaison publics d’une API.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1327">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="80ae9-1328">Les applications Razor Pages utilisent le routage conventionnel par défaut pour délivrer des ressources nommées dans le dossier *Pages* d’une application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1328">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="80ae9-1329">Des conventions supplémentaires sont disponibles : elles vous permettent de personnaliser le comportement de routage de Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1329">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="80ae9-1330">Pour plus d’informations, consultez <xref:razor-pages/index> et <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1330">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="80ae9-1331">La prise en charge de la génération d’URL permet de développer l’application sans coder en dur les URL pour lier l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1331">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="80ae9-1332">Cette prise en charge permet de commencer avec une configuration de routage de base, puis de modifier les routes une fois que la disposition des ressources de l’application est déterminée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1332">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="80ae9-1333">Le routage utilise des implémentations d’itinéraires de <xref:Microsoft.AspNetCore.Routing.IRouter> pour :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1333">Routing uses routes implementations of <xref:Microsoft.AspNetCore.Routing.IRouter> to:</span></span>

* <span data-ttu-id="80ae9-1334">Mapper les requêtes entrantes à des *gestionnaires de routage*.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1334">Map incoming requests to *route handlers*.</span></span>
* <span data-ttu-id="80ae9-1335">Générer les URL utilisées dans les réponses.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1335">Generate the URLs used in responses.</span></span>

<span data-ttu-id="80ae9-1336">Par défaut, une application a une seule collection de routes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1336">By default, an app has a single collection of routes.</span></span> <span data-ttu-id="80ae9-1337">Quand une requête arrive, les routes de la collection sont traitées dans l’ordre où elles se trouvent dans la collection.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1337">When a request arrives, the routes in the collection are processed in the order that they exist in the collection.</span></span> <span data-ttu-id="80ae9-1338">Le framework tente de mettre en correspondance l’URL d’une requête entrante avec une route de la collection en appelant la méthode <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> sur chaque route de la collection.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1338">The framework attempts to match an incoming request URL to a route in the collection by calling the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in the collection.</span></span> <span data-ttu-id="80ae9-1339">Une réponse peut utiliser le routage pour générer des URL (par exemple pour la redirection ou pour des liens) en fonction des informations des routes et éviter ainsi les URL codées en dur, ce qui facilite la maintenance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1339">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>

<span data-ttu-id="80ae9-1340">Le système de routage a les caractéristiques suivantes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1340">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="80ae9-1341">Une syntaxe des modèles de route est utilisée pour définir des routes avec des paramètres de route tokenisés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1341">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="80ae9-1342">La configuration de points de terminaison de style conventionnel et de style « attribut » est autorisée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1342">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="80ae9-1343"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> est utilisé pour déterminer si un paramètre d’URL contient une valeur valide pour une contrainte de point de terminaison donné.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1343"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="80ae9-1344">Les modèles d’application, comme MVC/Razor Pages, inscrivent toutes leurs routes, qui ont une implémentation prévisible de scénarios de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1344">App models, such as MVC/Razor Pages, register all of their routes, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="80ae9-1345">Une réponse peut utiliser le routage pour générer des URL (par exemple pour la redirection ou pour des liens) en fonction des informations des routes et éviter ainsi les URL codées en dur, ce qui facilite la maintenance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1345">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="80ae9-1346">La génération d’URL est basée sur des routes, qui prennent en charge l’extensibilité arbitraire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1346">URL generation is based on routes, which support arbitrary extensibility.</span></span> <span data-ttu-id="80ae9-1347"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offre des méthodes pour générer des URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1347"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>
<!-- fix [middleware](xref:fundamentals/middleware/index) -->
<span data-ttu-id="80ae9-1348">Le routage est connecté au pipeline `[middleware](xref:fundamentals/middleware/index)` par la classe <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1348">Routing is connected to the `[middleware](xref:fundamentals/middleware/index)` pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="80ae9-1349">[ASP.NET Core MVC](xref:mvc/overview) ajoute le routage au pipeline de middleware dans le cadre de sa configuration, et gère le routage dans les applications MVC et Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1349">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="80ae9-1350">Pour découvrir comment utiliser le routage en tant que composant autonome, consultez la section [Utiliser le middleware de routage](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1350">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="80ae9-1351">Correspondance d’URL</span><span class="sxs-lookup"><span data-stu-id="80ae9-1351">URL matching</span></span>

<span data-ttu-id="80ae9-1352">La correspondance d’URL est le processus par lequel le routage distribue une requête entrante à un *gestionnaire*.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1352">URL matching is the process by which routing dispatches an incoming request to a *handler*.</span></span> <span data-ttu-id="80ae9-1353">Ce processus est basé sur des données présentes dans le chemin de l’URL, mais il peut être étendu pour prendre en compte toutes les données de la requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1353">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="80ae9-1354">La possibilité de distribuer des requêtes à des gestionnaires distincts est essentielle pour adapter la taille et la complexité d’une application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1354">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="80ae9-1355">Les requêtes entrantes entrent dans <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, qui appelle la méthode <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> sur chaque route dans l’ordre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1355">Incoming requests enter the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, which calls the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in sequence.</span></span> <span data-ttu-id="80ae9-1356">L’instance <xref:Microsoft.AspNetCore.Routing.IRouter> détermine s’il faut *gérer* la requête en affectant à [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) un <xref:Microsoft.AspNetCore.Http.RequestDelegate> non null.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1356">The <xref:Microsoft.AspNetCore.Routing.IRouter> instance chooses whether to *handle* the request by setting the [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) to a non-null <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="80ae9-1357">Si une route définit un gestionnaire pour la requête, le traitement de la route s’arrête et le gestionnaire est appelé pour traiter la requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1357">If a route sets a handler for the request, route processing stops, and the handler is invoked to process the request.</span></span> <span data-ttu-id="80ae9-1358">Si aucun gestionnaire de routage n’est trouvé pour traiter la requête, le middleware passe la requête au middleware suivant dans le pipeline de requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1358">If no route handler is found to process the request, the middleware hands the request off to the next middleware in the request pipeline.</span></span>

<span data-ttu-id="80ae9-1359">L’entrée principale de <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> est le [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associé à la requête actuelle.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1359">The primary input to <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is the [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associated with the current request.</span></span> <span data-ttu-id="80ae9-1360">[RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) et [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) sont des sorties définies après la mise en correspondance d’une route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1360">The [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) and [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) are outputs set after a route is matched.</span></span>

<span data-ttu-id="80ae9-1361">Une correspondance qui appelle <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> définit également les propriétés de [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) sur des valeurs appropriées en fonction du traitement des requêtes effectué jusqu’à présent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1361">A match that calls <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> also sets the properties of the [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="80ae9-1362">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) est un dictionnaire de *valeurs de route* produites à partir de la route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1362">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="80ae9-1363">Ces valeurs sont généralement déterminées en décomposant l’URL en jetons. Elles peuvent être utilisées pour accepter l’entrée d’utilisateur ou pour prendre d’autres décisions relatives à la distribution à l’intérieur de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1363">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="80ae9-1364">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) est un conteneur de propriétés des données supplémentaires associées à la route mise en correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1364">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="80ae9-1365">Les <xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> sont fournis pour prendre en charge l’association de données d’état à chaque route, de façon que l’application puisse prendre des décisions en fonction de la route avec laquelle la correspondance a été établie.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1365"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="80ae9-1366">Ces valeurs sont définies par le développeur et n’affectent **pas** le comportement du routage de quelque manière que ce soit.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1366">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="80ae9-1367">De plus, les valeurs dissimulées dans [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) peuvent être de n’importe quel type, contrairement aux valeurs [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), qui doivent être convertibles en chaînes et à partir de chaînes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1367">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="80ae9-1368">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) est une liste des routes qui ont participé à la mise en correspondance correcte de la requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1368">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="80ae9-1369">Les routes peuvent être imbriquées les unes dans les autres.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1369">Routes can be nested inside of one another.</span></span> <span data-ttu-id="80ae9-1370">La propriété <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> reflète le chemin à travers l’arborescence logique des routes qui ont généré une correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1370">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="80ae9-1371">En général le premier élément de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> est la collection de routes et il doit être utilisé pour la génération d’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1371">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="80ae9-1372">Le dernier élément de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> est le gestionnaire de routage avec lequel la correspondance a été établie.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1372">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation"></a><span data-ttu-id="80ae9-1373">Génération d’URL</span><span class="sxs-lookup"><span data-stu-id="80ae9-1373">URL generation</span></span>

<span data-ttu-id="80ae9-1374">La génération d’URL est le processus par lequel le routage peut créer un chemin d’URL basé sur un ensemble de valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1374">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="80ae9-1375">Ceci permet une séparation logique entre les gestionnaires de routes et les URL qui y accèdent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1375">This allows for a logical separation between route handlers and the URLs that access them.</span></span>

<span data-ttu-id="80ae9-1376">La génération d’URL suit un processus itératif similaire, mais elle commence par un appel du code utilisateur ou de framework à la méthode <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> de la collection de routes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1376">URL generation follows a similar iterative process, but it starts with user or framework code calling into the <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method of the route collection.</span></span> <span data-ttu-id="80ae9-1377">La méthode *de chaque*route<xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> est appelée en séquence jusqu’à ce qu’un <xref:Microsoft.AspNetCore.Routing.VirtualPathData> non null soit retourné.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1377">Each *route* has its <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method called in sequence until a non-null <xref:Microsoft.AspNetCore.Routing.VirtualPathData> is returned.</span></span>

<span data-ttu-id="80ae9-1378">Les entrées principales dans <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1378">The primary inputs to <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> are:</span></span>

* [<span data-ttu-id="80ae9-1379">VirtualPathContext.HttpContext</span><span class="sxs-lookup"><span data-stu-id="80ae9-1379">VirtualPathContext.HttpContext</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext)
* [<span data-ttu-id="80ae9-1380">VirtualPathContext.Values</span><span class="sxs-lookup"><span data-stu-id="80ae9-1380">VirtualPathContext.Values</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values)
* [<span data-ttu-id="80ae9-1381">VirtualPathContext.AmbientValues</span><span class="sxs-lookup"><span data-stu-id="80ae9-1381">VirtualPathContext.AmbientValues</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues)

<span data-ttu-id="80ae9-1382">Les routes utilisent principalement les valeurs de routage fournies par <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> et par <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> pour décider où il est possible de générer une URL et quelles sont les valeurs à inclure.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1382">Routes primarily use the route values provided by <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> and <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> to decide whether it's possible to generate a URL and what values to include.</span></span> <span data-ttu-id="80ae9-1383">Les <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> sont l’ensemble des valeurs de route produites à partir de la mise en correspondance de la requête actuelle.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1383">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> are the set of route values that were produced from matching the current request.</span></span> <span data-ttu-id="80ae9-1384">En revanche, les <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> sont les valeurs de route qui spécifient la façon de générer l’URL souhaitée pour l’opération actuelle.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1384">In contrast, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> are the route values that specify how to generate the desired URL for the current operation.</span></span> <span data-ttu-id="80ae9-1385"><xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> est fourni au cas où une route aurait besoin d’obtenir des services ou des données supplémentaires associés au contexte actuel.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1385">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> is provided in case a route should obtain services or additional data associated with the current context.</span></span>

> [!TIP]
> <span data-ttu-id="80ae9-1386">Considérez [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) comme un ensemble de remplacements pour [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1386">Think of [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) as a set of overrides for the [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span></span> <span data-ttu-id="80ae9-1387">La génération d’URL tente de réutiliser des valeurs de route de la requête actuelle afin de générer les URL pour des liens utilisant la même route ou les mêmes valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1387">URL generation attempts to reuse route values from the current request to generate URLs for links using the same route or route values.</span></span>

<span data-ttu-id="80ae9-1388">La sortie de <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> est un <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1388">The output of <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is a <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span></span> <span data-ttu-id="80ae9-1389"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> est l’équivalent de <xref:Microsoft.AspNetCore.Routing.RouteData>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1389"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> is a parallel of <xref:Microsoft.AspNetCore.Routing.RouteData>.</span></span> <span data-ttu-id="80ae9-1390"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contient le <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> de l’URL de sortie et des propriétés supplémentaires qui doivent être définies par la route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1390"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contains the <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> for the output URL and some additional properties that should be set by the route.</span></span>

<span data-ttu-id="80ae9-1391">La propriété [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) contient le *chemin virtuel* produit par la route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1391">The [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) property contains the *virtual path* produced by the route.</span></span> <span data-ttu-id="80ae9-1392">Selon vos besoins, vous devrez peut-être traiter plus avant le chemin.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1392">Depending on your needs, you may need to process the path further.</span></span> <span data-ttu-id="80ae9-1393">Si vous souhaitez afficher l’URL générée au format HTML, ajoutez un préfixe au chemin de base de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1393">If you want to render the generated URL in HTML, prepend the base path of the app.</span></span>

<span data-ttu-id="80ae9-1394">[VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) est une référence à la route qui a généré avec succès l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1394">The [VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) is a reference to the route that successfully generated the URL.</span></span>

<span data-ttu-id="80ae9-1395">La propriété [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) est un dictionnaire de données supplémentaires relatives à la route qui a généré l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1395">The [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) properties is a dictionary of additional data related to the route that generated the URL.</span></span> <span data-ttu-id="80ae9-1396">Il s’agit de l’équivalent de [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1396">This is the parallel of [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span></span>

### <a name="create-routes"></a><span data-ttu-id="80ae9-1397">Créer des itinéraires</span><span class="sxs-lookup"><span data-stu-id="80ae9-1397">Create routes</span></span>

<span data-ttu-id="80ae9-1398">Le routage fournit la classe <xref:Microsoft.AspNetCore.Routing.Route> comme implémentation standard d’<xref:Microsoft.AspNetCore.Routing.IRouter>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1398">Routing provides the <xref:Microsoft.AspNetCore.Routing.Route> class as the standard implementation of <xref:Microsoft.AspNetCore.Routing.IRouter>.</span></span> <span data-ttu-id="80ae9-1399"><xref:Microsoft.AspNetCore.Routing.Route> utilise la syntaxe des *modèles de routage* pour définir des modèles à mettre en correspondance avec le chemin d’URL quand <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> est appelé.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1399"><xref:Microsoft.AspNetCore.Routing.Route> uses the *route template* syntax to define patterns to match against the URL path when <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is called.</span></span> <span data-ttu-id="80ae9-1400"><xref:Microsoft.AspNetCore.Routing.Route> utilise le même modèle de routage pour générer une URL quand <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> est appelé.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1400"><xref:Microsoft.AspNetCore.Routing.Route> uses the same route template to generate a URL when <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is called.</span></span>

<span data-ttu-id="80ae9-1401">La plupart des applications créent des routes en appelant <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> ou l’une des méthodes d’extension similaires définies sur <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1401">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="80ae9-1402">Toutes les méthodes d’extension de <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> créent une instance de <xref:Microsoft.AspNetCore.Routing.Route> et l’ajoutent à la collection de routes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1402">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="80ae9-1403"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> n’accepte pas de paramètre de gestionnaire de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1403"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="80ae9-1404"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> ajoute uniquement des routes gérées par <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1404"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="80ae9-1405">Le gestionnaire par défaut est un `IRouter`, et le gestionnaire est susceptible de ne pas traiter la requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1405">The default handler is an `IRouter`, and the handler might not handle the request.</span></span> <span data-ttu-id="80ae9-1406">Par exemple, ASP.NET Core MVC est généralement configuré comme gestionnaire par défaut qui gère uniquement les requêtes correspondant à un contrôleur et une action disponibles.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1406">For example, ASP.NET Core MVC is typically configured as a default handler that only handles requests that match an available controller and action.</span></span> <span data-ttu-id="80ae9-1407">Pour plus d’informations sur le routage dans MVC, consultez <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1407">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="80ae9-1408">L’exemple de code suivant est un exemple d’appel à <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> utilisé par une définition de route ASP.NET Core MVC classique :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1408">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="80ae9-1409">Ce modèle établit une correspondance avec un chemin d’URL et extrait les valeurs de route .</span><span class="sxs-lookup"><span data-stu-id="80ae9-1409">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="80ae9-1410">Par exemple, le chemin `/Products/Details/17` génère les valeurs de route suivantes : `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1410">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="80ae9-1411">Les valeurs de route sont déterminées en divisant le chemin d’URL en segments et en mettant en correspondance chaque segment avec le nom des *paramètres de routage* dans le modèle de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1411">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="80ae9-1412">Les paramètres de routage sont nommés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1412">Route parameters are named.</span></span> <span data-ttu-id="80ae9-1413">Vous définissez des paramètres en plaçant leur nom entre des accolades `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1413">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="80ae9-1414">Le modèle précédent peut également mettre en correspondance le chemin d’URL `/` et produire les valeurs `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1414">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="80ae9-1415">Cela s’explique par le fait que les paramètres de routage `{controller}` et `{action}` ont des valeurs par défaut et que le paramètre de routage `id` est facultatif.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1415">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="80ae9-1416">Un signe égal (`=`) suivi d’une valeur après le nom du paramètre de routage définit une valeur par défaut pour le paramètre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1416">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="80ae9-1417">Un point d’interrogation (`?`) après le nom du paramètre de routage définit un paramètre facultatif.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1417">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="80ae9-1418">Les paramètres de routage ayant une valeur par défaut produisent *toujours* une valeur de routage quand la route correspond.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1418">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="80ae9-1419">Les paramètres facultatifs ne produisent pas de valeur de route s’il n’y a pas de segment de chemin d’URL correspondant.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1419">Optional parameters don't produce a route value if there is no corresponding URL path segment.</span></span> <span data-ttu-id="80ae9-1420">Pour obtenir une description complète des scénarios et de la syntaxe des modèles de routage, consultez la section [Informations de référence sur les modèles de routage](#route-template-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1420">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="80ae9-1421">Dans l’exemple suivant, la définition du paramètre de route `{id:int}` définit une [contrainte de route](#route-constraint-reference) pour le paramètre de route `id` :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1421">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="80ae9-1422">Ce modèle établit une correspondance avec un chemin d’URL comme `/Products/Details/17`, mais pas `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1422">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="80ae9-1423">Les contraintes de routage implémentent <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> et inspectent les valeurs de route pour les vérifier.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1423">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="80ae9-1424">Dans cet exemple, la valeur de route `id` doit être convertible en entier.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1424">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="80ae9-1425">Pour obtenir une explication des contraintes de route fournies par le framework, consultez [Informations de référence sur les contraintes de route](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1425">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="80ae9-1426">Des surcharges supplémentaires de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> acceptent des values pour `constraints`, `dataTokens` et `defaults`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1426">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="80ae9-1427">L’utilisation classique de ces paramètres consiste à passer un objet typé anonymement, où les noms des propriétés du type anonyme correspondent aux noms de paramètre de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1427">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="80ae9-1428">Les exemples de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> suivants créent des routes équivalentes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1428">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="80ae9-1429">La syntaxe inline pour la définition des contraintes et des valeurs par défaut peut être pratique pour les routes simples.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1429">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="80ae9-1430">Cependant, certains scénarios, comme les jetons de données, ne sont pas pris en charge par la syntaxe inline.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1430">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="80ae9-1431">L’exemple suivant montre quelques autres scénarios :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1431">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{*article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="80ae9-1432">Le modèle précédent établit une correspondance avec un chemin d’URL comme `/Blog/All-About-Routing/Introduction` et extrait les valeurs `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1432">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="80ae9-1433">Les valeurs de route par défaut pour `controller` et `action` sont produites par la route, même s’il n’existe aucun paramètre de routage correspondant dans le modèle.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1433">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="80ae9-1434">Il est possible de spécifier des valeurs par défaut dans le modèle de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1434">Default values can be specified in the route template.</span></span> <span data-ttu-id="80ae9-1435">Le paramètre de route `article` est défini comme *passe-partout*  par la présence d’un astérisque (`*`) avant le nom du paramètre de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1435">The `article` route parameter is defined as a *catch-all* by the appearance of an asterisk (`*`) before the route parameter name.</span></span> <span data-ttu-id="80ae9-1436">Les paramètres de routage fourre-tout capturent le reste du chemin d’URL et peuvent également établir une correspondance avec la chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1436">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="80ae9-1437">L’exemple suivant ajoute des contraintes de route et des jetons de données :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1437">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="80ae9-1438">Le modèle précédent établit une correspondance avec un chemin d’URL comme `/en-US/Products/5`, et extrait les valeurs `{ controller = Products, action = Details, id = 5 }` et les jetons de données `{ locale = en-US }`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1438">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Jetons Windows de variables locales](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="80ae9-1440">Génération d’URL de classe de route</span><span class="sxs-lookup"><span data-stu-id="80ae9-1440">Route class URL generation</span></span>

<span data-ttu-id="80ae9-1441">La classe <xref:Microsoft.AspNetCore.Routing.Route> peut également effectuer une génération d’URL en combinant un ensemble de valeurs de route et son modèle de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1441">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="80ae9-1442">Il s’agit logiquement du processus inverse de la mise en correspondance du chemin d’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1442">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="80ae9-1443">Pour mieux comprendre la génération d’URL, imaginez l’URL que vous voulez générer, puis pensez à la façon dont un modèle de routage établirait une correspondance avec cette URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1443">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="80ae9-1444">Quelles valeurs seraient produites ?</span><span class="sxs-lookup"><span data-stu-id="80ae9-1444">What values would be produced?</span></span> <span data-ttu-id="80ae9-1445">Cela équivaut approximativement à la façon dont la génération d’URL fonctionne dans la classe <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1445">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="80ae9-1446">L’exemple suivant utilise une route par défaut ASP.NET Core MVC générale :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1446">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="80ae9-1447">Avec les valeurs de route `{ controller = Products, action = List }`, l’URL `/Products/List` est générée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1447">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="80ae9-1448">Les valeurs de route remplacent les paramètres de routage correspondant pour former le chemin d’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1448">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="80ae9-1449">Dans la mesure où `id` est un paramètre de route facultatif, l’URL est générée correctement sans valeur pour `id`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1449">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="80ae9-1450">Avec les valeurs de route `{ controller = Home, action = Index }`, l’URL `/` est générée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1450">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="80ae9-1451">Les valeurs de route fournies correspondent aux valeurs par défaut, et les segments correspondant aux valeurs par défaut peuvent être omis sans risque.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1451">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="80ae9-1452">Les deux URL générées effectuent un aller-retour avec la définition de route suivante (`/Home/Index` et `/`), et produisent les mêmes valeurs de route que celles utilisées pour générer l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1452">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="80ae9-1453">Pour générer des URL, une application utilisant ASP.NET Core MVC doit utiliser <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> au lieu d’effectuer un appel directement dans le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1453">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="80ae9-1454">Pour plus d’informations sur la génération d’URL, consultez la section [Informations de référence sur la génération d’URL](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1454">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="80ae9-1455">Utiliser l’intergiciel (middleware) de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-1455">Use routing middleware</span></span>

<span data-ttu-id="80ae9-1456">Référencez le [métapackage Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) dans le fichier projet de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1456">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="80ae9-1457">Ajoutez le routage au conteneur de service dans `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1457">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="80ae9-1458">Les routes doivent être configurées dans la méthode `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1458">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="80ae9-1459">L’exemple d’application utilise les API suivantes :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1459">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="80ae9-1460"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; correspond uniquement aux requêtes HTTP.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1460"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="80ae9-1461">Le tableau suivant montre les réponses avec les URI donnés.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1461">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="80ae9-1462">URI</span><span class="sxs-lookup"><span data-stu-id="80ae9-1462">URI</span></span>                    | <span data-ttu-id="80ae9-1463">response</span><span class="sxs-lookup"><span data-stu-id="80ae9-1463">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="80ae9-1464">Bonjour !</span><span class="sxs-lookup"><span data-stu-id="80ae9-1464">Hello!</span></span> <span data-ttu-id="80ae9-1465">Valeurs de route : [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="80ae9-1465">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="80ae9-1466">Bonjour !</span><span class="sxs-lookup"><span data-stu-id="80ae9-1466">Hello!</span></span> <span data-ttu-id="80ae9-1467">Valeurs de route : [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="80ae9-1467">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="80ae9-1468">Bonjour !</span><span class="sxs-lookup"><span data-stu-id="80ae9-1468">Hello!</span></span> <span data-ttu-id="80ae9-1469">Valeurs de route : [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="80ae9-1469">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="80ae9-1470">La requête passe à travers ceci, aucune correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1470">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="80ae9-1471">Hi, Joe!</span><span class="sxs-lookup"><span data-stu-id="80ae9-1471">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="80ae9-1472">La requête passe à travers ceci, correspondance seulement avec HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1472">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="80ae9-1473">La requête passe à travers ceci, aucune correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1473">The request falls through, no match.</span></span>              |

<span data-ttu-id="80ae9-1474">Si vous configurez une seule route, appelez <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> en passant une instance `IRouter`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1474">If you're configuring a single route, call <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> passing in an `IRouter` instance.</span></span> <span data-ttu-id="80ae9-1475">Vous n’avez pas besoin d’utiliser <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1475">You won't need to use <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span></span>

<span data-ttu-id="80ae9-1476">Le framework fournit un ensemble de méthodes d’extension pour la création de routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>) :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1476">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="80ae9-1477">Certaines des méthodes listées, comme <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, nécessitent un <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1477">Some of listed methods, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, require a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="80ae9-1478"><xref:Microsoft.AspNetCore.Http.RequestDelegate> est utilisé comme *gestionnaire de routage* quand une correspondance est trouvée pour la route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1478">The <xref:Microsoft.AspNetCore.Http.RequestDelegate> is used as the *route handler* when the route matches.</span></span> <span data-ttu-id="80ae9-1479">D’autres méthodes de cette famille permettent de configurer un pipeline de middleware utilisé comme gestionnaire de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1479">Other methods in this family allow configuring a middleware pipeline for use as the route handler.</span></span> <span data-ttu-id="80ae9-1480">Si la méthode `Map*` n’accepte pas de gestionnaire, comme <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, elle utilise le <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1480">If the `Map*` method doesn't accept a handler, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, it uses the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span>

<span data-ttu-id="80ae9-1481">Les méthodes `Map[Verb]` utilisent des contraintes pour limiter la route au verbe HTTP dans le nom de la méthode.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1481">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="80ae9-1482">Par exemple, consultez <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> et <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1482">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="80ae9-1483">Informations de référence sur les modèles de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-1483">Route template reference</span></span>

<span data-ttu-id="80ae9-1484">Les jetons placés entre accolades (`{ ... }`) définissent des *paramètres de routage* qui sont liés si une correspondance est trouvée pour la route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1484">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="80ae9-1485">Vous pouvez définir plusieurs paramètres de routage dans un segment de route, mais ils doivent être séparés par une valeur littérale.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1485">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="80ae9-1486">Par exemple `{controller=Home}{action=Index}` n’est pas une route valide, car il n’y a aucune valeur littérale entre `{controller}` et `{action}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1486">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="80ae9-1487">Ces paramètres de routage doivent avoir un nom, et ils autorisent la spécification d’attributs supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1487">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="80ae9-1488">Un texte littéral autre que les paramètres de routage (par exemple, `{id}`) et le séparateur de chemin `/` doit correspondre au texte présent dans l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1488">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="80ae9-1489">La correspondance de texte ne respecte pas la casse et est basée sur la représentation décodée du chemin des URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1489">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="80ae9-1490">Pour mettre en correspondance un délimiteur de paramètre de route littéral (`{` ou `}`), placez-le dans une séquence d’échappement en répétant le caractère (`{{` ou `}}`).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1490">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="80ae9-1491">Les modèles d’URL qui tentent de capturer un nom de fichier avec une extension de fichier facultative doivent faire l’objet de considérations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1491">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="80ae9-1492">Prenez par exemple le modèle `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1492">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="80ae9-1493">Quand des valeurs existent à la fois pour `filename` et pour `ext`, les deux valeurs sont renseignées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1493">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="80ae9-1494">Si seule une valeur existe pour `filename` dans l’URL, une correspondance est trouvée pour la route, car le point final (`.`) est facultatif.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1494">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="80ae9-1495">Les URL suivantes correspondent à cette route :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1495">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="80ae9-1496">Vous pouvez utiliser l’astérisque (`*`) comme préfixe d’un paramètre de route à lier au reste de l’URI.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1496">You can use the asterisk (`*`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="80ae9-1497">Cela s’appelle un paramètre *fourre-tout*.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1497">This is called a *catch-all* parameter.</span></span> <span data-ttu-id="80ae9-1498">Par exemple, `blog/{*slug}` établit une correspondance avec n’importe quel URI commençant par `/blog` et suivi de n’importe quelle valeur, qui est affectée à la valeur de route `slug`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1498">For example, `blog/{*slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="80ae9-1499">Les paramètres fourre-tout peuvent également établir une correspondance avec la chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1499">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="80ae9-1500">Le paramètre fourre-tout place les caractères appropriés dans une séquence d’échappement lorsque la route est utilisée pour générer une URL, y compris les caractères de séparation de chemin (`/`).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1500">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="80ae9-1501">Par exemple, la route `foo/{*path}` avec les valeurs de route `{ path = "my/path" }` génère `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1501">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="80ae9-1502">Notez la barre oblique d’échappement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1502">Note the escaped forward slash.</span></span>

<span data-ttu-id="80ae9-1503">Les paramètres de route peuvent avoir des *valeurs par défaut*, désignées en spécifiant la valeur par défaut après le nom du paramètre, séparée par un signe égal (`=`).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1503">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="80ae9-1504">Par exemple, `{controller=Home}` définit `Home` comme valeur par défaut de `controller`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1504">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="80ae9-1505">La valeur par défaut est utilisée si aucune valeur n’est présente dans l’URL pour le paramètre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1505">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="80ae9-1506">Vous pouvez rendre facultatifs les paramètres de route en ajoutant un point d’interrogation (`?`) à la fin du nom du paramètre, comme dans `id?`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1506">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="80ae9-1507">La différence entre les valeurs facultatives et les paramètres de route par défaut est qu’un paramètre de route ayant une valeur par défaut produit toujours une valeur, tandis qu’un paramètre facultatif a une valeur seulement quand celle-ci est fournie par l’URL de requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1507">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="80ae9-1508">Les paramètres de route peuvent avoir des contraintes, qui doivent correspondre à la valeur de route liée à partir de l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1508">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="80ae9-1509">L’ajout d’un signe deux-points (`:`) et d’un nom de contrainte après le nom du paramètre de routage spécifie une *contrainte inline* sur un paramètre de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1509">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="80ae9-1510">Si la contrainte nécessite des arguments, ils sont fournis entre parenthèses (`(...)`) après le nom de la contrainte.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1510">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="80ae9-1511">Il est possible de spécifier plusieurs contraintes inline en ajoutant un autre signe deux-points (`:`) et le nom d’une autre contrainte.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1511">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="80ae9-1512">Le nom de la contrainte et les arguments sont passés au service <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> pour créer une instance de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> à utiliser dans le traitement des URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1512">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="80ae9-1513">Par exemple, le modèle de routage `blog/{article:minlength(10)}` spécifie une contrainte `minlength` avec l’argument `10`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1513">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="80ae9-1514">Pour plus d’informations sur les contraintes de route et pour obtenir la liste des contraintes fournies par le framework, consultez la section [Informations de référence sur les contraintes de route](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1514">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="80ae9-1515">Le tableau suivant montre des exemples de modèles de route et leur comportement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1515">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="80ae9-1516">Modèle de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-1516">Route Template</span></span>                           | <span data-ttu-id="80ae9-1517">Exemple d’URI en correspondance</span><span class="sxs-lookup"><span data-stu-id="80ae9-1517">Example Matching URI</span></span>    | <span data-ttu-id="80ae9-1518">URI de la requête&hellip;</span><span class="sxs-lookup"><span data-stu-id="80ae9-1518">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="80ae9-1519">Correspond seulement au chemin unique `/hello`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1519">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="80ae9-1520">Correspond à `Page` et le définit sur `Home`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1520">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="80ae9-1521">Correspond à `Page` et le définit sur `Contact`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1521">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="80ae9-1522">Mappe au contrôleur `Products` et à l’action `List`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1522">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="80ae9-1523">Mappe au contrôleur `Products` et à l’action `Details` (`id` défini sur 123).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1523">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="80ae9-1524">Mappe au contrôleur `Home` et à la méthode `Index` (`id` est ignoré).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1524">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="80ae9-1525">L’utilisation d’un modèle est généralement l’approche la plus simple pour le routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1525">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="80ae9-1526">Il est également possible de spécifier des contraintes et des valeurs par défaut hors du modèle de routage.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1526">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="80ae9-1527">Activez la [journalisation](xref:fundamentals/logging/index) pour voir comment les implémentations de routage intégrées, comme <xref:Microsoft.AspNetCore.Routing.Route>, établissent des correspondances avec les requêtes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1527">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="80ae9-1528">Informations de référence sur les contraintes de routage</span><span class="sxs-lookup"><span data-stu-id="80ae9-1528">Route constraint reference</span></span>

<span data-ttu-id="80ae9-1529">Les contraintes de route s’exécutent quand une correspondance s’est produite pour l’URL entrante, et le chemin de l’URL est tokenisé en valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1529">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="80ae9-1530">En général, les contraintes de routage inspectent la valeur de route associée par le biais du modèle de routage, et créent une décision oui/non indiquant si la valeur est, ou non, acceptable.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1530">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="80ae9-1531">Certaines contraintes de routage utilisent des données hors de la valeur de route pour déterminer si la requête peut être routée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1531">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="80ae9-1532">Par exemple, <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> peut accepter ou rejeter une requête en fonction de son verbe HTTP.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1532">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="80ae9-1533">Les contraintes sont utilisées dans le routage des requêtes et la génération des liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1533">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="80ae9-1534">N’utilisez pas de contraintes pour la **validation des entrées**.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1534">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="80ae9-1535">Si des contraintes sont utilisées pour la **validation des entrées**, une entrée non valide génère une réponse *404 - Introuvable* au lieu d’une réponse *400 - Requête incorrecte* avec un message d’erreur approprié.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1535">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="80ae9-1536">Les contraintes de route sont utilisées pour **lever l’ambiguïté** entre des routes similaires, et non pas pour valider les entrées d’une route particulière.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1536">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="80ae9-1537">Le tableau suivant montre des exemples de contrainte de route et leur comportement attendu.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1537">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="80ae9-1538">contrainte</span><span class="sxs-lookup"><span data-stu-id="80ae9-1538">constraint</span></span> | <span data-ttu-id="80ae9-1539">Exemple</span><span class="sxs-lookup"><span data-stu-id="80ae9-1539">Example</span></span> | <span data-ttu-id="80ae9-1540">Exemples de correspondances</span><span class="sxs-lookup"><span data-stu-id="80ae9-1540">Example Matches</span></span> | <span data-ttu-id="80ae9-1541">Notes</span><span class="sxs-lookup"><span data-stu-id="80ae9-1541">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="80ae9-1542">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1542">`123456789`, `-123456789`</span></span> | <span data-ttu-id="80ae9-1543">Correspond à n’importe quel entier</span><span class="sxs-lookup"><span data-stu-id="80ae9-1543">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="80ae9-1544">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1544">`true`, `FALSE`</span></span> | <span data-ttu-id="80ae9-1545">Correspond à `true` ou à `false` (non-respect de la casse)</span><span class="sxs-lookup"><span data-stu-id="80ae9-1545">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="80ae9-1546">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1546">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="80ae9-1547">Correspond à une valeur de `DateTime` valide dans la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1547">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="80ae9-1548">Consultez l’avertissement précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1548">See  preceding warning.</span></span>|
| `decimal` | `{price:decimal}` | <span data-ttu-id="80ae9-1549">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1549">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="80ae9-1550">Correspond à une valeur de `decimal` valide dans la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1550">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="80ae9-1551">Consultez l’avertissement précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1551">See  preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="80ae9-1552">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1552">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="80ae9-1553">Correspond à une valeur de `double` valide dans la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1553">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="80ae9-1554">Consultez l’avertissement précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1554">See  preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="80ae9-1555">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1555">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="80ae9-1556">Correspond à une valeur de `float` valide dans la culture dite indifférente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1556">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="80ae9-1557">Consultez l’avertissement précédent.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1557">See  preceding warning.</span></span>|
| `guid` | `{id:guid}` | <span data-ttu-id="80ae9-1558">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1558">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="80ae9-1559">Correspond à une valeur `Guid` valide</span><span class="sxs-lookup"><span data-stu-id="80ae9-1559">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="80ae9-1560">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="80ae9-1560">`123456789`, `-123456789`</span></span> | <span data-ttu-id="80ae9-1561">Correspond à une valeur `long` valide</span><span class="sxs-lookup"><span data-stu-id="80ae9-1561">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="80ae9-1562">La chaîne doit comporter au moins 4 caractères</span><span class="sxs-lookup"><span data-stu-id="80ae9-1562">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="80ae9-1563">La chaîne ne doit pas comporter plus de 8 caractères</span><span class="sxs-lookup"><span data-stu-id="80ae9-1563">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="80ae9-1564">La chaîne doit comporter exactement 12 caractères</span><span class="sxs-lookup"><span data-stu-id="80ae9-1564">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="80ae9-1565">La chaîne doit comporter au moins 8 caractères et pas plus de 16 caractères</span><span class="sxs-lookup"><span data-stu-id="80ae9-1565">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="80ae9-1566">La valeur entière doit être au moins égale à 18</span><span class="sxs-lookup"><span data-stu-id="80ae9-1566">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="80ae9-1567">La valeur entière ne doit pas être supérieure à 120</span><span class="sxs-lookup"><span data-stu-id="80ae9-1567">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="80ae9-1568">La valeur entière doit être au moins égale à 18 mais ne doit pas être supérieure à 120</span><span class="sxs-lookup"><span data-stu-id="80ae9-1568">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="80ae9-1569">La chaîne doit se composer d’un ou de plusieurs caractères alphabétiques (`a`-`z`, non-respect de la casse)</span><span class="sxs-lookup"><span data-stu-id="80ae9-1569">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="80ae9-1570">La chaîne doit correspondre à l’expression régulière (voir les conseils relatifs à la définition d’une expression régulière)</span><span class="sxs-lookup"><span data-stu-id="80ae9-1570">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="80ae9-1571">Utilisé pour garantir qu’une valeur autre qu’un paramètre est présente pendant la génération de l’URL</span><span class="sxs-lookup"><span data-stu-id="80ae9-1571">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="80ae9-1572">Il est possible d’appliquer plusieurs contraintes séparées par un point-virgule à un même paramètre.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1572">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="80ae9-1573">Par exemple, la contrainte suivante limite un paramètre à une valeur entière supérieure ou égale à 1 :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1573">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="80ae9-1574">Les contraintes de routage qui vérifient que l’URL peut être convertie en type CLR (comme `int` ou `DateTime`) utilisent toujours la culture invariant.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1574">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="80ae9-1575">ces contraintes partent du principe que l’URL n’est pas localisable.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1575">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="80ae9-1576">Les contraintes de routage fournies par le framework ne modifient pas les valeurs stockées dans les valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1576">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="80ae9-1577">Toutes les valeurs de route analysées à partir de l’URL sont stockées sous forme de chaînes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1577">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="80ae9-1578">Par exemple, la contrainte `float` tente de convertir la valeur de route en valeur float, mais la valeur convertie est utilisée uniquement pour vérifier qu’elle peut être convertie en valeur float.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1578">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="80ae9-1579">Expressions régulières</span><span class="sxs-lookup"><span data-stu-id="80ae9-1579">Regular expressions</span></span>

<span data-ttu-id="80ae9-1580">Le framework ASP.NET Core ajoute `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` au constructeur d’expression régulière.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1580">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="80ae9-1581">Pour obtenir une description de ces membres, consultez <xref:System.Text.RegularExpressions.RegexOptions>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1581">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="80ae9-1582">Les expressions régulières utilisent les délimiteurs et des jetons semblables à ceux utilisés par le service de routage et le langage C#.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1582">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="80ae9-1583">Les jetons d’expression régulière doivent être placés dans une séquence d’échappement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1583">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="80ae9-1584">Pour que l’expression régulière `^\d`\\`-\d`\`-\d`\`$` puisse être utilisée dans le routage, il faut que les caractères `\` (une seule barre oblique inverse) soit fournis dans la chaîne sous la forme `\\` (double barre oblique inverse) dans le fichier source C#, pour placer en échappement le caractère d’échappement de chaîne `\` (sauf en cas d’utilisation de [littéraux de chaîne textuelle](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1584">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="80ae9-1585">Pour placer en échappement les caractères de délimiteur de paramètre de route (`{`, `}`, `[`, `]`), doublez les caractères dans l’expression (`{{`, `}`, `[[`, `]]`).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1585">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="80ae9-1586">Le tableau suivant montre une expression régulière et la version placée en échappement.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1586">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="80ae9-1587">Expression régulière</span><span class="sxs-lookup"><span data-stu-id="80ae9-1587">Regular Expression</span></span>    | <span data-ttu-id="80ae9-1588">Expression régulière en échappement</span><span class="sxs-lookup"><span data-stu-id="80ae9-1588">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="80ae9-1589">Les expressions régulières utilisées dans le routage commencent souvent par un caret (`^`) et correspondent à la position de début de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1589">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="80ae9-1590">Les expressions se terminent souvent par le signe dollar (`$`) de caractère et correspondent à la fin de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1590">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="80ae9-1591">Les caractères `^` et `$` garantissent que l’expression régulière établit une correspondance avec la totalité de la valeur du paramètre de route.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1591">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="80ae9-1592">Sans les caractères `^` et `$`, l’expression régulière peut correspondre à n’importe quelle sous-chaîne dans la chaîne, ce qui est souvent indésirable.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1592">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="80ae9-1593">Le tableau suivant contient des exemples et explique pourquoi ils établissent ou non une correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1593">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="80ae9-1594">Expression</span><span class="sxs-lookup"><span data-stu-id="80ae9-1594">Expression</span></span>   | <span data-ttu-id="80ae9-1595">String</span><span class="sxs-lookup"><span data-stu-id="80ae9-1595">String</span></span>    | <span data-ttu-id="80ae9-1596">Correspond</span><span class="sxs-lookup"><span data-stu-id="80ae9-1596">Match</span></span> | <span data-ttu-id="80ae9-1597">Commentaire</span><span class="sxs-lookup"><span data-stu-id="80ae9-1597">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="80ae9-1598">hello</span><span class="sxs-lookup"><span data-stu-id="80ae9-1598">hello</span></span>     | <span data-ttu-id="80ae9-1599">Oui</span><span class="sxs-lookup"><span data-stu-id="80ae9-1599">Yes</span></span>   | <span data-ttu-id="80ae9-1600">Correspondances de sous-chaînes</span><span class="sxs-lookup"><span data-stu-id="80ae9-1600">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="80ae9-1601">123abc456</span><span class="sxs-lookup"><span data-stu-id="80ae9-1601">123abc456</span></span> | <span data-ttu-id="80ae9-1602">Oui</span><span class="sxs-lookup"><span data-stu-id="80ae9-1602">Yes</span></span>   | <span data-ttu-id="80ae9-1603">Correspondances de sous-chaînes</span><span class="sxs-lookup"><span data-stu-id="80ae9-1603">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="80ae9-1604">mz</span><span class="sxs-lookup"><span data-stu-id="80ae9-1604">mz</span></span>        | <span data-ttu-id="80ae9-1605">Oui</span><span class="sxs-lookup"><span data-stu-id="80ae9-1605">Yes</span></span>   | <span data-ttu-id="80ae9-1606">Correspondance avec l’expression</span><span class="sxs-lookup"><span data-stu-id="80ae9-1606">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="80ae9-1607">MZ</span><span class="sxs-lookup"><span data-stu-id="80ae9-1607">MZ</span></span>        | <span data-ttu-id="80ae9-1608">Oui</span><span class="sxs-lookup"><span data-stu-id="80ae9-1608">Yes</span></span>   | <span data-ttu-id="80ae9-1609">Non-respect de la casse</span><span class="sxs-lookup"><span data-stu-id="80ae9-1609">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="80ae9-1610">hello</span><span class="sxs-lookup"><span data-stu-id="80ae9-1610">hello</span></span>     | <span data-ttu-id="80ae9-1611">Non</span><span class="sxs-lookup"><span data-stu-id="80ae9-1611">No</span></span>    | <span data-ttu-id="80ae9-1612">Voir `^` et `$` ci-dessus</span><span class="sxs-lookup"><span data-stu-id="80ae9-1612">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="80ae9-1613">123abc456</span><span class="sxs-lookup"><span data-stu-id="80ae9-1613">123abc456</span></span> | <span data-ttu-id="80ae9-1614">Non</span><span class="sxs-lookup"><span data-stu-id="80ae9-1614">No</span></span>    | <span data-ttu-id="80ae9-1615">Voir `^` et `$` ci-dessus</span><span class="sxs-lookup"><span data-stu-id="80ae9-1615">See `^` and `$` above</span></span> |

<span data-ttu-id="80ae9-1616">Pour plus d’informations sur la syntaxe des expressions régulières, consultez [Expressions régulières du .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1616">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="80ae9-1617">Pour contraindre un paramètre à un ensemble connu de valeurs possibles, utilisez une expression régulière.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1617">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="80ae9-1618">Par exemple, `{action:regex(^(list|get|create)$)}` établit une correspondance avec la valeur de route `action` uniquement pour `list`, `get` ou `create`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1618">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="80ae9-1619">Si elle est passée dans le dictionnaire de contraintes, la chaîne `^(list|get|create)$` est équivalente.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1619">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="80ae9-1620">Les contraintes passées dans le dictionnaire de contraintes (c’est-à-dire qui ne sont pas inline dans un modèle) qui ne correspondent pas à l’une des contraintes connues sont également traitées comme des expressions régulières.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1620">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="80ae9-1621">Contraintes d’itinéraire personnalisé</span><span class="sxs-lookup"><span data-stu-id="80ae9-1621">Custom Route Constraints</span></span>

<span data-ttu-id="80ae9-1622">Outre les contraintes d’itinéraire intégré, les contraintes d’itinéraire personnalisé peuvent être créées en implémentant l’interface <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1622">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="80ae9-1623">L’interface <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> contient une méthode unique, `Match`, qui retourne `true` si la contrainte est satisfaite et `false` dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1623">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="80ae9-1624">Pour utiliser un <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> personnalisé, le type de contrainte d’itinéraire doit être inscrit avec le <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de l’application dans le conteneur de service de l’application.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1624">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="80ae9-1625">Un <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> est un dictionnaire qui mappe les clés de contrainte d’itinéraire aux implémentations <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> qui valident ces contraintes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1625">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="80ae9-1626">Le <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> d’une application peut être mis à jour dans `Startup.ConfigureServices` dans le cadre d’un appel [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) ou en configurant <xref:Microsoft.AspNetCore.Routing.RouteOptions> directement avec `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1626">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="80ae9-1627">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1627">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="80ae9-1628">La contrainte peut ensuite être appliquée aux itinéraires de la manière habituelle, en utilisant le nom spécifié lors de l’inscription du type de contrainte.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1628">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="80ae9-1629">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1629">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="url-generation-reference"></a><span data-ttu-id="80ae9-1630">Informations de référence sur la génération d’URL</span><span class="sxs-lookup"><span data-stu-id="80ae9-1630">URL generation reference</span></span>

<span data-ttu-id="80ae9-1631">L’exemple suivant montre comment générer un lien vers une route selon un dictionnaire de valeurs de route et un <xref:Microsoft.AspNetCore.Routing.RouteCollection> données.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1631">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="80ae9-1632">Le <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> généré à la fin de l’exemple précédent est `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1632">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="80ae9-1633">Le dictionnaire fournit les valeurs de route `operation` et `id` du modèle « Suivi de package de route », `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1633">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="80ae9-1634">Pour plus d’informations, consultez l’exemple de code dans la section [Utilisation du middleware de routage](#use-routing-middleware) ou l’[exemple d’application](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="80ae9-1634">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="80ae9-1635">Le deuxième paramètre pour le constructeur <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> est une collection de *valeurs ambiantes*.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1635">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="80ae9-1636">Les valeurs ambiantes sont pratiques à utiliser, car elles limitent le nombre de valeurs qu’un développeur doit spécifier dans un contexte de requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1636">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="80ae9-1637">Les valeurs de route actuelles de la requête actuelle sont considérées comme des valeurs ambiantes pour la génération de liens.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1637">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="80ae9-1638">Dans l’action `About` de `HomeController` d’une application ASP.NET Core MVC, vous n’avez pas besoin de spécifier la valeur de route du contrôleur pour créer un lien vers l’action `Index` : la valeur ambiante de &mdash; est utilisée.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1638">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="80ae9-1639">Les valeurs ambiantes qui ne correspondent pas à un paramètre sont ignorées.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1639">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="80ae9-1640">Les valeurs ambiantes sont également ignorées quand une valeur explicitement fournie remplace la valeur ambiante.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1640">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="80ae9-1641">La mise en correspondance se produit de gauche à droite dans l’URL.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1641">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="80ae9-1642">Les valeurs fournies explicitement mais qui n’ont pas de correspondance avec un segment de la route sont ajoutées à la chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1642">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="80ae9-1643">Le tableau suivant présente le résultat en cas d’utilisation du modèle de routage `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1643">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="80ae9-1644">Valeurs ambiantes</span><span class="sxs-lookup"><span data-stu-id="80ae9-1644">Ambient Values</span></span>                     | <span data-ttu-id="80ae9-1645">Valeurs explicites</span><span class="sxs-lookup"><span data-stu-id="80ae9-1645">Explicit Values</span></span>                        | <span data-ttu-id="80ae9-1646">Résultats</span><span class="sxs-lookup"><span data-stu-id="80ae9-1646">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="80ae9-1647">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1647">controller = "Home"</span></span>                | <span data-ttu-id="80ae9-1648">action = "About"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1648">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="80ae9-1649">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1649">controller = "Home"</span></span>                | <span data-ttu-id="80ae9-1650">controller = "Order", action = "About"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1650">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="80ae9-1651">controller = "Home", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1651">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="80ae9-1652">action = "About"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1652">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="80ae9-1653">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1653">controller = "Home"</span></span>                | <span data-ttu-id="80ae9-1654">action = "About", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="80ae9-1654">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="80ae9-1655">Si une route a une valeur par défaut qui ne correspond pas à un paramètre et que cette valeur est explicitement fournie, elle doit correspondre à la valeur par défaut :</span><span class="sxs-lookup"><span data-stu-id="80ae9-1655">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="80ae9-1656">La génération de liens génère un lien pour cette route seulement quand les valeurs correspondantes pour `controller` et pour `action` sont fournies.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1656">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="80ae9-1657">Segments complexes</span><span class="sxs-lookup"><span data-stu-id="80ae9-1657">Complex segments</span></span>

<span data-ttu-id="80ae9-1658">Les segments complexes (par exemple, `[Route("/x{token}y")]`) sont traités par la mise en correspondance des littéraux de droite à gauche de manière non gourmande.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1658">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="80ae9-1659">Consultez [ce code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) pour obtenir une explication détaillée de la façon dont les segments complexes sont mis en correspondance.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1659">See [this code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="80ae9-1660">[L’exemple de code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) n’est pas utilisé par ASP.NET Core, mais il fournit une bonne explication des segments complexes.</span><span class="sxs-lookup"><span data-stu-id="80ae9-1660">The [code sample](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>


::: moniker-end
