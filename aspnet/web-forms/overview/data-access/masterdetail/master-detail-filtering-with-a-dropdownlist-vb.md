---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
title: "Maître/détail, le filtrage avec une liste déroulante (VB) | Documents Microsoft"
author: rick-anderson
description: "Dans ce didacticiel, nous verrons comment afficher les enregistrements maîtres dans un contrôle DropDownList et les détails de l’élément sélectionné dans un contrôle GridView."
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: ea44717e-ab2e-46cd-a692-e4a9c0de194c
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
msc.type: authoredcontent
ms.openlocfilehash: 88e5c65c100bea3cc39b1e08b1aa8a622b4ce7a6
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/10/2017
---
<a name="masterdetail-filtering-with-a-dropdownlist-vb"></a><span data-ttu-id="74bf0-103">Maître/détail, le filtrage avec une liste déroulante (VB)</span><span class="sxs-lookup"><span data-stu-id="74bf0-103">Master/Detail Filtering With a DropDownList (VB)</span></span>
====================
<span data-ttu-id="74bf0-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="74bf0-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="74bf0-105">[Télécharger l’exemple d’application](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) ou [télécharger le PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="74bf0-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span></span>

> <span data-ttu-id="74bf0-106">Dans ce didacticiel, nous verrons comment afficher les enregistrements maîtres dans un contrôle DropDownList et les détails de l’élément sélectionné dans un contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="74bf0-106">In this tutorial we'll see how to display the master records in a DropDownList control and the details of the selected list item in a GridView.</span></span>


## <a name="introduction"></a><span data-ttu-id="74bf0-107">Introduction</span><span class="sxs-lookup"><span data-stu-id="74bf0-107">Introduction</span></span>

<span data-ttu-id="74bf0-108">Un type commun de rapport est la *maître/détail rapport*, dans lequel le rapport commence en affichant un ensemble d’enregistrements « maîtres ».</span><span class="sxs-lookup"><span data-stu-id="74bf0-108">A common type of report is the *master/detail report*, in which the report begins by showing some set of "master" records.</span></span> <span data-ttu-id="74bf0-109">L’utilisateur peut puis accédez à un des enregistrements maîtres, donc affichage « Détails. » de cet enregistrement maître</span><span class="sxs-lookup"><span data-stu-id="74bf0-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="74bf0-110">Maître/détail des rapports est un choix idéal pour visualiser les relations un-à-plusieurs, tels qu’un rapport affichant toutes les catégories et puis permettant à un utilisateur de sélectionner une catégorie particulière et ses produits associés à afficher.</span><span class="sxs-lookup"><span data-stu-id="74bf0-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships, such as a report showing all of the categories and then allowing a user to select a particular category and display its associated products.</span></span> <span data-ttu-id="74bf0-111">En outre, les rapports maître/détail sont utiles pour afficher des informations détaillées à partir des tables en particulier « larges » (ceux qui ont un grand nombre de colonnes).</span><span class="sxs-lookup"><span data-stu-id="74bf0-111">Additionally, master/detail reports are useful for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="74bf0-112">Par exemple, le niveau « maître » d’un rapport maître/détail peut afficher uniquement le nom et l’unité de prix du produit des produits dans la base de données, et exploration d’un produit particulier affiche les champs de produits supplémentaires (catégorie, fournisseur, quantité par unité, et ainsi de suite).</span><span class="sxs-lookup"><span data-stu-id="74bf0-112">For example, the "master" level of a master/detail report might show just the product name and unit price of the products in the database, and drilling down into a particular product would show the additional product fields (category, supplier, quantity per unit, and so on).</span></span>

<span data-ttu-id="74bf0-113">Il existe plusieurs façons avec laquelle un rapport maître/détail peut être implémenté.</span><span class="sxs-lookup"><span data-stu-id="74bf0-113">There are many ways with which a master/detail report can be implemented.</span></span> <span data-ttu-id="74bf0-114">Cet aspect ainsi que les trois didacticiels, nous allons examiner une variété de rapports maître/détail.</span><span class="sxs-lookup"><span data-stu-id="74bf0-114">Over this and the next three tutorials we'll look at a variety of master/detail reports.</span></span> <span data-ttu-id="74bf0-115">Dans ce didacticiel, nous verrons comment afficher les enregistrements maîtres dans un [contrôle DropDownList](https://msdn.microsoft.com/en-us/library/dtx91y0z.aspx) et les détails de l’élément sélectionné dans un contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="74bf0-115">In this tutorial we'll see how to display the master records in a [DropDownList control](https://msdn.microsoft.com/en-us/library/dtx91y0z.aspx) and the details of the selected list item in a GridView.</span></span> <span data-ttu-id="74bf0-116">En particulier, rapport de maître/détail de ce didacticiel répertorie les informations de catégorie et produit.</span><span class="sxs-lookup"><span data-stu-id="74bf0-116">In particular, this tutorial's master/detail report will list category and product information.</span></span>

## <a name="step-1-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="74bf0-117">Étape 1 : Afficher les catégories dans une liste déroulante</span><span class="sxs-lookup"><span data-stu-id="74bf0-117">Step 1: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="74bf0-118">Notre rapport maître/détail répertorie les catégories dans une liste déroulante, avec les produits de l’élément de liste sélectionné affichées plus bas dans la page dans un contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="74bf0-118">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a GridView.</span></span> <span data-ttu-id="74bf0-119">La première tâche avance us, est ensuite, pour que les catégories affichées dans une liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="74bf0-119">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="74bf0-120">Ouvrez le `FilterByDropDownList.aspx` page dans le `Filtering` dossier, faites glisser sur une liste déroulante à partir de la boîte à outils vers le Concepteur de la page et définissez son `ID` propriété `Categories`.</span><span class="sxs-lookup"><span data-stu-id="74bf0-120">Open the `FilterByDropDownList.aspx` page in the `Filtering` folder, drag on a DropDownList from the Toolbox onto the page's designer, and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="74bf0-121">Ensuite, cliquez sur le lien de choisir la Source de données à partir de la balise de DropDownList.</span><span class="sxs-lookup"><span data-stu-id="74bf0-121">Next, click on the Choose Data Source link from the DropDownList's smart tag.</span></span> <span data-ttu-id="74bf0-122">L’Assistant Configuration de Source de données s’affiche.</span><span class="sxs-lookup"><span data-stu-id="74bf0-122">This will display the Data Source Configuration wizard.</span></span>


<span data-ttu-id="74bf0-123">[![Spécifiez la Source de données de DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-123">[![Specify the DropDownList's Data Source](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span></span>

<span data-ttu-id="74bf0-124">**Figure 1**: spécifiez la Source de données de DropDownList ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-124">**Figure 1**: Specify the DropDownList's Data Source ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span></span>


<span data-ttu-id="74bf0-125">Choisir d’ajouter un nouveau ObjectDataSource nommé `CategoriesDataSource` qui appelle le `CategoriesBLL` la classe `GetCategories()` (méthode).</span><span class="sxs-lookup"><span data-stu-id="74bf0-125">Choose to add a new ObjectDataSource named `CategoriesDataSource` that invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span>


<span data-ttu-id="74bf0-126">[![Ajouter un nouveau ObjectDataSource nommé CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-126">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span></span>

<span data-ttu-id="74bf0-127">**Figure 2**: ajouter un nouveau nommé de ObjectDataSource `CategoriesDataSource` ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-127">**Figure 2**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span></span>


<span data-ttu-id="74bf0-128">[![Choisissez d’utiliser la classe CategoriesBLL](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span></span>

<span data-ttu-id="74bf0-129">**Figure 3**: choisissez d’utiliser le `CategoriesBLL` classe ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-129">**Figure 3**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span></span>


<span data-ttu-id="74bf0-130">[![Configurer pour utiliser la méthode GetCategories() ObjectDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span></span>

<span data-ttu-id="74bf0-131">**Figure 4**: configurer l’ObjectDataSource à utiliser le `GetCategories()` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-131">**Figure 4**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span></span>


<span data-ttu-id="74bf0-132">Après avoir configuré l’ObjectDataSource, nous devons encore spécifier quel champ de source de données doit être affiché dans DropDownList et un doit être associé en tant que la valeur de l’élément de liste.</span><span class="sxs-lookup"><span data-stu-id="74bf0-132">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in DropDownList and which one should be associated as the value for the list item.</span></span> <span data-ttu-id="74bf0-133">Avoir le `CategoryName` champ en tant que l’affichage et `CategoryID` comme valeur pour chaque élément de liste.</span><span class="sxs-lookup"><span data-stu-id="74bf0-133">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>


<span data-ttu-id="74bf0-134">[![A l’affichage DropDownList le champ nom de catégorie et utilisez CategoryID comme valeur](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span></span>

<span data-ttu-id="74bf0-135">**Figure 5**: affiche la DropDownList le `CategoryName` champ et utilisez `CategoryID` comme valeur ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-135">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span></span>


<span data-ttu-id="74bf0-136">À ce stade, nous avons un contrôle DropDownList qui est rempli avec les enregistrements à partir de la `Categories` table (tous accomplie dans environ six secondes).</span><span class="sxs-lookup"><span data-stu-id="74bf0-136">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="74bf0-137">La figure 6 illustre notre progression jusque-là lorsqu’ils sont affichés via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="74bf0-137">Figure 6 shows our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="74bf0-138">[![Une liste déroulante répertorie les catégories en cours](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-138">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span></span>

<span data-ttu-id="74bf0-139">**Figure 6**: une liste déroulante répertorie les catégories actuel ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-139">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span></span>


## <a name="step-2-adding-the-products-gridview"></a><span data-ttu-id="74bf0-140">Étape 2 : Ajout de produits GridView</span><span class="sxs-lookup"><span data-stu-id="74bf0-140">Step 2: Adding the Products GridView</span></span>

<span data-ttu-id="74bf0-141">Cette dernière étape de notre rapport maître/détail consiste à répertorier les produits associés à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="74bf0-141">That last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="74bf0-142">Pour ce faire, ajoutez un contrôle GridView à la page et créer un nouveau ObjectDataSource nommé `productsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="74bf0-142">To accomplish this, add a GridView to the page and create a new ObjectDataSource named `productsDataSource`.</span></span> <span data-ttu-id="74bf0-143">Avoir le `productsDataSource` contrôle réduire ses données à partir de la `ProductsBLL` la classe `GetProductsByCategoryID(categoryID)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="74bf0-143">Have the `productsDataSource` control cull its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span>


<span data-ttu-id="74bf0-144">[![Sélectionnez la méthode GetProductsByCategoryID(categoryID)](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-144">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span></span>

<span data-ttu-id="74bf0-145">**Figure 7**: sélectionnez le `GetProductsByCategoryID(categoryID)` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-145">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span></span>


<span data-ttu-id="74bf0-146">Après le choix de cette méthode, l’Assistant ObjectDataSource nous invite pour la valeur de la méthode  *`categoryID`*  paramètre.</span><span class="sxs-lookup"><span data-stu-id="74bf0-146">After choosing this method, the ObjectDataSource wizard prompts us for the value for the method's *`categoryID`* parameter.</span></span> <span data-ttu-id="74bf0-147">Pour utiliser la valeur de l’élément sélectionné `categories` DropDownList élément définie la source de paramètre pour le contrôle et le ControlID à `Categories`.</span><span class="sxs-lookup"><span data-stu-id="74bf0-147">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>


<span data-ttu-id="74bf0-148">[![Affectez à la valeur de DropDownList catégories categoryID paramètre](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-148">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span></span>

<span data-ttu-id="74bf0-149">**Figure 8**: définir le  *`categoryID`*  paramètre à la valeur de la `Categories` DropDownList ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-149">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span></span>


<span data-ttu-id="74bf0-150">Prenez un moment à consulter notre progression dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="74bf0-150">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="74bf0-151">Lors de la première visite de la page, les produits appartenant à la catégorie sélectionnée (boissons) sont affichées (comme indiqué dans la Figure 9), mais la modification DropDownList ne mettre à jour les données.</span><span class="sxs-lookup"><span data-stu-id="74bf0-151">When first visiting the page, those products belong to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="74bf0-152">Il s’agit, car une publication (postback) doit survenir pour que le contrôle GridView à mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="74bf0-152">This is because a postback must occur for the GridView to update.</span></span> <span data-ttu-id="74bf0-153">Pour ce faire, nous avons deux options (qui ne requiert l’écriture de code) :</span><span class="sxs-lookup"><span data-stu-id="74bf0-153">To accomplish this we have two options (neither of which requires writing any code):</span></span>

- <span data-ttu-id="74bf0-154">**Définir les catégories DropDownList**[propriété AutoPostBack](https://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**sur True.**</span><span class="sxs-lookup"><span data-stu-id="74bf0-154">**Set the categories DropDownList's**[AutoPostBack property](https://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**to True.**</span></span> <span data-ttu-id="74bf0-155">(Vous pouvez pour cela en activant l’option Activer AutoPostBack dans la balise de DropDownList.) Cela déclenchera une publication (postback) lorsque vous sélectionnez de DropDownList élément est modifié par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="74bf0-155">(You can accomplish this by checking the Enable AutoPostBack option in the DropDownList's smart tag.) This will trigger a postback whenever the DropDownList's selected item is changed by the user.</span></span> <span data-ttu-id="74bf0-156">Par conséquent, lorsque l’utilisateur sélectionne une nouvelle catégorie dans la liste déroulante résulte d’une publication (postback) et le contrôle GridView sera mise à jour avec les produits de la catégorie qui vient d’être sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="74bf0-156">Therefore, when the user selects a new category from the DropDownList a postback will ensue and the GridView will be updated with the products for the newly selected category.</span></span> <span data-ttu-id="74bf0-157">(Il s’agit de l’approche que j’ai utilisé dans ce didacticiel.)</span><span class="sxs-lookup"><span data-stu-id="74bf0-157">(This is the approach I've used in this tutorial.)</span></span>
- <span data-ttu-id="74bf0-158">**Ajouter un contrôle bouton en regard de DropDownList.**</span><span class="sxs-lookup"><span data-stu-id="74bf0-158">**Add a Button Web control next to the DropDownList.**</span></span> <span data-ttu-id="74bf0-159">Définir son `Text` propriété de l’actualisation ou quelque chose de similaire.</span><span class="sxs-lookup"><span data-stu-id="74bf0-159">Set its `Text` property to Refresh or something similar.</span></span> <span data-ttu-id="74bf0-160">Avec cette approche, l’utilisateur doit sélectionner une nouvelle catégorie et puis cliquez sur le bouton.</span><span class="sxs-lookup"><span data-stu-id="74bf0-160">With this approach, the user will need to select a new category and then click the Button.</span></span> <span data-ttu-id="74bf0-161">Cliquez sur le bouton entraîne une publication (postback) et mettre à jour le contrôle GridView pour répertorier les produits de la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="74bf0-161">Clicking the Button will cause a postback and update the GridView to list those products of the selected category.</span></span>

<span data-ttu-id="74bf0-162">Figures 9 et 10 illustrent le rapport maître/détail en action.</span><span class="sxs-lookup"><span data-stu-id="74bf0-162">Figures 9 and 10 illustrate the master/detail report in action.</span></span>


<span data-ttu-id="74bf0-163">[![Lors de la première visite de la Page, les produits de boissons sont affichés.](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-163">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span></span>

<span data-ttu-id="74bf0-164">**Figure 9**: lors de la première visite de la Page, les produits de boissons sont affichés ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-164">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span></span>


<span data-ttu-id="74bf0-165">[![Sélection d’un nouveau produit (produit) automatiquement provoque une publication (postback), la mise à jour le contrôle GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-165">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span></span>

<span data-ttu-id="74bf0-166">**La figure 10**: sélection d’un nouveau produit (produit) automatiquement provoque une publication (postback), la mise à jour le contrôle GridView ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-166">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span></span>


## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="74bf0-167">Ajout d’un élément de liste «--Choisir une catégorie : »</span><span class="sxs-lookup"><span data-stu-id="74bf0-167">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="74bf0-168">Lors de la première visite le `FilterByDropDownList.aspx` page les catégories premier élément de liste du DropDownList (boissons) est sélectionnée par défaut, indiquant les produits de boissons dans le GridView.</span><span class="sxs-lookup"><span data-stu-id="74bf0-168">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the GridView.</span></span> <span data-ttu-id="74bf0-169">Plutôt que montrant les produits de la première catégorie, que nous pouvons adopter plutôt créer un élément de DropDownList sélectionné, qui indique que quelque chose comme «--choisir une catégorie-- ».</span><span class="sxs-lookup"><span data-stu-id="74bf0-169">Rather than showing the first category's products, we may want to instead have a DropDownList item selected that says something like, "-- Choose a Category --".</span></span>

<span data-ttu-id="74bf0-170">Pour ajouter un nouvel élément de liste à DropDownList, accédez à la fenêtre Propriétés, puis cliquez sur le bouton de sélection dans le `Items` propriété.</span><span class="sxs-lookup"><span data-stu-id="74bf0-170">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="74bf0-171">Ajouter un nouvel élément de liste avec la `Text` «--choisir une catégorie-- » et le `Value` `-1`.</span><span class="sxs-lookup"><span data-stu-id="74bf0-171">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `-1`.</span></span>


<span data-ttu-id="74bf0-172">[![Ajouter un--élément de liste, choisissez une catégorie :](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-172">[![Add a -- Choose a Category -- List Item](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span></span>

<span data-ttu-id="74bf0-173">**Figure 11**: ajouter un--élément de liste, choisissez une catégorie--([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-173">**Figure 11**: Add a -- Choose a Category -- List Item ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span></span>


<span data-ttu-id="74bf0-174">Ou bien, vous pouvez ajouter l’élément de liste en ajoutant le balisage suivant pour DropDownList :</span><span class="sxs-lookup"><span data-stu-id="74bf0-174">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>


[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample1.aspx)]

<span data-ttu-id="74bf0-175">En outre, nous devons définir le contrôle de DropDownList `AppendDataBoundItems` à True, car lorsque les catégories sont liés aux contrôles DropDownList de ObjectDataSource elles remplaceront tous les éléments ajoutés manuellement la liste si `AppendDataBoundItems` n’est pas la valeur True.</span><span class="sxs-lookup"><span data-stu-id="74bf0-175">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to True because when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items if `AppendDataBoundItems` isn't True.</span></span>


![La valeur de la propriété AppendDataBoundItems True](master-detail-filtering-with-a-dropdownlist-vb/_static/image34.png)

<span data-ttu-id="74bf0-177">**Figure 12**: définir le `AppendDataBoundItems` True à la propriété</span><span class="sxs-lookup"><span data-stu-id="74bf0-177">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>


<span data-ttu-id="74bf0-178">Après ces modifications, lors de la première visite la page de l’option «--choisir une catégorie-- » est sélectionnée et aucun produit n’est affichés.</span><span class="sxs-lookup"><span data-stu-id="74bf0-178">After these changes, when first visiting the page the "-- Choose a Category --" option is selected and no products are displayed.</span></span>


<span data-ttu-id="74bf0-179">[![Sur le chargement de Page Initial aucun produit n’est affichés](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-179">[![On the Initial Page Load No Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span></span>

<span data-ttu-id="74bf0-180">**Figure 13**: sur l’initiale Page charge non produits sont affichés ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-180">**Figure 13**: On the Initial Page Load No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span></span>


<span data-ttu-id="74bf0-181">Est de la raison pour laquelle aucun produit n’est affichés lorsque, car l’élément de liste «--Choisir une catégorie-- » est sélectionné, car sa valeur est `-1` et il n’y aucun produit dans la base de données avec un `CategoryID` de `-1`.</span><span class="sxs-lookup"><span data-stu-id="74bf0-181">The reason no products are displayed when because the "-- Choose a Category --" list item is selected is because its value is `-1` and there are no products in the database with a `CategoryID` of `-1`.</span></span> <span data-ttu-id="74bf0-182">S’il s’agit du comportement voulu, puis que vous avez terminé à ce stade !</span><span class="sxs-lookup"><span data-stu-id="74bf0-182">If this is the behavior you want then you're done at this point!</span></span> <span data-ttu-id="74bf0-183">Si, toutefois, vous souhaitez afficher *tous les* des catégories lorsque l’élément de liste «--Choisir une catégorie-- » est sélectionné, revenir à la `ProductsBLL` de classe et de personnaliser la `GetProductsByCategoryID(categoryID)` méthode afin qu’elle appelle la `GetProducts()` (méthode) si passé dans  *`categoryID`*  paramètre est inférieur à zéro :</span><span class="sxs-lookup"><span data-stu-id="74bf0-183">If, however, you want to display *all* of the categories when the "-- Choose a Category --" list item is selected, return to the `ProductsBLL` class and customize the `GetProductsByCategoryID(categoryID)` method so that it invokes the `GetProducts()` method if the passed in *`categoryID`* parameter is less than zero:</span></span>


[!code-vb[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample2.vb)]

<span data-ttu-id="74bf0-184">La technique utilisée ici est similaire à l’approche que nous avons utilisé pour afficher tous les fournisseurs dans la [paramètres déclaratifs](../basic-reporting/declarative-parameters-cs.md) (didacticiel), bien que dans cet exemple, nous utilisons la valeur `-1` pour indiquer que tous les enregistrements doivent être au lieu de récupérer `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="74bf0-184">The technique used here is similar to the approach we used to display all suppliers back in the [Declarative Parameters](../basic-reporting/declarative-parameters-cs.md) tutorial, although for this example we're using a value of `-1` to indicate that all records should be retrieved as opposed to `Nothing`.</span></span> <span data-ttu-id="74bf0-185">C’est parce que le  *`categoryID`*  paramètre de la `GetProductsByCategoryID(categoryID)` méthode attend comme valeur entière passée, tandis que dans le didacticiel de paramètres déclaratifs nous étions en passant un paramètre de chaîne d’entrée.</span><span class="sxs-lookup"><span data-stu-id="74bf0-185">This is because the *`categoryID`* parameter of the `GetProductsByCategoryID(categoryID)` method expects as integer value passed in, whereas in the Declarative Parameters tutorial we were passing in a string input parameter.</span></span>

<span data-ttu-id="74bf0-186">La figure 14 illustre une capture d’écran de `FilterByDropDownList.aspx` lorsque l’option «--choisir une catégorie-- » est activée.</span><span class="sxs-lookup"><span data-stu-id="74bf0-186">Figure 14 shows a screen shot of `FilterByDropDownList.aspx` when the "-- Choose a Category --" option is selected.</span></span> <span data-ttu-id="74bf0-187">Ici, tous les produits sont affichés par défaut, et l’utilisateur peut limiter l’affichage en choisissant une catégorie spécifique.</span><span class="sxs-lookup"><span data-stu-id="74bf0-187">Here, all of the products are displayed by default, and the user can narrow the display by choosing a specific category.</span></span>


<span data-ttu-id="74bf0-188">[![Tous les produits sont désormais répertoriés par défaut](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="74bf0-188">[![All of the Products are Now Listed By Default](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span></span>

<span data-ttu-id="74bf0-189">**La figure 14**: tous les produits sont désormais répertoriés par défaut ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="74bf0-189">**Figure 14**: All of the Products are Now Listed By Default ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span></span>


## <a name="summary"></a><span data-ttu-id="74bf0-190">Résumé</span><span class="sxs-lookup"><span data-stu-id="74bf0-190">Summary</span></span>

<span data-ttu-id="74bf0-191">Lors de l’affichage des données hiérarchiquement relatives, il vous aide souvent à présenter les données à l’aide de rapports maître/détail, à partir de laquelle l’utilisateur peut démarrer vous parcourez attentivement les données à partir du haut de la hiérarchie et afficher des détails.</span><span class="sxs-lookup"><span data-stu-id="74bf0-191">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="74bf0-192">Dans ce didacticiel, nous avons examiné création d’un rapport maître/détail simple montrant les produits d’une catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="74bf0-192">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="74bf0-193">Cela a été accompli en utilisant une liste déroulante pour obtenir la liste des catégories et un GridView pour les produits appartenant à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="74bf0-193">This was accomplished by using a DropDownList for the list of categories and a GridView for the products belonging to the selected category.</span></span>

<span data-ttu-id="74bf0-194">Dans le [didacticiel suivant](master-detail-filtering-with-two-dropdownlists-vb.md) nous allons l’une étape interface de DropDownList en outre, à l’aide de la compréhension des deux listes.</span><span class="sxs-lookup"><span data-stu-id="74bf0-194">In the [next tutorial](master-detail-filtering-with-two-dropdownlists-vb.md) we'll take the DropDownList interface one step further, using two DropDownLists.</span></span>

<span data-ttu-id="74bf0-195">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="74bf0-195">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="74bf0-196">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="74bf0-196">About the Author</span></span>

<span data-ttu-id="74bf0-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept manuels ASP/ASP.NET et créateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="74bf0-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="74bf0-198">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="74bf0-198">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="74bf0-199">Son dernier ouvrage est [ *SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="74bf0-199">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="74bf0-200">Il peut être atteint à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) ou via son blog, qui se trouvent à [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="74bf0-200">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="74bf0-201">[Précédent](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
[Suivant](master-detail-filtering-with-two-dropdownlists-vb.md)</span><span class="sxs-lookup"><span data-stu-id="74bf0-201">[Previous](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
[Next](master-detail-filtering-with-two-dropdownlists-vb.md)</span></span>
